{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Parser = void 0;\nconst index_js_1 = require(\"../tokenizer/index.js\");\nconst open_element_stack_js_1 = require(\"./open-element-stack.js\");\nconst formatting_element_list_js_1 = require(\"./formatting-element-list.js\");\nconst default_js_1 = require(\"../tree-adapters/default.js\");\nconst doctype = require(\"../common/doctype.js\");\nconst foreignContent = require(\"../common/foreign-content.js\");\nconst error_codes_js_1 = require(\"../common/error-codes.js\");\nconst unicode = require(\"../common/unicode.js\");\nconst html_js_1 = require(\"../common/html.js\");\nconst token_js_1 = require(\"../common/token.js\");\n//Misc constants\nconst HIDDEN_INPUT_TYPE = 'hidden';\n//Adoption agency loops iteration count\nconst AA_OUTER_LOOP_ITER = 8;\nconst AA_INNER_LOOP_ITER = 3;\n//Insertion modes\nvar InsertionMode;\n(function (InsertionMode) {\n  InsertionMode[InsertionMode[\"INITIAL\"] = 0] = \"INITIAL\";\n  InsertionMode[InsertionMode[\"BEFORE_HTML\"] = 1] = \"BEFORE_HTML\";\n  InsertionMode[InsertionMode[\"BEFORE_HEAD\"] = 2] = \"BEFORE_HEAD\";\n  InsertionMode[InsertionMode[\"IN_HEAD\"] = 3] = \"IN_HEAD\";\n  InsertionMode[InsertionMode[\"IN_HEAD_NO_SCRIPT\"] = 4] = \"IN_HEAD_NO_SCRIPT\";\n  InsertionMode[InsertionMode[\"AFTER_HEAD\"] = 5] = \"AFTER_HEAD\";\n  InsertionMode[InsertionMode[\"IN_BODY\"] = 6] = \"IN_BODY\";\n  InsertionMode[InsertionMode[\"TEXT\"] = 7] = \"TEXT\";\n  InsertionMode[InsertionMode[\"IN_TABLE\"] = 8] = \"IN_TABLE\";\n  InsertionMode[InsertionMode[\"IN_TABLE_TEXT\"] = 9] = \"IN_TABLE_TEXT\";\n  InsertionMode[InsertionMode[\"IN_CAPTION\"] = 10] = \"IN_CAPTION\";\n  InsertionMode[InsertionMode[\"IN_COLUMN_GROUP\"] = 11] = \"IN_COLUMN_GROUP\";\n  InsertionMode[InsertionMode[\"IN_TABLE_BODY\"] = 12] = \"IN_TABLE_BODY\";\n  InsertionMode[InsertionMode[\"IN_ROW\"] = 13] = \"IN_ROW\";\n  InsertionMode[InsertionMode[\"IN_CELL\"] = 14] = \"IN_CELL\";\n  InsertionMode[InsertionMode[\"IN_SELECT\"] = 15] = \"IN_SELECT\";\n  InsertionMode[InsertionMode[\"IN_SELECT_IN_TABLE\"] = 16] = \"IN_SELECT_IN_TABLE\";\n  InsertionMode[InsertionMode[\"IN_TEMPLATE\"] = 17] = \"IN_TEMPLATE\";\n  InsertionMode[InsertionMode[\"AFTER_BODY\"] = 18] = \"AFTER_BODY\";\n  InsertionMode[InsertionMode[\"IN_FRAMESET\"] = 19] = \"IN_FRAMESET\";\n  InsertionMode[InsertionMode[\"AFTER_FRAMESET\"] = 20] = \"AFTER_FRAMESET\";\n  InsertionMode[InsertionMode[\"AFTER_AFTER_BODY\"] = 21] = \"AFTER_AFTER_BODY\";\n  InsertionMode[InsertionMode[\"AFTER_AFTER_FRAMESET\"] = 22] = \"AFTER_AFTER_FRAMESET\";\n})(InsertionMode || (InsertionMode = {}));\nconst BASE_LOC = {\n  startLine: -1,\n  startCol: -1,\n  startOffset: -1,\n  endLine: -1,\n  endCol: -1,\n  endOffset: -1\n};\nconst TABLE_STRUCTURE_TAGS = new Set([html_js_1.TAG_ID.TABLE, html_js_1.TAG_ID.TBODY, html_js_1.TAG_ID.TFOOT, html_js_1.TAG_ID.THEAD, html_js_1.TAG_ID.TR]);\nconst defaultParserOptions = {\n  scriptingEnabled: true,\n  sourceCodeLocationInfo: false,\n  treeAdapter: default_js_1.defaultTreeAdapter,\n  onParseError: null\n};\n//Parser\nclass Parser {\n  constructor(options, document) {\n    let fragmentContext = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n    let scriptHandler = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : null;\n    this.fragmentContext = fragmentContext;\n    this.scriptHandler = scriptHandler;\n    this.currentToken = null;\n    this.stopped = false;\n    this.insertionMode = InsertionMode.INITIAL;\n    this.originalInsertionMode = InsertionMode.INITIAL;\n    this.headElement = null;\n    this.formElement = null;\n    /** Indicates that the current node is not an element in the HTML namespace */\n    this.currentNotInHTML = false;\n    /**\n     * The template insertion mode stack is maintained from the left.\n     * Ie. the topmost element will always have index 0.\n     */\n    this.tmplInsertionModeStack = [];\n    this.pendingCharacterTokens = [];\n    this.hasNonWhitespacePendingCharacterToken = false;\n    this.framesetOk = true;\n    this.skipNextNewLine = false;\n    this.fosterParentingEnabled = false;\n    this.options = Object.assign(Object.assign({}, defaultParserOptions), options);\n    this.treeAdapter = this.options.treeAdapter;\n    this.onParseError = this.options.onParseError;\n    // Always enable location info if we report parse errors.\n    if (this.onParseError) {\n      this.options.sourceCodeLocationInfo = true;\n    }\n    this.document = document !== null && document !== void 0 ? document : this.treeAdapter.createDocument();\n    this.tokenizer = new index_js_1.Tokenizer(this.options, this);\n    this.activeFormattingElements = new formatting_element_list_js_1.FormattingElementList(this.treeAdapter);\n    this.fragmentContextID = fragmentContext ? (0, html_js_1.getTagID)(this.treeAdapter.getTagName(fragmentContext)) : html_js_1.TAG_ID.UNKNOWN;\n    this._setContextModes(fragmentContext !== null && fragmentContext !== void 0 ? fragmentContext : this.document, this.fragmentContextID);\n    this.openElements = new open_element_stack_js_1.OpenElementStack(this.document, this.treeAdapter, this);\n  }\n  // API\n  static parse(html, options) {\n    const parser = new this(options);\n    parser.tokenizer.write(html, true);\n    return parser.document;\n  }\n  static getFragmentParser(fragmentContext, options) {\n    const opts = Object.assign(Object.assign({}, defaultParserOptions), options);\n    //NOTE: use a <template> element as the fragment context if no context element was provided,\n    //so we will parse in a \"forgiving\" manner\n    fragmentContext !== null && fragmentContext !== void 0 ? fragmentContext : fragmentContext = opts.treeAdapter.createElement(html_js_1.TAG_NAMES.TEMPLATE, html_js_1.NS.HTML, []);\n    //NOTE: create a fake element which will be used as the `document` for fragment parsing.\n    //This is important for jsdom, where a new `document` cannot be created. This led to\n    //fragment parsing messing with the main `document`.\n    const documentMock = opts.treeAdapter.createElement('documentmock', html_js_1.NS.HTML, []);\n    const parser = new this(opts, documentMock, fragmentContext);\n    if (parser.fragmentContextID === html_js_1.TAG_ID.TEMPLATE) {\n      parser.tmplInsertionModeStack.unshift(InsertionMode.IN_TEMPLATE);\n    }\n    parser._initTokenizerForFragmentParsing();\n    parser._insertFakeRootElement();\n    parser._resetInsertionMode();\n    parser._findFormInFragmentContext();\n    return parser;\n  }\n  getFragment() {\n    const rootElement = this.treeAdapter.getFirstChild(this.document);\n    const fragment = this.treeAdapter.createDocumentFragment();\n    this._adoptNodes(rootElement, fragment);\n    return fragment;\n  }\n  //Errors\n  _err(token, code, beforeToken) {\n    var _a;\n    if (!this.onParseError) return;\n    const loc = (_a = token.location) !== null && _a !== void 0 ? _a : BASE_LOC;\n    const err = {\n      code,\n      startLine: loc.startLine,\n      startCol: loc.startCol,\n      startOffset: loc.startOffset,\n      endLine: beforeToken ? loc.startLine : loc.endLine,\n      endCol: beforeToken ? loc.startCol : loc.endCol,\n      endOffset: beforeToken ? loc.startOffset : loc.endOffset\n    };\n    this.onParseError(err);\n  }\n  //Stack events\n  onItemPush(node, tid, isTop) {\n    var _a, _b;\n    (_b = (_a = this.treeAdapter).onItemPush) === null || _b === void 0 ? void 0 : _b.call(_a, node);\n    if (isTop && this.openElements.stackTop > 0) this._setContextModes(node, tid);\n  }\n  onItemPop(node, isTop) {\n    var _a, _b;\n    if (this.options.sourceCodeLocationInfo) {\n      this._setEndLocation(node, this.currentToken);\n    }\n    (_b = (_a = this.treeAdapter).onItemPop) === null || _b === void 0 ? void 0 : _b.call(_a, node, this.openElements.current);\n    if (isTop) {\n      let current;\n      let currentTagId;\n      if (this.openElements.stackTop === 0 && this.fragmentContext) {\n        current = this.fragmentContext;\n        currentTagId = this.fragmentContextID;\n      } else {\n        ({\n          current,\n          currentTagId\n        } = this.openElements);\n      }\n      this._setContextModes(current, currentTagId);\n    }\n  }\n  _setContextModes(current, tid) {\n    const isHTML = current === this.document || this.treeAdapter.getNamespaceURI(current) === html_js_1.NS.HTML;\n    this.currentNotInHTML = !isHTML;\n    this.tokenizer.inForeignNode = !isHTML && !this._isIntegrationPoint(tid, current);\n  }\n  _switchToTextParsing(currentToken, nextTokenizerState) {\n    this._insertElement(currentToken, html_js_1.NS.HTML);\n    this.tokenizer.state = nextTokenizerState;\n    this.originalInsertionMode = this.insertionMode;\n    this.insertionMode = InsertionMode.TEXT;\n  }\n  switchToPlaintextParsing() {\n    this.insertionMode = InsertionMode.TEXT;\n    this.originalInsertionMode = InsertionMode.IN_BODY;\n    this.tokenizer.state = index_js_1.TokenizerMode.PLAINTEXT;\n  }\n  //Fragment parsing\n  _getAdjustedCurrentElement() {\n    return this.openElements.stackTop === 0 && this.fragmentContext ? this.fragmentContext : this.openElements.current;\n  }\n  _findFormInFragmentContext() {\n    let node = this.fragmentContext;\n    while (node) {\n      if (this.treeAdapter.getTagName(node) === html_js_1.TAG_NAMES.FORM) {\n        this.formElement = node;\n        break;\n      }\n      node = this.treeAdapter.getParentNode(node);\n    }\n  }\n  _initTokenizerForFragmentParsing() {\n    if (!this.fragmentContext || this.treeAdapter.getNamespaceURI(this.fragmentContext) !== html_js_1.NS.HTML) {\n      return;\n    }\n    switch (this.fragmentContextID) {\n      case html_js_1.TAG_ID.TITLE:\n      case html_js_1.TAG_ID.TEXTAREA:\n        {\n          this.tokenizer.state = index_js_1.TokenizerMode.RCDATA;\n          break;\n        }\n      case html_js_1.TAG_ID.STYLE:\n      case html_js_1.TAG_ID.XMP:\n      case html_js_1.TAG_ID.IFRAME:\n      case html_js_1.TAG_ID.NOEMBED:\n      case html_js_1.TAG_ID.NOFRAMES:\n      case html_js_1.TAG_ID.NOSCRIPT:\n        {\n          this.tokenizer.state = index_js_1.TokenizerMode.RAWTEXT;\n          break;\n        }\n      case html_js_1.TAG_ID.SCRIPT:\n        {\n          this.tokenizer.state = index_js_1.TokenizerMode.SCRIPT_DATA;\n          break;\n        }\n      case html_js_1.TAG_ID.PLAINTEXT:\n        {\n          this.tokenizer.state = index_js_1.TokenizerMode.PLAINTEXT;\n          break;\n        }\n      default:\n      // Do nothing\n    }\n  }\n  //Tree mutation\n  _setDocumentType(token) {\n    const name = token.name || '';\n    const publicId = token.publicId || '';\n    const systemId = token.systemId || '';\n    this.treeAdapter.setDocumentType(this.document, name, publicId, systemId);\n    if (token.location) {\n      const documentChildren = this.treeAdapter.getChildNodes(this.document);\n      const docTypeNode = documentChildren.find(node => this.treeAdapter.isDocumentTypeNode(node));\n      if (docTypeNode) {\n        this.treeAdapter.setNodeSourceCodeLocation(docTypeNode, token.location);\n      }\n    }\n  }\n  _attachElementToTree(element, location) {\n    if (this.options.sourceCodeLocationInfo) {\n      const loc = location && Object.assign(Object.assign({}, location), {\n        startTag: location\n      });\n      this.treeAdapter.setNodeSourceCodeLocation(element, loc);\n    }\n    if (this._shouldFosterParentOnInsertion()) {\n      this._fosterParentElement(element);\n    } else {\n      const parent = this.openElements.currentTmplContentOrNode;\n      this.treeAdapter.appendChild(parent, element);\n    }\n  }\n  _appendElement(token, namespaceURI) {\n    const element = this.treeAdapter.createElement(token.tagName, namespaceURI, token.attrs);\n    this._attachElementToTree(element, token.location);\n  }\n  _insertElement(token, namespaceURI) {\n    const element = this.treeAdapter.createElement(token.tagName, namespaceURI, token.attrs);\n    this._attachElementToTree(element, token.location);\n    this.openElements.push(element, token.tagID);\n  }\n  _insertFakeElement(tagName, tagID) {\n    const element = this.treeAdapter.createElement(tagName, html_js_1.NS.HTML, []);\n    this._attachElementToTree(element, null);\n    this.openElements.push(element, tagID);\n  }\n  _insertTemplate(token) {\n    const tmpl = this.treeAdapter.createElement(token.tagName, html_js_1.NS.HTML, token.attrs);\n    const content = this.treeAdapter.createDocumentFragment();\n    this.treeAdapter.setTemplateContent(tmpl, content);\n    this._attachElementToTree(tmpl, token.location);\n    this.openElements.push(tmpl, token.tagID);\n    if (this.options.sourceCodeLocationInfo) this.treeAdapter.setNodeSourceCodeLocation(content, null);\n  }\n  _insertFakeRootElement() {\n    const element = this.treeAdapter.createElement(html_js_1.TAG_NAMES.HTML, html_js_1.NS.HTML, []);\n    if (this.options.sourceCodeLocationInfo) this.treeAdapter.setNodeSourceCodeLocation(element, null);\n    this.treeAdapter.appendChild(this.openElements.current, element);\n    this.openElements.push(element, html_js_1.TAG_ID.HTML);\n  }\n  _appendCommentNode(token, parent) {\n    const commentNode = this.treeAdapter.createCommentNode(token.data);\n    this.treeAdapter.appendChild(parent, commentNode);\n    if (this.options.sourceCodeLocationInfo) {\n      this.treeAdapter.setNodeSourceCodeLocation(commentNode, token.location);\n    }\n  }\n  _insertCharacters(token) {\n    let parent;\n    let beforeElement;\n    if (this._shouldFosterParentOnInsertion()) {\n      ({\n        parent,\n        beforeElement\n      } = this._findFosterParentingLocation());\n      if (beforeElement) {\n        this.treeAdapter.insertTextBefore(parent, token.chars, beforeElement);\n      } else {\n        this.treeAdapter.insertText(parent, token.chars);\n      }\n    } else {\n      parent = this.openElements.currentTmplContentOrNode;\n      this.treeAdapter.insertText(parent, token.chars);\n    }\n    if (!token.location) return;\n    const siblings = this.treeAdapter.getChildNodes(parent);\n    const textNodeIdx = beforeElement ? siblings.lastIndexOf(beforeElement) : siblings.length;\n    const textNode = siblings[textNodeIdx - 1];\n    //NOTE: if we have a location assigned by another token, then just update the end position\n    const tnLoc = this.treeAdapter.getNodeSourceCodeLocation(textNode);\n    if (tnLoc) {\n      const {\n        endLine,\n        endCol,\n        endOffset\n      } = token.location;\n      this.treeAdapter.updateNodeSourceCodeLocation(textNode, {\n        endLine,\n        endCol,\n        endOffset\n      });\n    } else if (this.options.sourceCodeLocationInfo) {\n      this.treeAdapter.setNodeSourceCodeLocation(textNode, token.location);\n    }\n  }\n  _adoptNodes(donor, recipient) {\n    for (let child = this.treeAdapter.getFirstChild(donor); child; child = this.treeAdapter.getFirstChild(donor)) {\n      this.treeAdapter.detachNode(child);\n      this.treeAdapter.appendChild(recipient, child);\n    }\n  }\n  _setEndLocation(element, closingToken) {\n    if (this.treeAdapter.getNodeSourceCodeLocation(element) && closingToken.location) {\n      const ctLoc = closingToken.location;\n      const tn = this.treeAdapter.getTagName(element);\n      const endLoc =\n      // NOTE: For cases like <p> <p> </p> - First 'p' closes without a closing\n      // tag and for cases like <td> <p> </td> - 'p' closes without a closing tag.\n      closingToken.type === token_js_1.TokenType.END_TAG && tn === closingToken.tagName ? {\n        endTag: Object.assign({}, ctLoc),\n        endLine: ctLoc.endLine,\n        endCol: ctLoc.endCol,\n        endOffset: ctLoc.endOffset\n      } : {\n        endLine: ctLoc.startLine,\n        endCol: ctLoc.startCol,\n        endOffset: ctLoc.startOffset\n      };\n      this.treeAdapter.updateNodeSourceCodeLocation(element, endLoc);\n    }\n  }\n  //Token processing\n  shouldProcessStartTagTokenInForeignContent(token) {\n    // Check that neither current === document, or ns === NS.HTML\n    if (!this.currentNotInHTML) return false;\n    let current;\n    let currentTagId;\n    if (this.openElements.stackTop === 0 && this.fragmentContext) {\n      current = this.fragmentContext;\n      currentTagId = this.fragmentContextID;\n    } else {\n      ({\n        current,\n        currentTagId\n      } = this.openElements);\n    }\n    if (token.tagID === html_js_1.TAG_ID.SVG && this.treeAdapter.getTagName(current) === html_js_1.TAG_NAMES.ANNOTATION_XML && this.treeAdapter.getNamespaceURI(current) === html_js_1.NS.MATHML) {\n      return false;\n    }\n    return (\n      // Check that `current` is not an integration point for HTML or MathML elements.\n      this.tokenizer.inForeignNode ||\n      // If it _is_ an integration point, then we might have to check that it is not an HTML\n      // integration point.\n      (token.tagID === html_js_1.TAG_ID.MGLYPH || token.tagID === html_js_1.TAG_ID.MALIGNMARK) && !this._isIntegrationPoint(currentTagId, current, html_js_1.NS.HTML)\n    );\n  }\n  _processToken(token) {\n    switch (token.type) {\n      case token_js_1.TokenType.CHARACTER:\n        {\n          this.onCharacter(token);\n          break;\n        }\n      case token_js_1.TokenType.NULL_CHARACTER:\n        {\n          this.onNullCharacter(token);\n          break;\n        }\n      case token_js_1.TokenType.COMMENT:\n        {\n          this.onComment(token);\n          break;\n        }\n      case token_js_1.TokenType.DOCTYPE:\n        {\n          this.onDoctype(token);\n          break;\n        }\n      case token_js_1.TokenType.START_TAG:\n        {\n          this._processStartTag(token);\n          break;\n        }\n      case token_js_1.TokenType.END_TAG:\n        {\n          this.onEndTag(token);\n          break;\n        }\n      case token_js_1.TokenType.EOF:\n        {\n          this.onEof(token);\n          break;\n        }\n      case token_js_1.TokenType.WHITESPACE_CHARACTER:\n        {\n          this.onWhitespaceCharacter(token);\n          break;\n        }\n    }\n  }\n  //Integration points\n  _isIntegrationPoint(tid, element, foreignNS) {\n    const ns = this.treeAdapter.getNamespaceURI(element);\n    const attrs = this.treeAdapter.getAttrList(element);\n    return foreignContent.isIntegrationPoint(tid, ns, attrs, foreignNS);\n  }\n  //Active formatting elements reconstruction\n  _reconstructActiveFormattingElements() {\n    const listLength = this.activeFormattingElements.entries.length;\n    if (listLength) {\n      const endIndex = this.activeFormattingElements.entries.findIndex(entry => entry.type === formatting_element_list_js_1.EntryType.Marker || this.openElements.contains(entry.element));\n      const unopenIdx = endIndex < 0 ? listLength - 1 : endIndex - 1;\n      for (let i = unopenIdx; i >= 0; i--) {\n        const entry = this.activeFormattingElements.entries[i];\n        this._insertElement(entry.token, this.treeAdapter.getNamespaceURI(entry.element));\n        entry.element = this.openElements.current;\n      }\n    }\n  }\n  //Close elements\n  _closeTableCell() {\n    this.openElements.generateImpliedEndTags();\n    this.openElements.popUntilTableCellPopped();\n    this.activeFormattingElements.clearToLastMarker();\n    this.insertionMode = InsertionMode.IN_ROW;\n  }\n  _closePElement() {\n    this.openElements.generateImpliedEndTagsWithExclusion(html_js_1.TAG_ID.P);\n    this.openElements.popUntilTagNamePopped(html_js_1.TAG_ID.P);\n  }\n  //Insertion modes\n  _resetInsertionMode() {\n    for (let i = this.openElements.stackTop; i >= 0; i--) {\n      //Insertion mode reset map\n      switch (i === 0 && this.fragmentContext ? this.fragmentContextID : this.openElements.tagIDs[i]) {\n        case html_js_1.TAG_ID.TR:\n          this.insertionMode = InsertionMode.IN_ROW;\n          return;\n        case html_js_1.TAG_ID.TBODY:\n        case html_js_1.TAG_ID.THEAD:\n        case html_js_1.TAG_ID.TFOOT:\n          this.insertionMode = InsertionMode.IN_TABLE_BODY;\n          return;\n        case html_js_1.TAG_ID.CAPTION:\n          this.insertionMode = InsertionMode.IN_CAPTION;\n          return;\n        case html_js_1.TAG_ID.COLGROUP:\n          this.insertionMode = InsertionMode.IN_COLUMN_GROUP;\n          return;\n        case html_js_1.TAG_ID.TABLE:\n          this.insertionMode = InsertionMode.IN_TABLE;\n          return;\n        case html_js_1.TAG_ID.BODY:\n          this.insertionMode = InsertionMode.IN_BODY;\n          return;\n        case html_js_1.TAG_ID.FRAMESET:\n          this.insertionMode = InsertionMode.IN_FRAMESET;\n          return;\n        case html_js_1.TAG_ID.SELECT:\n          this._resetInsertionModeForSelect(i);\n          return;\n        case html_js_1.TAG_ID.TEMPLATE:\n          this.insertionMode = this.tmplInsertionModeStack[0];\n          return;\n        case html_js_1.TAG_ID.HTML:\n          this.insertionMode = this.headElement ? InsertionMode.AFTER_HEAD : InsertionMode.BEFORE_HEAD;\n          return;\n        case html_js_1.TAG_ID.TD:\n        case html_js_1.TAG_ID.TH:\n          if (i > 0) {\n            this.insertionMode = InsertionMode.IN_CELL;\n            return;\n          }\n          break;\n        case html_js_1.TAG_ID.HEAD:\n          if (i > 0) {\n            this.insertionMode = InsertionMode.IN_HEAD;\n            return;\n          }\n          break;\n      }\n    }\n    this.insertionMode = InsertionMode.IN_BODY;\n  }\n  _resetInsertionModeForSelect(selectIdx) {\n    if (selectIdx > 0) {\n      for (let i = selectIdx - 1; i > 0; i--) {\n        const tn = this.openElements.tagIDs[i];\n        if (tn === html_js_1.TAG_ID.TEMPLATE) {\n          break;\n        } else if (tn === html_js_1.TAG_ID.TABLE) {\n          this.insertionMode = InsertionMode.IN_SELECT_IN_TABLE;\n          return;\n        }\n      }\n    }\n    this.insertionMode = InsertionMode.IN_SELECT;\n  }\n  //Foster parenting\n  _isElementCausesFosterParenting(tn) {\n    return TABLE_STRUCTURE_TAGS.has(tn);\n  }\n  _shouldFosterParentOnInsertion() {\n    return this.fosterParentingEnabled && this._isElementCausesFosterParenting(this.openElements.currentTagId);\n  }\n  _findFosterParentingLocation() {\n    for (let i = this.openElements.stackTop; i >= 0; i--) {\n      const openElement = this.openElements.items[i];\n      switch (this.openElements.tagIDs[i]) {\n        case html_js_1.TAG_ID.TEMPLATE:\n          if (this.treeAdapter.getNamespaceURI(openElement) === html_js_1.NS.HTML) {\n            return {\n              parent: this.treeAdapter.getTemplateContent(openElement),\n              beforeElement: null\n            };\n          }\n          break;\n        case html_js_1.TAG_ID.TABLE:\n          {\n            const parent = this.treeAdapter.getParentNode(openElement);\n            if (parent) {\n              return {\n                parent,\n                beforeElement: openElement\n              };\n            }\n            return {\n              parent: this.openElements.items[i - 1],\n              beforeElement: null\n            };\n          }\n        default:\n        // Do nothing\n      }\n    }\n\n    return {\n      parent: this.openElements.items[0],\n      beforeElement: null\n    };\n  }\n  _fosterParentElement(element) {\n    const location = this._findFosterParentingLocation();\n    if (location.beforeElement) {\n      this.treeAdapter.insertBefore(location.parent, element, location.beforeElement);\n    } else {\n      this.treeAdapter.appendChild(location.parent, element);\n    }\n  }\n  //Special elements\n  _isSpecialElement(element, id) {\n    const ns = this.treeAdapter.getNamespaceURI(element);\n    return html_js_1.SPECIAL_ELEMENTS[ns].has(id);\n  }\n  onCharacter(token) {\n    this.skipNextNewLine = false;\n    if (this.tokenizer.inForeignNode) {\n      characterInForeignContent(this, token);\n      return;\n    }\n    switch (this.insertionMode) {\n      case InsertionMode.INITIAL:\n        tokenInInitialMode(this, token);\n        break;\n      case InsertionMode.BEFORE_HTML:\n        tokenBeforeHtml(this, token);\n        break;\n      case InsertionMode.BEFORE_HEAD:\n        tokenBeforeHead(this, token);\n        break;\n      case InsertionMode.IN_HEAD:\n        tokenInHead(this, token);\n        break;\n      case InsertionMode.IN_HEAD_NO_SCRIPT:\n        tokenInHeadNoScript(this, token);\n        break;\n      case InsertionMode.AFTER_HEAD:\n        tokenAfterHead(this, token);\n        break;\n      case InsertionMode.IN_BODY:\n      case InsertionMode.IN_CAPTION:\n      case InsertionMode.IN_CELL:\n      case InsertionMode.IN_TEMPLATE:\n        characterInBody(this, token);\n        break;\n      case InsertionMode.TEXT:\n      case InsertionMode.IN_SELECT:\n      case InsertionMode.IN_SELECT_IN_TABLE:\n        this._insertCharacters(token);\n        break;\n      case InsertionMode.IN_TABLE:\n      case InsertionMode.IN_TABLE_BODY:\n      case InsertionMode.IN_ROW:\n        characterInTable(this, token);\n        break;\n      case InsertionMode.IN_TABLE_TEXT:\n        characterInTableText(this, token);\n        break;\n      case InsertionMode.IN_COLUMN_GROUP:\n        tokenInColumnGroup(this, token);\n        break;\n      case InsertionMode.AFTER_BODY:\n        tokenAfterBody(this, token);\n        break;\n      case InsertionMode.AFTER_AFTER_BODY:\n        tokenAfterAfterBody(this, token);\n        break;\n      default:\n      // Do nothing\n    }\n  }\n\n  onNullCharacter(token) {\n    this.skipNextNewLine = false;\n    if (this.tokenizer.inForeignNode) {\n      nullCharacterInForeignContent(this, token);\n      return;\n    }\n    switch (this.insertionMode) {\n      case InsertionMode.INITIAL:\n        tokenInInitialMode(this, token);\n        break;\n      case InsertionMode.BEFORE_HTML:\n        tokenBeforeHtml(this, token);\n        break;\n      case InsertionMode.BEFORE_HEAD:\n        tokenBeforeHead(this, token);\n        break;\n      case InsertionMode.IN_HEAD:\n        tokenInHead(this, token);\n        break;\n      case InsertionMode.IN_HEAD_NO_SCRIPT:\n        tokenInHeadNoScript(this, token);\n        break;\n      case InsertionMode.AFTER_HEAD:\n        tokenAfterHead(this, token);\n        break;\n      case InsertionMode.TEXT:\n        this._insertCharacters(token);\n        break;\n      case InsertionMode.IN_TABLE:\n      case InsertionMode.IN_TABLE_BODY:\n      case InsertionMode.IN_ROW:\n        characterInTable(this, token);\n        break;\n      case InsertionMode.IN_COLUMN_GROUP:\n        tokenInColumnGroup(this, token);\n        break;\n      case InsertionMode.AFTER_BODY:\n        tokenAfterBody(this, token);\n        break;\n      case InsertionMode.AFTER_AFTER_BODY:\n        tokenAfterAfterBody(this, token);\n        break;\n      default:\n      // Do nothing\n    }\n  }\n\n  onComment(token) {\n    this.skipNextNewLine = false;\n    if (this.currentNotInHTML) {\n      appendComment(this, token);\n      return;\n    }\n    switch (this.insertionMode) {\n      case InsertionMode.INITIAL:\n      case InsertionMode.BEFORE_HTML:\n      case InsertionMode.BEFORE_HEAD:\n      case InsertionMode.IN_HEAD:\n      case InsertionMode.IN_HEAD_NO_SCRIPT:\n      case InsertionMode.AFTER_HEAD:\n      case InsertionMode.IN_BODY:\n      case InsertionMode.IN_TABLE:\n      case InsertionMode.IN_CAPTION:\n      case InsertionMode.IN_COLUMN_GROUP:\n      case InsertionMode.IN_TABLE_BODY:\n      case InsertionMode.IN_ROW:\n      case InsertionMode.IN_CELL:\n      case InsertionMode.IN_SELECT:\n      case InsertionMode.IN_SELECT_IN_TABLE:\n      case InsertionMode.IN_TEMPLATE:\n      case InsertionMode.IN_FRAMESET:\n      case InsertionMode.AFTER_FRAMESET:\n        appendComment(this, token);\n        break;\n      case InsertionMode.IN_TABLE_TEXT:\n        tokenInTableText(this, token);\n        break;\n      case InsertionMode.AFTER_BODY:\n        appendCommentToRootHtmlElement(this, token);\n        break;\n      case InsertionMode.AFTER_AFTER_BODY:\n      case InsertionMode.AFTER_AFTER_FRAMESET:\n        appendCommentToDocument(this, token);\n        break;\n      default:\n      // Do nothing\n    }\n  }\n\n  onDoctype(token) {\n    this.skipNextNewLine = false;\n    switch (this.insertionMode) {\n      case InsertionMode.INITIAL:\n        doctypeInInitialMode(this, token);\n        break;\n      case InsertionMode.BEFORE_HEAD:\n      case InsertionMode.IN_HEAD:\n      case InsertionMode.IN_HEAD_NO_SCRIPT:\n      case InsertionMode.AFTER_HEAD:\n        this._err(token, error_codes_js_1.ERR.misplacedDoctype);\n        break;\n      case InsertionMode.IN_TABLE_TEXT:\n        tokenInTableText(this, token);\n        break;\n      default:\n      // Do nothing\n    }\n  }\n\n  onStartTag(token) {\n    this.skipNextNewLine = false;\n    this.currentToken = token;\n    this._processStartTag(token);\n    if (token.selfClosing && !token.ackSelfClosing) {\n      this._err(token, error_codes_js_1.ERR.nonVoidHtmlElementStartTagWithTrailingSolidus);\n    }\n  }\n  /**\n   * Processes a given start tag.\n   *\n   * `onStartTag` checks if a self-closing tag was recognized. When a token\n   * is moved inbetween multiple insertion modes, this check for self-closing\n   * could lead to false positives. To avoid this, `_processStartTag` is used\n   * for nested calls.\n   *\n   * @param token The token to process.\n   */\n  _processStartTag(token) {\n    if (this.shouldProcessStartTagTokenInForeignContent(token)) {\n      startTagInForeignContent(this, token);\n    } else {\n      this._startTagOutsideForeignContent(token);\n    }\n  }\n  _startTagOutsideForeignContent(token) {\n    switch (this.insertionMode) {\n      case InsertionMode.INITIAL:\n        tokenInInitialMode(this, token);\n        break;\n      case InsertionMode.BEFORE_HTML:\n        startTagBeforeHtml(this, token);\n        break;\n      case InsertionMode.BEFORE_HEAD:\n        startTagBeforeHead(this, token);\n        break;\n      case InsertionMode.IN_HEAD:\n        startTagInHead(this, token);\n        break;\n      case InsertionMode.IN_HEAD_NO_SCRIPT:\n        startTagInHeadNoScript(this, token);\n        break;\n      case InsertionMode.AFTER_HEAD:\n        startTagAfterHead(this, token);\n        break;\n      case InsertionMode.IN_BODY:\n        startTagInBody(this, token);\n        break;\n      case InsertionMode.IN_TABLE:\n        startTagInTable(this, token);\n        break;\n      case InsertionMode.IN_TABLE_TEXT:\n        tokenInTableText(this, token);\n        break;\n      case InsertionMode.IN_CAPTION:\n        startTagInCaption(this, token);\n        break;\n      case InsertionMode.IN_COLUMN_GROUP:\n        startTagInColumnGroup(this, token);\n        break;\n      case InsertionMode.IN_TABLE_BODY:\n        startTagInTableBody(this, token);\n        break;\n      case InsertionMode.IN_ROW:\n        startTagInRow(this, token);\n        break;\n      case InsertionMode.IN_CELL:\n        startTagInCell(this, token);\n        break;\n      case InsertionMode.IN_SELECT:\n        startTagInSelect(this, token);\n        break;\n      case InsertionMode.IN_SELECT_IN_TABLE:\n        startTagInSelectInTable(this, token);\n        break;\n      case InsertionMode.IN_TEMPLATE:\n        startTagInTemplate(this, token);\n        break;\n      case InsertionMode.AFTER_BODY:\n        startTagAfterBody(this, token);\n        break;\n      case InsertionMode.IN_FRAMESET:\n        startTagInFrameset(this, token);\n        break;\n      case InsertionMode.AFTER_FRAMESET:\n        startTagAfterFrameset(this, token);\n        break;\n      case InsertionMode.AFTER_AFTER_BODY:\n        startTagAfterAfterBody(this, token);\n        break;\n      case InsertionMode.AFTER_AFTER_FRAMESET:\n        startTagAfterAfterFrameset(this, token);\n        break;\n      default:\n      // Do nothing\n    }\n  }\n\n  onEndTag(token) {\n    this.skipNextNewLine = false;\n    this.currentToken = token;\n    if (this.currentNotInHTML) {\n      endTagInForeignContent(this, token);\n    } else {\n      this._endTagOutsideForeignContent(token);\n    }\n  }\n  _endTagOutsideForeignContent(token) {\n    switch (this.insertionMode) {\n      case InsertionMode.INITIAL:\n        tokenInInitialMode(this, token);\n        break;\n      case InsertionMode.BEFORE_HTML:\n        endTagBeforeHtml(this, token);\n        break;\n      case InsertionMode.BEFORE_HEAD:\n        endTagBeforeHead(this, token);\n        break;\n      case InsertionMode.IN_HEAD:\n        endTagInHead(this, token);\n        break;\n      case InsertionMode.IN_HEAD_NO_SCRIPT:\n        endTagInHeadNoScript(this, token);\n        break;\n      case InsertionMode.AFTER_HEAD:\n        endTagAfterHead(this, token);\n        break;\n      case InsertionMode.IN_BODY:\n        endTagInBody(this, token);\n        break;\n      case InsertionMode.TEXT:\n        endTagInText(this, token);\n        break;\n      case InsertionMode.IN_TABLE:\n        endTagInTable(this, token);\n        break;\n      case InsertionMode.IN_TABLE_TEXT:\n        tokenInTableText(this, token);\n        break;\n      case InsertionMode.IN_CAPTION:\n        endTagInCaption(this, token);\n        break;\n      case InsertionMode.IN_COLUMN_GROUP:\n        endTagInColumnGroup(this, token);\n        break;\n      case InsertionMode.IN_TABLE_BODY:\n        endTagInTableBody(this, token);\n        break;\n      case InsertionMode.IN_ROW:\n        endTagInRow(this, token);\n        break;\n      case InsertionMode.IN_CELL:\n        endTagInCell(this, token);\n        break;\n      case InsertionMode.IN_SELECT:\n        endTagInSelect(this, token);\n        break;\n      case InsertionMode.IN_SELECT_IN_TABLE:\n        endTagInSelectInTable(this, token);\n        break;\n      case InsertionMode.IN_TEMPLATE:\n        endTagInTemplate(this, token);\n        break;\n      case InsertionMode.AFTER_BODY:\n        endTagAfterBody(this, token);\n        break;\n      case InsertionMode.IN_FRAMESET:\n        endTagInFrameset(this, token);\n        break;\n      case InsertionMode.AFTER_FRAMESET:\n        endTagAfterFrameset(this, token);\n        break;\n      case InsertionMode.AFTER_AFTER_BODY:\n        tokenAfterAfterBody(this, token);\n        break;\n      default:\n      // Do nothing\n    }\n  }\n\n  onEof(token) {\n    switch (this.insertionMode) {\n      case InsertionMode.INITIAL:\n        tokenInInitialMode(this, token);\n        break;\n      case InsertionMode.BEFORE_HTML:\n        tokenBeforeHtml(this, token);\n        break;\n      case InsertionMode.BEFORE_HEAD:\n        tokenBeforeHead(this, token);\n        break;\n      case InsertionMode.IN_HEAD:\n        tokenInHead(this, token);\n        break;\n      case InsertionMode.IN_HEAD_NO_SCRIPT:\n        tokenInHeadNoScript(this, token);\n        break;\n      case InsertionMode.AFTER_HEAD:\n        tokenAfterHead(this, token);\n        break;\n      case InsertionMode.IN_BODY:\n      case InsertionMode.IN_TABLE:\n      case InsertionMode.IN_CAPTION:\n      case InsertionMode.IN_COLUMN_GROUP:\n      case InsertionMode.IN_TABLE_BODY:\n      case InsertionMode.IN_ROW:\n      case InsertionMode.IN_CELL:\n      case InsertionMode.IN_SELECT:\n      case InsertionMode.IN_SELECT_IN_TABLE:\n        eofInBody(this, token);\n        break;\n      case InsertionMode.TEXT:\n        eofInText(this, token);\n        break;\n      case InsertionMode.IN_TABLE_TEXT:\n        tokenInTableText(this, token);\n        break;\n      case InsertionMode.IN_TEMPLATE:\n        eofInTemplate(this, token);\n        break;\n      case InsertionMode.AFTER_BODY:\n      case InsertionMode.IN_FRAMESET:\n      case InsertionMode.AFTER_FRAMESET:\n      case InsertionMode.AFTER_AFTER_BODY:\n      case InsertionMode.AFTER_AFTER_FRAMESET:\n        stopParsing(this, token);\n        break;\n      default:\n      // Do nothing\n    }\n  }\n\n  onWhitespaceCharacter(token) {\n    if (this.skipNextNewLine) {\n      this.skipNextNewLine = false;\n      if (token.chars.charCodeAt(0) === unicode.CODE_POINTS.LINE_FEED) {\n        if (token.chars.length === 1) {\n          return;\n        }\n        token.chars = token.chars.substr(1);\n      }\n    }\n    if (this.tokenizer.inForeignNode) {\n      this._insertCharacters(token);\n      return;\n    }\n    switch (this.insertionMode) {\n      case InsertionMode.IN_HEAD:\n      case InsertionMode.IN_HEAD_NO_SCRIPT:\n      case InsertionMode.AFTER_HEAD:\n      case InsertionMode.TEXT:\n      case InsertionMode.IN_COLUMN_GROUP:\n      case InsertionMode.IN_SELECT:\n      case InsertionMode.IN_SELECT_IN_TABLE:\n      case InsertionMode.IN_FRAMESET:\n      case InsertionMode.AFTER_FRAMESET:\n        this._insertCharacters(token);\n        break;\n      case InsertionMode.IN_BODY:\n      case InsertionMode.IN_CAPTION:\n      case InsertionMode.IN_CELL:\n      case InsertionMode.IN_TEMPLATE:\n      case InsertionMode.AFTER_BODY:\n      case InsertionMode.AFTER_AFTER_BODY:\n      case InsertionMode.AFTER_AFTER_FRAMESET:\n        whitespaceCharacterInBody(this, token);\n        break;\n      case InsertionMode.IN_TABLE:\n      case InsertionMode.IN_TABLE_BODY:\n      case InsertionMode.IN_ROW:\n        characterInTable(this, token);\n        break;\n      case InsertionMode.IN_TABLE_TEXT:\n        whitespaceCharacterInTableText(this, token);\n        break;\n      default:\n      // Do nothing\n    }\n  }\n}\n\nexports.Parser = Parser;\n//Adoption agency algorithm\n//(see: http://www.whatwg.org/specs/web-apps/current-work/multipage/tree-construction.html#adoptionAgency)\n//------------------------------------------------------------------\n//Steps 5-8 of the algorithm\nfunction aaObtainFormattingElementEntry(p, token) {\n  let formattingElementEntry = p.activeFormattingElements.getElementEntryInScopeWithTagName(token.tagName);\n  if (formattingElementEntry) {\n    if (!p.openElements.contains(formattingElementEntry.element)) {\n      p.activeFormattingElements.removeEntry(formattingElementEntry);\n      formattingElementEntry = null;\n    } else if (!p.openElements.hasInScope(token.tagID)) {\n      formattingElementEntry = null;\n    }\n  } else {\n    genericEndTagInBody(p, token);\n  }\n  return formattingElementEntry;\n}\n//Steps 9 and 10 of the algorithm\nfunction aaObtainFurthestBlock(p, formattingElementEntry) {\n  let furthestBlock = null;\n  let idx = p.openElements.stackTop;\n  for (; idx >= 0; idx--) {\n    const element = p.openElements.items[idx];\n    if (element === formattingElementEntry.element) {\n      break;\n    }\n    if (p._isSpecialElement(element, p.openElements.tagIDs[idx])) {\n      furthestBlock = element;\n    }\n  }\n  if (!furthestBlock) {\n    p.openElements.shortenToLength(idx < 0 ? 0 : idx);\n    p.activeFormattingElements.removeEntry(formattingElementEntry);\n  }\n  return furthestBlock;\n}\n//Step 13 of the algorithm\nfunction aaInnerLoop(p, furthestBlock, formattingElement) {\n  let lastElement = furthestBlock;\n  let nextElement = p.openElements.getCommonAncestor(furthestBlock);\n  for (let i = 0, element = nextElement; element !== formattingElement; i++, element = nextElement) {\n    //NOTE: store the next element for the next loop iteration (it may be deleted from the stack by step 9.5)\n    nextElement = p.openElements.getCommonAncestor(element);\n    const elementEntry = p.activeFormattingElements.getElementEntry(element);\n    const counterOverflow = elementEntry && i >= AA_INNER_LOOP_ITER;\n    const shouldRemoveFromOpenElements = !elementEntry || counterOverflow;\n    if (shouldRemoveFromOpenElements) {\n      if (counterOverflow) {\n        p.activeFormattingElements.removeEntry(elementEntry);\n      }\n      p.openElements.remove(element);\n    } else {\n      element = aaRecreateElementFromEntry(p, elementEntry);\n      if (lastElement === furthestBlock) {\n        p.activeFormattingElements.bookmark = elementEntry;\n      }\n      p.treeAdapter.detachNode(lastElement);\n      p.treeAdapter.appendChild(element, lastElement);\n      lastElement = element;\n    }\n  }\n  return lastElement;\n}\n//Step 13.7 of the algorithm\nfunction aaRecreateElementFromEntry(p, elementEntry) {\n  const ns = p.treeAdapter.getNamespaceURI(elementEntry.element);\n  const newElement = p.treeAdapter.createElement(elementEntry.token.tagName, ns, elementEntry.token.attrs);\n  p.openElements.replace(elementEntry.element, newElement);\n  elementEntry.element = newElement;\n  return newElement;\n}\n//Step 14 of the algorithm\nfunction aaInsertLastNodeInCommonAncestor(p, commonAncestor, lastElement) {\n  const tn = p.treeAdapter.getTagName(commonAncestor);\n  const tid = (0, html_js_1.getTagID)(tn);\n  if (p._isElementCausesFosterParenting(tid)) {\n    p._fosterParentElement(lastElement);\n  } else {\n    const ns = p.treeAdapter.getNamespaceURI(commonAncestor);\n    if (tid === html_js_1.TAG_ID.TEMPLATE && ns === html_js_1.NS.HTML) {\n      commonAncestor = p.treeAdapter.getTemplateContent(commonAncestor);\n    }\n    p.treeAdapter.appendChild(commonAncestor, lastElement);\n  }\n}\n//Steps 15-19 of the algorithm\nfunction aaReplaceFormattingElement(p, furthestBlock, formattingElementEntry) {\n  const ns = p.treeAdapter.getNamespaceURI(formattingElementEntry.element);\n  const {\n    token\n  } = formattingElementEntry;\n  const newElement = p.treeAdapter.createElement(token.tagName, ns, token.attrs);\n  p._adoptNodes(furthestBlock, newElement);\n  p.treeAdapter.appendChild(furthestBlock, newElement);\n  p.activeFormattingElements.insertElementAfterBookmark(newElement, token);\n  p.activeFormattingElements.removeEntry(formattingElementEntry);\n  p.openElements.remove(formattingElementEntry.element);\n  p.openElements.insertAfter(furthestBlock, newElement, token.tagID);\n}\n//Algorithm entry point\nfunction callAdoptionAgency(p, token) {\n  for (let i = 0; i < AA_OUTER_LOOP_ITER; i++) {\n    const formattingElementEntry = aaObtainFormattingElementEntry(p, token);\n    if (!formattingElementEntry) {\n      break;\n    }\n    const furthestBlock = aaObtainFurthestBlock(p, formattingElementEntry);\n    if (!furthestBlock) {\n      break;\n    }\n    p.activeFormattingElements.bookmark = formattingElementEntry;\n    const lastElement = aaInnerLoop(p, furthestBlock, formattingElementEntry.element);\n    const commonAncestor = p.openElements.getCommonAncestor(formattingElementEntry.element);\n    p.treeAdapter.detachNode(lastElement);\n    if (commonAncestor) aaInsertLastNodeInCommonAncestor(p, commonAncestor, lastElement);\n    aaReplaceFormattingElement(p, furthestBlock, formattingElementEntry);\n  }\n}\n//Generic token handlers\n//------------------------------------------------------------------\nfunction appendComment(p, token) {\n  p._appendCommentNode(token, p.openElements.currentTmplContentOrNode);\n}\nfunction appendCommentToRootHtmlElement(p, token) {\n  p._appendCommentNode(token, p.openElements.items[0]);\n}\nfunction appendCommentToDocument(p, token) {\n  p._appendCommentNode(token, p.document);\n}\nfunction stopParsing(p, token) {\n  p.stopped = true;\n  // NOTE: Set end locations for elements that remain on the open element stack.\n  if (token.location) {\n    // NOTE: If we are not in a fragment, `html` and `body` will stay on the stack.\n    // This is a problem, as we might overwrite their end position here.\n    const target = p.fragmentContext ? 0 : 2;\n    for (let i = p.openElements.stackTop; i >= target; i--) {\n      p._setEndLocation(p.openElements.items[i], token);\n    }\n    // Handle `html` and `body`\n    if (!p.fragmentContext && p.openElements.stackTop >= 0) {\n      const htmlElement = p.openElements.items[0];\n      const htmlLocation = p.treeAdapter.getNodeSourceCodeLocation(htmlElement);\n      if (htmlLocation && !htmlLocation.endTag) {\n        p._setEndLocation(htmlElement, token);\n        if (p.openElements.stackTop >= 1) {\n          const bodyElement = p.openElements.items[1];\n          const bodyLocation = p.treeAdapter.getNodeSourceCodeLocation(bodyElement);\n          if (bodyLocation && !bodyLocation.endTag) {\n            p._setEndLocation(bodyElement, token);\n          }\n        }\n      }\n    }\n  }\n}\n// The \"initial\" insertion mode\n//------------------------------------------------------------------\nfunction doctypeInInitialMode(p, token) {\n  p._setDocumentType(token);\n  const mode = token.forceQuirks ? html_js_1.DOCUMENT_MODE.QUIRKS : doctype.getDocumentMode(token);\n  if (!doctype.isConforming(token)) {\n    p._err(token, error_codes_js_1.ERR.nonConformingDoctype);\n  }\n  p.treeAdapter.setDocumentMode(p.document, mode);\n  p.insertionMode = InsertionMode.BEFORE_HTML;\n}\nfunction tokenInInitialMode(p, token) {\n  p._err(token, error_codes_js_1.ERR.missingDoctype, true);\n  p.treeAdapter.setDocumentMode(p.document, html_js_1.DOCUMENT_MODE.QUIRKS);\n  p.insertionMode = InsertionMode.BEFORE_HTML;\n  p._processToken(token);\n}\n// The \"before html\" insertion mode\n//------------------------------------------------------------------\nfunction startTagBeforeHtml(p, token) {\n  if (token.tagID === html_js_1.TAG_ID.HTML) {\n    p._insertElement(token, html_js_1.NS.HTML);\n    p.insertionMode = InsertionMode.BEFORE_HEAD;\n  } else {\n    tokenBeforeHtml(p, token);\n  }\n}\nfunction endTagBeforeHtml(p, token) {\n  const tn = token.tagID;\n  if (tn === html_js_1.TAG_ID.HTML || tn === html_js_1.TAG_ID.HEAD || tn === html_js_1.TAG_ID.BODY || tn === html_js_1.TAG_ID.BR) {\n    tokenBeforeHtml(p, token);\n  }\n}\nfunction tokenBeforeHtml(p, token) {\n  p._insertFakeRootElement();\n  p.insertionMode = InsertionMode.BEFORE_HEAD;\n  p._processToken(token);\n}\n// The \"before head\" insertion mode\n//------------------------------------------------------------------\nfunction startTagBeforeHead(p, token) {\n  switch (token.tagID) {\n    case html_js_1.TAG_ID.HTML:\n      {\n        startTagInBody(p, token);\n        break;\n      }\n    case html_js_1.TAG_ID.HEAD:\n      {\n        p._insertElement(token, html_js_1.NS.HTML);\n        p.headElement = p.openElements.current;\n        p.insertionMode = InsertionMode.IN_HEAD;\n        break;\n      }\n    default:\n      {\n        tokenBeforeHead(p, token);\n      }\n  }\n}\nfunction endTagBeforeHead(p, token) {\n  const tn = token.tagID;\n  if (tn === html_js_1.TAG_ID.HEAD || tn === html_js_1.TAG_ID.BODY || tn === html_js_1.TAG_ID.HTML || tn === html_js_1.TAG_ID.BR) {\n    tokenBeforeHead(p, token);\n  } else {\n    p._err(token, error_codes_js_1.ERR.endTagWithoutMatchingOpenElement);\n  }\n}\nfunction tokenBeforeHead(p, token) {\n  p._insertFakeElement(html_js_1.TAG_NAMES.HEAD, html_js_1.TAG_ID.HEAD);\n  p.headElement = p.openElements.current;\n  p.insertionMode = InsertionMode.IN_HEAD;\n  p._processToken(token);\n}\n// The \"in head\" insertion mode\n//------------------------------------------------------------------\nfunction startTagInHead(p, token) {\n  switch (token.tagID) {\n    case html_js_1.TAG_ID.HTML:\n      {\n        startTagInBody(p, token);\n        break;\n      }\n    case html_js_1.TAG_ID.BASE:\n    case html_js_1.TAG_ID.BASEFONT:\n    case html_js_1.TAG_ID.BGSOUND:\n    case html_js_1.TAG_ID.LINK:\n    case html_js_1.TAG_ID.META:\n      {\n        p._appendElement(token, html_js_1.NS.HTML);\n        token.ackSelfClosing = true;\n        break;\n      }\n    case html_js_1.TAG_ID.TITLE:\n      {\n        p._switchToTextParsing(token, index_js_1.TokenizerMode.RCDATA);\n        break;\n      }\n    case html_js_1.TAG_ID.NOSCRIPT:\n      {\n        if (p.options.scriptingEnabled) {\n          p._switchToTextParsing(token, index_js_1.TokenizerMode.RAWTEXT);\n        } else {\n          p._insertElement(token, html_js_1.NS.HTML);\n          p.insertionMode = InsertionMode.IN_HEAD_NO_SCRIPT;\n        }\n        break;\n      }\n    case html_js_1.TAG_ID.NOFRAMES:\n    case html_js_1.TAG_ID.STYLE:\n      {\n        p._switchToTextParsing(token, index_js_1.TokenizerMode.RAWTEXT);\n        break;\n      }\n    case html_js_1.TAG_ID.SCRIPT:\n      {\n        p._switchToTextParsing(token, index_js_1.TokenizerMode.SCRIPT_DATA);\n        break;\n      }\n    case html_js_1.TAG_ID.TEMPLATE:\n      {\n        p._insertTemplate(token);\n        p.activeFormattingElements.insertMarker();\n        p.framesetOk = false;\n        p.insertionMode = InsertionMode.IN_TEMPLATE;\n        p.tmplInsertionModeStack.unshift(InsertionMode.IN_TEMPLATE);\n        break;\n      }\n    case html_js_1.TAG_ID.HEAD:\n      {\n        p._err(token, error_codes_js_1.ERR.misplacedStartTagForHeadElement);\n        break;\n      }\n    default:\n      {\n        tokenInHead(p, token);\n      }\n  }\n}\nfunction endTagInHead(p, token) {\n  switch (token.tagID) {\n    case html_js_1.TAG_ID.HEAD:\n      {\n        p.openElements.pop();\n        p.insertionMode = InsertionMode.AFTER_HEAD;\n        break;\n      }\n    case html_js_1.TAG_ID.BODY:\n    case html_js_1.TAG_ID.BR:\n    case html_js_1.TAG_ID.HTML:\n      {\n        tokenInHead(p, token);\n        break;\n      }\n    case html_js_1.TAG_ID.TEMPLATE:\n      {\n        templateEndTagInHead(p, token);\n        break;\n      }\n    default:\n      {\n        p._err(token, error_codes_js_1.ERR.endTagWithoutMatchingOpenElement);\n      }\n  }\n}\nfunction templateEndTagInHead(p, token) {\n  if (p.openElements.tmplCount > 0) {\n    p.openElements.generateImpliedEndTagsThoroughly();\n    if (p.openElements.currentTagId !== html_js_1.TAG_ID.TEMPLATE) {\n      p._err(token, error_codes_js_1.ERR.closingOfElementWithOpenChildElements);\n    }\n    p.openElements.popUntilTagNamePopped(html_js_1.TAG_ID.TEMPLATE);\n    p.activeFormattingElements.clearToLastMarker();\n    p.tmplInsertionModeStack.shift();\n    p._resetInsertionMode();\n  } else {\n    p._err(token, error_codes_js_1.ERR.endTagWithoutMatchingOpenElement);\n  }\n}\nfunction tokenInHead(p, token) {\n  p.openElements.pop();\n  p.insertionMode = InsertionMode.AFTER_HEAD;\n  p._processToken(token);\n}\n// The \"in head no script\" insertion mode\n//------------------------------------------------------------------\nfunction startTagInHeadNoScript(p, token) {\n  switch (token.tagID) {\n    case html_js_1.TAG_ID.HTML:\n      {\n        startTagInBody(p, token);\n        break;\n      }\n    case html_js_1.TAG_ID.BASEFONT:\n    case html_js_1.TAG_ID.BGSOUND:\n    case html_js_1.TAG_ID.HEAD:\n    case html_js_1.TAG_ID.LINK:\n    case html_js_1.TAG_ID.META:\n    case html_js_1.TAG_ID.NOFRAMES:\n    case html_js_1.TAG_ID.STYLE:\n      {\n        startTagInHead(p, token);\n        break;\n      }\n    case html_js_1.TAG_ID.NOSCRIPT:\n      {\n        p._err(token, error_codes_js_1.ERR.nestedNoscriptInHead);\n        break;\n      }\n    default:\n      {\n        tokenInHeadNoScript(p, token);\n      }\n  }\n}\nfunction endTagInHeadNoScript(p, token) {\n  switch (token.tagID) {\n    case html_js_1.TAG_ID.NOSCRIPT:\n      {\n        p.openElements.pop();\n        p.insertionMode = InsertionMode.IN_HEAD;\n        break;\n      }\n    case html_js_1.TAG_ID.BR:\n      {\n        tokenInHeadNoScript(p, token);\n        break;\n      }\n    default:\n      {\n        p._err(token, error_codes_js_1.ERR.endTagWithoutMatchingOpenElement);\n      }\n  }\n}\nfunction tokenInHeadNoScript(p, token) {\n  const errCode = token.type === token_js_1.TokenType.EOF ? error_codes_js_1.ERR.openElementsLeftAfterEof : error_codes_js_1.ERR.disallowedContentInNoscriptInHead;\n  p._err(token, errCode);\n  p.openElements.pop();\n  p.insertionMode = InsertionMode.IN_HEAD;\n  p._processToken(token);\n}\n// The \"after head\" insertion mode\n//------------------------------------------------------------------\nfunction startTagAfterHead(p, token) {\n  switch (token.tagID) {\n    case html_js_1.TAG_ID.HTML:\n      {\n        startTagInBody(p, token);\n        break;\n      }\n    case html_js_1.TAG_ID.BODY:\n      {\n        p._insertElement(token, html_js_1.NS.HTML);\n        p.framesetOk = false;\n        p.insertionMode = InsertionMode.IN_BODY;\n        break;\n      }\n    case html_js_1.TAG_ID.FRAMESET:\n      {\n        p._insertElement(token, html_js_1.NS.HTML);\n        p.insertionMode = InsertionMode.IN_FRAMESET;\n        break;\n      }\n    case html_js_1.TAG_ID.BASE:\n    case html_js_1.TAG_ID.BASEFONT:\n    case html_js_1.TAG_ID.BGSOUND:\n    case html_js_1.TAG_ID.LINK:\n    case html_js_1.TAG_ID.META:\n    case html_js_1.TAG_ID.NOFRAMES:\n    case html_js_1.TAG_ID.SCRIPT:\n    case html_js_1.TAG_ID.STYLE:\n    case html_js_1.TAG_ID.TEMPLATE:\n    case html_js_1.TAG_ID.TITLE:\n      {\n        p._err(token, error_codes_js_1.ERR.abandonedHeadElementChild);\n        p.openElements.push(p.headElement, html_js_1.TAG_ID.HEAD);\n        startTagInHead(p, token);\n        p.openElements.remove(p.headElement);\n        break;\n      }\n    case html_js_1.TAG_ID.HEAD:\n      {\n        p._err(token, error_codes_js_1.ERR.misplacedStartTagForHeadElement);\n        break;\n      }\n    default:\n      {\n        tokenAfterHead(p, token);\n      }\n  }\n}\nfunction endTagAfterHead(p, token) {\n  switch (token.tagID) {\n    case html_js_1.TAG_ID.BODY:\n    case html_js_1.TAG_ID.HTML:\n    case html_js_1.TAG_ID.BR:\n      {\n        tokenAfterHead(p, token);\n        break;\n      }\n    case html_js_1.TAG_ID.TEMPLATE:\n      {\n        templateEndTagInHead(p, token);\n        break;\n      }\n    default:\n      {\n        p._err(token, error_codes_js_1.ERR.endTagWithoutMatchingOpenElement);\n      }\n  }\n}\nfunction tokenAfterHead(p, token) {\n  p._insertFakeElement(html_js_1.TAG_NAMES.BODY, html_js_1.TAG_ID.BODY);\n  p.insertionMode = InsertionMode.IN_BODY;\n  modeInBody(p, token);\n}\n// The \"in body\" insertion mode\n//------------------------------------------------------------------\nfunction modeInBody(p, token) {\n  switch (token.type) {\n    case token_js_1.TokenType.CHARACTER:\n      {\n        characterInBody(p, token);\n        break;\n      }\n    case token_js_1.TokenType.WHITESPACE_CHARACTER:\n      {\n        whitespaceCharacterInBody(p, token);\n        break;\n      }\n    case token_js_1.TokenType.COMMENT:\n      {\n        appendComment(p, token);\n        break;\n      }\n    case token_js_1.TokenType.START_TAG:\n      {\n        startTagInBody(p, token);\n        break;\n      }\n    case token_js_1.TokenType.END_TAG:\n      {\n        endTagInBody(p, token);\n        break;\n      }\n    case token_js_1.TokenType.EOF:\n      {\n        eofInBody(p, token);\n        break;\n      }\n    default:\n    // Do nothing\n  }\n}\n\nfunction whitespaceCharacterInBody(p, token) {\n  p._reconstructActiveFormattingElements();\n  p._insertCharacters(token);\n}\nfunction characterInBody(p, token) {\n  p._reconstructActiveFormattingElements();\n  p._insertCharacters(token);\n  p.framesetOk = false;\n}\nfunction htmlStartTagInBody(p, token) {\n  if (p.openElements.tmplCount === 0) {\n    p.treeAdapter.adoptAttributes(p.openElements.items[0], token.attrs);\n  }\n}\nfunction bodyStartTagInBody(p, token) {\n  const bodyElement = p.openElements.tryPeekProperlyNestedBodyElement();\n  if (bodyElement && p.openElements.tmplCount === 0) {\n    p.framesetOk = false;\n    p.treeAdapter.adoptAttributes(bodyElement, token.attrs);\n  }\n}\nfunction framesetStartTagInBody(p, token) {\n  const bodyElement = p.openElements.tryPeekProperlyNestedBodyElement();\n  if (p.framesetOk && bodyElement) {\n    p.treeAdapter.detachNode(bodyElement);\n    p.openElements.popAllUpToHtmlElement();\n    p._insertElement(token, html_js_1.NS.HTML);\n    p.insertionMode = InsertionMode.IN_FRAMESET;\n  }\n}\nfunction addressStartTagInBody(p, token) {\n  if (p.openElements.hasInButtonScope(html_js_1.TAG_ID.P)) {\n    p._closePElement();\n  }\n  p._insertElement(token, html_js_1.NS.HTML);\n}\nfunction numberedHeaderStartTagInBody(p, token) {\n  if (p.openElements.hasInButtonScope(html_js_1.TAG_ID.P)) {\n    p._closePElement();\n  }\n  if ((0, html_js_1.isNumberedHeader)(p.openElements.currentTagId)) {\n    p.openElements.pop();\n  }\n  p._insertElement(token, html_js_1.NS.HTML);\n}\nfunction preStartTagInBody(p, token) {\n  if (p.openElements.hasInButtonScope(html_js_1.TAG_ID.P)) {\n    p._closePElement();\n  }\n  p._insertElement(token, html_js_1.NS.HTML);\n  //NOTE: If the next token is a U+000A LINE FEED (LF) character token, then ignore that token and move\n  //on to the next one. (Newlines at the start of pre blocks are ignored as an authoring convenience.)\n  p.skipNextNewLine = true;\n  p.framesetOk = false;\n}\nfunction formStartTagInBody(p, token) {\n  const inTemplate = p.openElements.tmplCount > 0;\n  if (!p.formElement || inTemplate) {\n    if (p.openElements.hasInButtonScope(html_js_1.TAG_ID.P)) {\n      p._closePElement();\n    }\n    p._insertElement(token, html_js_1.NS.HTML);\n    if (!inTemplate) {\n      p.formElement = p.openElements.current;\n    }\n  }\n}\nfunction listItemStartTagInBody(p, token) {\n  p.framesetOk = false;\n  const tn = token.tagID;\n  for (let i = p.openElements.stackTop; i >= 0; i--) {\n    const elementId = p.openElements.tagIDs[i];\n    if (tn === html_js_1.TAG_ID.LI && elementId === html_js_1.TAG_ID.LI || (tn === html_js_1.TAG_ID.DD || tn === html_js_1.TAG_ID.DT) && (elementId === html_js_1.TAG_ID.DD || elementId === html_js_1.TAG_ID.DT)) {\n      p.openElements.generateImpliedEndTagsWithExclusion(elementId);\n      p.openElements.popUntilTagNamePopped(elementId);\n      break;\n    }\n    if (elementId !== html_js_1.TAG_ID.ADDRESS && elementId !== html_js_1.TAG_ID.DIV && elementId !== html_js_1.TAG_ID.P && p._isSpecialElement(p.openElements.items[i], elementId)) {\n      break;\n    }\n  }\n  if (p.openElements.hasInButtonScope(html_js_1.TAG_ID.P)) {\n    p._closePElement();\n  }\n  p._insertElement(token, html_js_1.NS.HTML);\n}\nfunction plaintextStartTagInBody(p, token) {\n  if (p.openElements.hasInButtonScope(html_js_1.TAG_ID.P)) {\n    p._closePElement();\n  }\n  p._insertElement(token, html_js_1.NS.HTML);\n  p.tokenizer.state = index_js_1.TokenizerMode.PLAINTEXT;\n}\nfunction buttonStartTagInBody(p, token) {\n  if (p.openElements.hasInScope(html_js_1.TAG_ID.BUTTON)) {\n    p.openElements.generateImpliedEndTags();\n    p.openElements.popUntilTagNamePopped(html_js_1.TAG_ID.BUTTON);\n  }\n  p._reconstructActiveFormattingElements();\n  p._insertElement(token, html_js_1.NS.HTML);\n  p.framesetOk = false;\n}\nfunction aStartTagInBody(p, token) {\n  const activeElementEntry = p.activeFormattingElements.getElementEntryInScopeWithTagName(html_js_1.TAG_NAMES.A);\n  if (activeElementEntry) {\n    callAdoptionAgency(p, token);\n    p.openElements.remove(activeElementEntry.element);\n    p.activeFormattingElements.removeEntry(activeElementEntry);\n  }\n  p._reconstructActiveFormattingElements();\n  p._insertElement(token, html_js_1.NS.HTML);\n  p.activeFormattingElements.pushElement(p.openElements.current, token);\n}\nfunction bStartTagInBody(p, token) {\n  p._reconstructActiveFormattingElements();\n  p._insertElement(token, html_js_1.NS.HTML);\n  p.activeFormattingElements.pushElement(p.openElements.current, token);\n}\nfunction nobrStartTagInBody(p, token) {\n  p._reconstructActiveFormattingElements();\n  if (p.openElements.hasInScope(html_js_1.TAG_ID.NOBR)) {\n    callAdoptionAgency(p, token);\n    p._reconstructActiveFormattingElements();\n  }\n  p._insertElement(token, html_js_1.NS.HTML);\n  p.activeFormattingElements.pushElement(p.openElements.current, token);\n}\nfunction appletStartTagInBody(p, token) {\n  p._reconstructActiveFormattingElements();\n  p._insertElement(token, html_js_1.NS.HTML);\n  p.activeFormattingElements.insertMarker();\n  p.framesetOk = false;\n}\nfunction tableStartTagInBody(p, token) {\n  if (p.treeAdapter.getDocumentMode(p.document) !== html_js_1.DOCUMENT_MODE.QUIRKS && p.openElements.hasInButtonScope(html_js_1.TAG_ID.P)) {\n    p._closePElement();\n  }\n  p._insertElement(token, html_js_1.NS.HTML);\n  p.framesetOk = false;\n  p.insertionMode = InsertionMode.IN_TABLE;\n}\nfunction areaStartTagInBody(p, token) {\n  p._reconstructActiveFormattingElements();\n  p._appendElement(token, html_js_1.NS.HTML);\n  p.framesetOk = false;\n  token.ackSelfClosing = true;\n}\nfunction isHiddenInput(token) {\n  const inputType = (0, token_js_1.getTokenAttr)(token, html_js_1.ATTRS.TYPE);\n  return inputType != null && inputType.toLowerCase() === HIDDEN_INPUT_TYPE;\n}\nfunction inputStartTagInBody(p, token) {\n  p._reconstructActiveFormattingElements();\n  p._appendElement(token, html_js_1.NS.HTML);\n  if (!isHiddenInput(token)) {\n    p.framesetOk = false;\n  }\n  token.ackSelfClosing = true;\n}\nfunction paramStartTagInBody(p, token) {\n  p._appendElement(token, html_js_1.NS.HTML);\n  token.ackSelfClosing = true;\n}\nfunction hrStartTagInBody(p, token) {\n  if (p.openElements.hasInButtonScope(html_js_1.TAG_ID.P)) {\n    p._closePElement();\n  }\n  p._appendElement(token, html_js_1.NS.HTML);\n  p.framesetOk = false;\n  token.ackSelfClosing = true;\n}\nfunction imageStartTagInBody(p, token) {\n  token.tagName = html_js_1.TAG_NAMES.IMG;\n  token.tagID = html_js_1.TAG_ID.IMG;\n  areaStartTagInBody(p, token);\n}\nfunction textareaStartTagInBody(p, token) {\n  p._insertElement(token, html_js_1.NS.HTML);\n  //NOTE: If the next token is a U+000A LINE FEED (LF) character token, then ignore that token and move\n  //on to the next one. (Newlines at the start of textarea elements are ignored as an authoring convenience.)\n  p.skipNextNewLine = true;\n  p.tokenizer.state = index_js_1.TokenizerMode.RCDATA;\n  p.originalInsertionMode = p.insertionMode;\n  p.framesetOk = false;\n  p.insertionMode = InsertionMode.TEXT;\n}\nfunction xmpStartTagInBody(p, token) {\n  if (p.openElements.hasInButtonScope(html_js_1.TAG_ID.P)) {\n    p._closePElement();\n  }\n  p._reconstructActiveFormattingElements();\n  p.framesetOk = false;\n  p._switchToTextParsing(token, index_js_1.TokenizerMode.RAWTEXT);\n}\nfunction iframeStartTagInBody(p, token) {\n  p.framesetOk = false;\n  p._switchToTextParsing(token, index_js_1.TokenizerMode.RAWTEXT);\n}\n//NOTE: here we assume that we always act as an user agent with enabled plugins, so we parse\n//<noembed> as rawtext.\nfunction noembedStartTagInBody(p, token) {\n  p._switchToTextParsing(token, index_js_1.TokenizerMode.RAWTEXT);\n}\nfunction selectStartTagInBody(p, token) {\n  p._reconstructActiveFormattingElements();\n  p._insertElement(token, html_js_1.NS.HTML);\n  p.framesetOk = false;\n  p.insertionMode = p.insertionMode === InsertionMode.IN_TABLE || p.insertionMode === InsertionMode.IN_CAPTION || p.insertionMode === InsertionMode.IN_TABLE_BODY || p.insertionMode === InsertionMode.IN_ROW || p.insertionMode === InsertionMode.IN_CELL ? InsertionMode.IN_SELECT_IN_TABLE : InsertionMode.IN_SELECT;\n}\nfunction optgroupStartTagInBody(p, token) {\n  if (p.openElements.currentTagId === html_js_1.TAG_ID.OPTION) {\n    p.openElements.pop();\n  }\n  p._reconstructActiveFormattingElements();\n  p._insertElement(token, html_js_1.NS.HTML);\n}\nfunction rbStartTagInBody(p, token) {\n  if (p.openElements.hasInScope(html_js_1.TAG_ID.RUBY)) {\n    p.openElements.generateImpliedEndTags();\n  }\n  p._insertElement(token, html_js_1.NS.HTML);\n}\nfunction rtStartTagInBody(p, token) {\n  if (p.openElements.hasInScope(html_js_1.TAG_ID.RUBY)) {\n    p.openElements.generateImpliedEndTagsWithExclusion(html_js_1.TAG_ID.RTC);\n  }\n  p._insertElement(token, html_js_1.NS.HTML);\n}\nfunction mathStartTagInBody(p, token) {\n  p._reconstructActiveFormattingElements();\n  foreignContent.adjustTokenMathMLAttrs(token);\n  foreignContent.adjustTokenXMLAttrs(token);\n  if (token.selfClosing) {\n    p._appendElement(token, html_js_1.NS.MATHML);\n  } else {\n    p._insertElement(token, html_js_1.NS.MATHML);\n  }\n  token.ackSelfClosing = true;\n}\nfunction svgStartTagInBody(p, token) {\n  p._reconstructActiveFormattingElements();\n  foreignContent.adjustTokenSVGAttrs(token);\n  foreignContent.adjustTokenXMLAttrs(token);\n  if (token.selfClosing) {\n    p._appendElement(token, html_js_1.NS.SVG);\n  } else {\n    p._insertElement(token, html_js_1.NS.SVG);\n  }\n  token.ackSelfClosing = true;\n}\nfunction genericStartTagInBody(p, token) {\n  p._reconstructActiveFormattingElements();\n  p._insertElement(token, html_js_1.NS.HTML);\n}\nfunction startTagInBody(p, token) {\n  switch (token.tagID) {\n    case html_js_1.TAG_ID.I:\n    case html_js_1.TAG_ID.S:\n    case html_js_1.TAG_ID.B:\n    case html_js_1.TAG_ID.U:\n    case html_js_1.TAG_ID.EM:\n    case html_js_1.TAG_ID.TT:\n    case html_js_1.TAG_ID.BIG:\n    case html_js_1.TAG_ID.CODE:\n    case html_js_1.TAG_ID.FONT:\n    case html_js_1.TAG_ID.SMALL:\n    case html_js_1.TAG_ID.STRIKE:\n    case html_js_1.TAG_ID.STRONG:\n      {\n        bStartTagInBody(p, token);\n        break;\n      }\n    case html_js_1.TAG_ID.A:\n      {\n        aStartTagInBody(p, token);\n        break;\n      }\n    case html_js_1.TAG_ID.H1:\n    case html_js_1.TAG_ID.H2:\n    case html_js_1.TAG_ID.H3:\n    case html_js_1.TAG_ID.H4:\n    case html_js_1.TAG_ID.H5:\n    case html_js_1.TAG_ID.H6:\n      {\n        numberedHeaderStartTagInBody(p, token);\n        break;\n      }\n    case html_js_1.TAG_ID.P:\n    case html_js_1.TAG_ID.DL:\n    case html_js_1.TAG_ID.OL:\n    case html_js_1.TAG_ID.UL:\n    case html_js_1.TAG_ID.DIV:\n    case html_js_1.TAG_ID.DIR:\n    case html_js_1.TAG_ID.NAV:\n    case html_js_1.TAG_ID.MAIN:\n    case html_js_1.TAG_ID.MENU:\n    case html_js_1.TAG_ID.ASIDE:\n    case html_js_1.TAG_ID.CENTER:\n    case html_js_1.TAG_ID.FIGURE:\n    case html_js_1.TAG_ID.FOOTER:\n    case html_js_1.TAG_ID.HEADER:\n    case html_js_1.TAG_ID.HGROUP:\n    case html_js_1.TAG_ID.DIALOG:\n    case html_js_1.TAG_ID.DETAILS:\n    case html_js_1.TAG_ID.ADDRESS:\n    case html_js_1.TAG_ID.ARTICLE:\n    case html_js_1.TAG_ID.SECTION:\n    case html_js_1.TAG_ID.SUMMARY:\n    case html_js_1.TAG_ID.FIELDSET:\n    case html_js_1.TAG_ID.BLOCKQUOTE:\n    case html_js_1.TAG_ID.FIGCAPTION:\n      {\n        addressStartTagInBody(p, token);\n        break;\n      }\n    case html_js_1.TAG_ID.LI:\n    case html_js_1.TAG_ID.DD:\n    case html_js_1.TAG_ID.DT:\n      {\n        listItemStartTagInBody(p, token);\n        break;\n      }\n    case html_js_1.TAG_ID.BR:\n    case html_js_1.TAG_ID.IMG:\n    case html_js_1.TAG_ID.WBR:\n    case html_js_1.TAG_ID.AREA:\n    case html_js_1.TAG_ID.EMBED:\n    case html_js_1.TAG_ID.KEYGEN:\n      {\n        areaStartTagInBody(p, token);\n        break;\n      }\n    case html_js_1.TAG_ID.HR:\n      {\n        hrStartTagInBody(p, token);\n        break;\n      }\n    case html_js_1.TAG_ID.RB:\n    case html_js_1.TAG_ID.RTC:\n      {\n        rbStartTagInBody(p, token);\n        break;\n      }\n    case html_js_1.TAG_ID.RT:\n    case html_js_1.TAG_ID.RP:\n      {\n        rtStartTagInBody(p, token);\n        break;\n      }\n    case html_js_1.TAG_ID.PRE:\n    case html_js_1.TAG_ID.LISTING:\n      {\n        preStartTagInBody(p, token);\n        break;\n      }\n    case html_js_1.TAG_ID.XMP:\n      {\n        xmpStartTagInBody(p, token);\n        break;\n      }\n    case html_js_1.TAG_ID.SVG:\n      {\n        svgStartTagInBody(p, token);\n        break;\n      }\n    case html_js_1.TAG_ID.HTML:\n      {\n        htmlStartTagInBody(p, token);\n        break;\n      }\n    case html_js_1.TAG_ID.BASE:\n    case html_js_1.TAG_ID.LINK:\n    case html_js_1.TAG_ID.META:\n    case html_js_1.TAG_ID.STYLE:\n    case html_js_1.TAG_ID.TITLE:\n    case html_js_1.TAG_ID.SCRIPT:\n    case html_js_1.TAG_ID.BGSOUND:\n    case html_js_1.TAG_ID.BASEFONT:\n    case html_js_1.TAG_ID.TEMPLATE:\n      {\n        startTagInHead(p, token);\n        break;\n      }\n    case html_js_1.TAG_ID.BODY:\n      {\n        bodyStartTagInBody(p, token);\n        break;\n      }\n    case html_js_1.TAG_ID.FORM:\n      {\n        formStartTagInBody(p, token);\n        break;\n      }\n    case html_js_1.TAG_ID.NOBR:\n      {\n        nobrStartTagInBody(p, token);\n        break;\n      }\n    case html_js_1.TAG_ID.MATH:\n      {\n        mathStartTagInBody(p, token);\n        break;\n      }\n    case html_js_1.TAG_ID.TABLE:\n      {\n        tableStartTagInBody(p, token);\n        break;\n      }\n    case html_js_1.TAG_ID.INPUT:\n      {\n        inputStartTagInBody(p, token);\n        break;\n      }\n    case html_js_1.TAG_ID.PARAM:\n    case html_js_1.TAG_ID.TRACK:\n    case html_js_1.TAG_ID.SOURCE:\n      {\n        paramStartTagInBody(p, token);\n        break;\n      }\n    case html_js_1.TAG_ID.IMAGE:\n      {\n        imageStartTagInBody(p, token);\n        break;\n      }\n    case html_js_1.TAG_ID.BUTTON:\n      {\n        buttonStartTagInBody(p, token);\n        break;\n      }\n    case html_js_1.TAG_ID.APPLET:\n    case html_js_1.TAG_ID.OBJECT:\n    case html_js_1.TAG_ID.MARQUEE:\n      {\n        appletStartTagInBody(p, token);\n        break;\n      }\n    case html_js_1.TAG_ID.IFRAME:\n      {\n        iframeStartTagInBody(p, token);\n        break;\n      }\n    case html_js_1.TAG_ID.SELECT:\n      {\n        selectStartTagInBody(p, token);\n        break;\n      }\n    case html_js_1.TAG_ID.OPTION:\n    case html_js_1.TAG_ID.OPTGROUP:\n      {\n        optgroupStartTagInBody(p, token);\n        break;\n      }\n    case html_js_1.TAG_ID.NOEMBED:\n      {\n        noembedStartTagInBody(p, token);\n        break;\n      }\n    case html_js_1.TAG_ID.FRAMESET:\n      {\n        framesetStartTagInBody(p, token);\n        break;\n      }\n    case html_js_1.TAG_ID.TEXTAREA:\n      {\n        textareaStartTagInBody(p, token);\n        break;\n      }\n    case html_js_1.TAG_ID.NOSCRIPT:\n      {\n        if (p.options.scriptingEnabled) {\n          noembedStartTagInBody(p, token);\n        } else {\n          genericStartTagInBody(p, token);\n        }\n        break;\n      }\n    case html_js_1.TAG_ID.PLAINTEXT:\n      {\n        plaintextStartTagInBody(p, token);\n        break;\n      }\n    case html_js_1.TAG_ID.COL:\n    case html_js_1.TAG_ID.TH:\n    case html_js_1.TAG_ID.TD:\n    case html_js_1.TAG_ID.TR:\n    case html_js_1.TAG_ID.HEAD:\n    case html_js_1.TAG_ID.FRAME:\n    case html_js_1.TAG_ID.TBODY:\n    case html_js_1.TAG_ID.TFOOT:\n    case html_js_1.TAG_ID.THEAD:\n    case html_js_1.TAG_ID.CAPTION:\n    case html_js_1.TAG_ID.COLGROUP:\n      {\n        // Ignore token\n        break;\n      }\n    default:\n      {\n        genericStartTagInBody(p, token);\n      }\n  }\n}\nfunction bodyEndTagInBody(p, token) {\n  if (p.openElements.hasInScope(html_js_1.TAG_ID.BODY)) {\n    p.insertionMode = InsertionMode.AFTER_BODY;\n    //NOTE: <body> is never popped from the stack, so we need to updated\n    //the end location explicitly.\n    if (p.options.sourceCodeLocationInfo) {\n      const bodyElement = p.openElements.tryPeekProperlyNestedBodyElement();\n      if (bodyElement) {\n        p._setEndLocation(bodyElement, token);\n      }\n    }\n  }\n}\nfunction htmlEndTagInBody(p, token) {\n  if (p.openElements.hasInScope(html_js_1.TAG_ID.BODY)) {\n    p.insertionMode = InsertionMode.AFTER_BODY;\n    endTagAfterBody(p, token);\n  }\n}\nfunction addressEndTagInBody(p, token) {\n  const tn = token.tagID;\n  if (p.openElements.hasInScope(tn)) {\n    p.openElements.generateImpliedEndTags();\n    p.openElements.popUntilTagNamePopped(tn);\n  }\n}\nfunction formEndTagInBody(p) {\n  const inTemplate = p.openElements.tmplCount > 0;\n  const {\n    formElement\n  } = p;\n  if (!inTemplate) {\n    p.formElement = null;\n  }\n  if ((formElement || inTemplate) && p.openElements.hasInScope(html_js_1.TAG_ID.FORM)) {\n    p.openElements.generateImpliedEndTags();\n    if (inTemplate) {\n      p.openElements.popUntilTagNamePopped(html_js_1.TAG_ID.FORM);\n    } else if (formElement) {\n      p.openElements.remove(formElement);\n    }\n  }\n}\nfunction pEndTagInBody(p) {\n  if (!p.openElements.hasInButtonScope(html_js_1.TAG_ID.P)) {\n    p._insertFakeElement(html_js_1.TAG_NAMES.P, html_js_1.TAG_ID.P);\n  }\n  p._closePElement();\n}\nfunction liEndTagInBody(p) {\n  if (p.openElements.hasInListItemScope(html_js_1.TAG_ID.LI)) {\n    p.openElements.generateImpliedEndTagsWithExclusion(html_js_1.TAG_ID.LI);\n    p.openElements.popUntilTagNamePopped(html_js_1.TAG_ID.LI);\n  }\n}\nfunction ddEndTagInBody(p, token) {\n  const tn = token.tagID;\n  if (p.openElements.hasInScope(tn)) {\n    p.openElements.generateImpliedEndTagsWithExclusion(tn);\n    p.openElements.popUntilTagNamePopped(tn);\n  }\n}\nfunction numberedHeaderEndTagInBody(p) {\n  if (p.openElements.hasNumberedHeaderInScope()) {\n    p.openElements.generateImpliedEndTags();\n    p.openElements.popUntilNumberedHeaderPopped();\n  }\n}\nfunction appletEndTagInBody(p, token) {\n  const tn = token.tagID;\n  if (p.openElements.hasInScope(tn)) {\n    p.openElements.generateImpliedEndTags();\n    p.openElements.popUntilTagNamePopped(tn);\n    p.activeFormattingElements.clearToLastMarker();\n  }\n}\nfunction brEndTagInBody(p) {\n  p._reconstructActiveFormattingElements();\n  p._insertFakeElement(html_js_1.TAG_NAMES.BR, html_js_1.TAG_ID.BR);\n  p.openElements.pop();\n  p.framesetOk = false;\n}\nfunction genericEndTagInBody(p, token) {\n  const tn = token.tagName;\n  const tid = token.tagID;\n  for (let i = p.openElements.stackTop; i > 0; i--) {\n    const element = p.openElements.items[i];\n    const elementId = p.openElements.tagIDs[i];\n    // Compare the tag name here, as the tag might not be a known tag with an ID.\n    if (tid === elementId && (tid !== html_js_1.TAG_ID.UNKNOWN || p.treeAdapter.getTagName(element) === tn)) {\n      p.openElements.generateImpliedEndTagsWithExclusion(tid);\n      if (p.openElements.stackTop >= i) p.openElements.shortenToLength(i);\n      break;\n    }\n    if (p._isSpecialElement(element, elementId)) {\n      break;\n    }\n  }\n}\nfunction endTagInBody(p, token) {\n  switch (token.tagID) {\n    case html_js_1.TAG_ID.A:\n    case html_js_1.TAG_ID.B:\n    case html_js_1.TAG_ID.I:\n    case html_js_1.TAG_ID.S:\n    case html_js_1.TAG_ID.U:\n    case html_js_1.TAG_ID.EM:\n    case html_js_1.TAG_ID.TT:\n    case html_js_1.TAG_ID.BIG:\n    case html_js_1.TAG_ID.CODE:\n    case html_js_1.TAG_ID.FONT:\n    case html_js_1.TAG_ID.NOBR:\n    case html_js_1.TAG_ID.SMALL:\n    case html_js_1.TAG_ID.STRIKE:\n    case html_js_1.TAG_ID.STRONG:\n      {\n        callAdoptionAgency(p, token);\n        break;\n      }\n    case html_js_1.TAG_ID.P:\n      {\n        pEndTagInBody(p);\n        break;\n      }\n    case html_js_1.TAG_ID.DL:\n    case html_js_1.TAG_ID.UL:\n    case html_js_1.TAG_ID.OL:\n    case html_js_1.TAG_ID.DIR:\n    case html_js_1.TAG_ID.DIV:\n    case html_js_1.TAG_ID.NAV:\n    case html_js_1.TAG_ID.PRE:\n    case html_js_1.TAG_ID.MAIN:\n    case html_js_1.TAG_ID.MENU:\n    case html_js_1.TAG_ID.ASIDE:\n    case html_js_1.TAG_ID.BUTTON:\n    case html_js_1.TAG_ID.CENTER:\n    case html_js_1.TAG_ID.FIGURE:\n    case html_js_1.TAG_ID.FOOTER:\n    case html_js_1.TAG_ID.HEADER:\n    case html_js_1.TAG_ID.HGROUP:\n    case html_js_1.TAG_ID.DIALOG:\n    case html_js_1.TAG_ID.ADDRESS:\n    case html_js_1.TAG_ID.ARTICLE:\n    case html_js_1.TAG_ID.DETAILS:\n    case html_js_1.TAG_ID.SECTION:\n    case html_js_1.TAG_ID.SUMMARY:\n    case html_js_1.TAG_ID.LISTING:\n    case html_js_1.TAG_ID.FIELDSET:\n    case html_js_1.TAG_ID.BLOCKQUOTE:\n    case html_js_1.TAG_ID.FIGCAPTION:\n      {\n        addressEndTagInBody(p, token);\n        break;\n      }\n    case html_js_1.TAG_ID.LI:\n      {\n        liEndTagInBody(p);\n        break;\n      }\n    case html_js_1.TAG_ID.DD:\n    case html_js_1.TAG_ID.DT:\n      {\n        ddEndTagInBody(p, token);\n        break;\n      }\n    case html_js_1.TAG_ID.H1:\n    case html_js_1.TAG_ID.H2:\n    case html_js_1.TAG_ID.H3:\n    case html_js_1.TAG_ID.H4:\n    case html_js_1.TAG_ID.H5:\n    case html_js_1.TAG_ID.H6:\n      {\n        numberedHeaderEndTagInBody(p);\n        break;\n      }\n    case html_js_1.TAG_ID.BR:\n      {\n        brEndTagInBody(p);\n        break;\n      }\n    case html_js_1.TAG_ID.BODY:\n      {\n        bodyEndTagInBody(p, token);\n        break;\n      }\n    case html_js_1.TAG_ID.HTML:\n      {\n        htmlEndTagInBody(p, token);\n        break;\n      }\n    case html_js_1.TAG_ID.FORM:\n      {\n        formEndTagInBody(p);\n        break;\n      }\n    case html_js_1.TAG_ID.APPLET:\n    case html_js_1.TAG_ID.OBJECT:\n    case html_js_1.TAG_ID.MARQUEE:\n      {\n        appletEndTagInBody(p, token);\n        break;\n      }\n    case html_js_1.TAG_ID.TEMPLATE:\n      {\n        templateEndTagInHead(p, token);\n        break;\n      }\n    default:\n      {\n        genericEndTagInBody(p, token);\n      }\n  }\n}\nfunction eofInBody(p, token) {\n  if (p.tmplInsertionModeStack.length > 0) {\n    eofInTemplate(p, token);\n  } else {\n    stopParsing(p, token);\n  }\n}\n// The \"text\" insertion mode\n//------------------------------------------------------------------\nfunction endTagInText(p, token) {\n  var _a;\n  if (token.tagID === html_js_1.TAG_ID.SCRIPT) {\n    (_a = p.scriptHandler) === null || _a === void 0 ? void 0 : _a.call(p, p.openElements.current);\n  }\n  p.openElements.pop();\n  p.insertionMode = p.originalInsertionMode;\n}\nfunction eofInText(p, token) {\n  p._err(token, error_codes_js_1.ERR.eofInElementThatCanContainOnlyText);\n  p.openElements.pop();\n  p.insertionMode = p.originalInsertionMode;\n  p.onEof(token);\n}\n// The \"in table\" insertion mode\n//------------------------------------------------------------------\nfunction characterInTable(p, token) {\n  if (TABLE_STRUCTURE_TAGS.has(p.openElements.currentTagId)) {\n    p.pendingCharacterTokens.length = 0;\n    p.hasNonWhitespacePendingCharacterToken = false;\n    p.originalInsertionMode = p.insertionMode;\n    p.insertionMode = InsertionMode.IN_TABLE_TEXT;\n    switch (token.type) {\n      case token_js_1.TokenType.CHARACTER:\n        {\n          characterInTableText(p, token);\n          break;\n        }\n      case token_js_1.TokenType.WHITESPACE_CHARACTER:\n        {\n          whitespaceCharacterInTableText(p, token);\n          break;\n        }\n      // Ignore null\n    }\n  } else {\n    tokenInTable(p, token);\n  }\n}\nfunction captionStartTagInTable(p, token) {\n  p.openElements.clearBackToTableContext();\n  p.activeFormattingElements.insertMarker();\n  p._insertElement(token, html_js_1.NS.HTML);\n  p.insertionMode = InsertionMode.IN_CAPTION;\n}\nfunction colgroupStartTagInTable(p, token) {\n  p.openElements.clearBackToTableContext();\n  p._insertElement(token, html_js_1.NS.HTML);\n  p.insertionMode = InsertionMode.IN_COLUMN_GROUP;\n}\nfunction colStartTagInTable(p, token) {\n  p.openElements.clearBackToTableContext();\n  p._insertFakeElement(html_js_1.TAG_NAMES.COLGROUP, html_js_1.TAG_ID.COLGROUP);\n  p.insertionMode = InsertionMode.IN_COLUMN_GROUP;\n  startTagInColumnGroup(p, token);\n}\nfunction tbodyStartTagInTable(p, token) {\n  p.openElements.clearBackToTableContext();\n  p._insertElement(token, html_js_1.NS.HTML);\n  p.insertionMode = InsertionMode.IN_TABLE_BODY;\n}\nfunction tdStartTagInTable(p, token) {\n  p.openElements.clearBackToTableContext();\n  p._insertFakeElement(html_js_1.TAG_NAMES.TBODY, html_js_1.TAG_ID.TBODY);\n  p.insertionMode = InsertionMode.IN_TABLE_BODY;\n  startTagInTableBody(p, token);\n}\nfunction tableStartTagInTable(p, token) {\n  if (p.openElements.hasInTableScope(html_js_1.TAG_ID.TABLE)) {\n    p.openElements.popUntilTagNamePopped(html_js_1.TAG_ID.TABLE);\n    p._resetInsertionMode();\n    p._processStartTag(token);\n  }\n}\nfunction inputStartTagInTable(p, token) {\n  if (isHiddenInput(token)) {\n    p._appendElement(token, html_js_1.NS.HTML);\n  } else {\n    tokenInTable(p, token);\n  }\n  token.ackSelfClosing = true;\n}\nfunction formStartTagInTable(p, token) {\n  if (!p.formElement && p.openElements.tmplCount === 0) {\n    p._insertElement(token, html_js_1.NS.HTML);\n    p.formElement = p.openElements.current;\n    p.openElements.pop();\n  }\n}\nfunction startTagInTable(p, token) {\n  switch (token.tagID) {\n    case html_js_1.TAG_ID.TD:\n    case html_js_1.TAG_ID.TH:\n    case html_js_1.TAG_ID.TR:\n      {\n        tdStartTagInTable(p, token);\n        break;\n      }\n    case html_js_1.TAG_ID.STYLE:\n    case html_js_1.TAG_ID.SCRIPT:\n    case html_js_1.TAG_ID.TEMPLATE:\n      {\n        startTagInHead(p, token);\n        break;\n      }\n    case html_js_1.TAG_ID.COL:\n      {\n        colStartTagInTable(p, token);\n        break;\n      }\n    case html_js_1.TAG_ID.FORM:\n      {\n        formStartTagInTable(p, token);\n        break;\n      }\n    case html_js_1.TAG_ID.TABLE:\n      {\n        tableStartTagInTable(p, token);\n        break;\n      }\n    case html_js_1.TAG_ID.TBODY:\n    case html_js_1.TAG_ID.TFOOT:\n    case html_js_1.TAG_ID.THEAD:\n      {\n        tbodyStartTagInTable(p, token);\n        break;\n      }\n    case html_js_1.TAG_ID.INPUT:\n      {\n        inputStartTagInTable(p, token);\n        break;\n      }\n    case html_js_1.TAG_ID.CAPTION:\n      {\n        captionStartTagInTable(p, token);\n        break;\n      }\n    case html_js_1.TAG_ID.COLGROUP:\n      {\n        colgroupStartTagInTable(p, token);\n        break;\n      }\n    default:\n      {\n        tokenInTable(p, token);\n      }\n  }\n}\nfunction endTagInTable(p, token) {\n  switch (token.tagID) {\n    case html_js_1.TAG_ID.TABLE:\n      {\n        if (p.openElements.hasInTableScope(html_js_1.TAG_ID.TABLE)) {\n          p.openElements.popUntilTagNamePopped(html_js_1.TAG_ID.TABLE);\n          p._resetInsertionMode();\n        }\n        break;\n      }\n    case html_js_1.TAG_ID.TEMPLATE:\n      {\n        templateEndTagInHead(p, token);\n        break;\n      }\n    case html_js_1.TAG_ID.BODY:\n    case html_js_1.TAG_ID.CAPTION:\n    case html_js_1.TAG_ID.COL:\n    case html_js_1.TAG_ID.COLGROUP:\n    case html_js_1.TAG_ID.HTML:\n    case html_js_1.TAG_ID.TBODY:\n    case html_js_1.TAG_ID.TD:\n    case html_js_1.TAG_ID.TFOOT:\n    case html_js_1.TAG_ID.TH:\n    case html_js_1.TAG_ID.THEAD:\n    case html_js_1.TAG_ID.TR:\n      {\n        // Ignore token\n        break;\n      }\n    default:\n      {\n        tokenInTable(p, token);\n      }\n  }\n}\nfunction tokenInTable(p, token) {\n  const savedFosterParentingState = p.fosterParentingEnabled;\n  p.fosterParentingEnabled = true;\n  // Process token in `In Body` mode\n  modeInBody(p, token);\n  p.fosterParentingEnabled = savedFosterParentingState;\n}\n// The \"in table text\" insertion mode\n//------------------------------------------------------------------\nfunction whitespaceCharacterInTableText(p, token) {\n  p.pendingCharacterTokens.push(token);\n}\nfunction characterInTableText(p, token) {\n  p.pendingCharacterTokens.push(token);\n  p.hasNonWhitespacePendingCharacterToken = true;\n}\nfunction tokenInTableText(p, token) {\n  let i = 0;\n  if (p.hasNonWhitespacePendingCharacterToken) {\n    for (; i < p.pendingCharacterTokens.length; i++) {\n      tokenInTable(p, p.pendingCharacterTokens[i]);\n    }\n  } else {\n    for (; i < p.pendingCharacterTokens.length; i++) {\n      p._insertCharacters(p.pendingCharacterTokens[i]);\n    }\n  }\n  p.insertionMode = p.originalInsertionMode;\n  p._processToken(token);\n}\n// The \"in caption\" insertion mode\n//------------------------------------------------------------------\nconst TABLE_VOID_ELEMENTS = new Set([html_js_1.TAG_ID.CAPTION, html_js_1.TAG_ID.COL, html_js_1.TAG_ID.COLGROUP, html_js_1.TAG_ID.TBODY, html_js_1.TAG_ID.TD, html_js_1.TAG_ID.TFOOT, html_js_1.TAG_ID.TH, html_js_1.TAG_ID.THEAD, html_js_1.TAG_ID.TR]);\nfunction startTagInCaption(p, token) {\n  const tn = token.tagID;\n  if (TABLE_VOID_ELEMENTS.has(tn)) {\n    if (p.openElements.hasInTableScope(html_js_1.TAG_ID.CAPTION)) {\n      p.openElements.generateImpliedEndTags();\n      p.openElements.popUntilTagNamePopped(html_js_1.TAG_ID.CAPTION);\n      p.activeFormattingElements.clearToLastMarker();\n      p.insertionMode = InsertionMode.IN_TABLE;\n      startTagInTable(p, token);\n    }\n  } else {\n    startTagInBody(p, token);\n  }\n}\nfunction endTagInCaption(p, token) {\n  const tn = token.tagID;\n  switch (tn) {\n    case html_js_1.TAG_ID.CAPTION:\n    case html_js_1.TAG_ID.TABLE:\n      {\n        if (p.openElements.hasInTableScope(html_js_1.TAG_ID.CAPTION)) {\n          p.openElements.generateImpliedEndTags();\n          p.openElements.popUntilTagNamePopped(html_js_1.TAG_ID.CAPTION);\n          p.activeFormattingElements.clearToLastMarker();\n          p.insertionMode = InsertionMode.IN_TABLE;\n          if (tn === html_js_1.TAG_ID.TABLE) {\n            endTagInTable(p, token);\n          }\n        }\n        break;\n      }\n    case html_js_1.TAG_ID.BODY:\n    case html_js_1.TAG_ID.COL:\n    case html_js_1.TAG_ID.COLGROUP:\n    case html_js_1.TAG_ID.HTML:\n    case html_js_1.TAG_ID.TBODY:\n    case html_js_1.TAG_ID.TD:\n    case html_js_1.TAG_ID.TFOOT:\n    case html_js_1.TAG_ID.TH:\n    case html_js_1.TAG_ID.THEAD:\n    case html_js_1.TAG_ID.TR:\n      {\n        // Ignore token\n        break;\n      }\n    default:\n      {\n        endTagInBody(p, token);\n      }\n  }\n}\n// The \"in column group\" insertion mode\n//------------------------------------------------------------------\nfunction startTagInColumnGroup(p, token) {\n  switch (token.tagID) {\n    case html_js_1.TAG_ID.HTML:\n      {\n        startTagInBody(p, token);\n        break;\n      }\n    case html_js_1.TAG_ID.COL:\n      {\n        p._appendElement(token, html_js_1.NS.HTML);\n        token.ackSelfClosing = true;\n        break;\n      }\n    case html_js_1.TAG_ID.TEMPLATE:\n      {\n        startTagInHead(p, token);\n        break;\n      }\n    default:\n      {\n        tokenInColumnGroup(p, token);\n      }\n  }\n}\nfunction endTagInColumnGroup(p, token) {\n  switch (token.tagID) {\n    case html_js_1.TAG_ID.COLGROUP:\n      {\n        if (p.openElements.currentTagId === html_js_1.TAG_ID.COLGROUP) {\n          p.openElements.pop();\n          p.insertionMode = InsertionMode.IN_TABLE;\n        }\n        break;\n      }\n    case html_js_1.TAG_ID.TEMPLATE:\n      {\n        templateEndTagInHead(p, token);\n        break;\n      }\n    case html_js_1.TAG_ID.COL:\n      {\n        // Ignore token\n        break;\n      }\n    default:\n      {\n        tokenInColumnGroup(p, token);\n      }\n  }\n}\nfunction tokenInColumnGroup(p, token) {\n  if (p.openElements.currentTagId === html_js_1.TAG_ID.COLGROUP) {\n    p.openElements.pop();\n    p.insertionMode = InsertionMode.IN_TABLE;\n    p._processToken(token);\n  }\n}\n// The \"in table body\" insertion mode\n//------------------------------------------------------------------\nfunction startTagInTableBody(p, token) {\n  switch (token.tagID) {\n    case html_js_1.TAG_ID.TR:\n      {\n        p.openElements.clearBackToTableBodyContext();\n        p._insertElement(token, html_js_1.NS.HTML);\n        p.insertionMode = InsertionMode.IN_ROW;\n        break;\n      }\n    case html_js_1.TAG_ID.TH:\n    case html_js_1.TAG_ID.TD:\n      {\n        p.openElements.clearBackToTableBodyContext();\n        p._insertFakeElement(html_js_1.TAG_NAMES.TR, html_js_1.TAG_ID.TR);\n        p.insertionMode = InsertionMode.IN_ROW;\n        startTagInRow(p, token);\n        break;\n      }\n    case html_js_1.TAG_ID.CAPTION:\n    case html_js_1.TAG_ID.COL:\n    case html_js_1.TAG_ID.COLGROUP:\n    case html_js_1.TAG_ID.TBODY:\n    case html_js_1.TAG_ID.TFOOT:\n    case html_js_1.TAG_ID.THEAD:\n      {\n        if (p.openElements.hasTableBodyContextInTableScope()) {\n          p.openElements.clearBackToTableBodyContext();\n          p.openElements.pop();\n          p.insertionMode = InsertionMode.IN_TABLE;\n          startTagInTable(p, token);\n        }\n        break;\n      }\n    default:\n      {\n        startTagInTable(p, token);\n      }\n  }\n}\nfunction endTagInTableBody(p, token) {\n  const tn = token.tagID;\n  switch (token.tagID) {\n    case html_js_1.TAG_ID.TBODY:\n    case html_js_1.TAG_ID.TFOOT:\n    case html_js_1.TAG_ID.THEAD:\n      {\n        if (p.openElements.hasInTableScope(tn)) {\n          p.openElements.clearBackToTableBodyContext();\n          p.openElements.pop();\n          p.insertionMode = InsertionMode.IN_TABLE;\n        }\n        break;\n      }\n    case html_js_1.TAG_ID.TABLE:\n      {\n        if (p.openElements.hasTableBodyContextInTableScope()) {\n          p.openElements.clearBackToTableBodyContext();\n          p.openElements.pop();\n          p.insertionMode = InsertionMode.IN_TABLE;\n          endTagInTable(p, token);\n        }\n        break;\n      }\n    case html_js_1.TAG_ID.BODY:\n    case html_js_1.TAG_ID.CAPTION:\n    case html_js_1.TAG_ID.COL:\n    case html_js_1.TAG_ID.COLGROUP:\n    case html_js_1.TAG_ID.HTML:\n    case html_js_1.TAG_ID.TD:\n    case html_js_1.TAG_ID.TH:\n    case html_js_1.TAG_ID.TR:\n      {\n        // Ignore token\n        break;\n      }\n    default:\n      {\n        endTagInTable(p, token);\n      }\n  }\n}\n// The \"in row\" insertion mode\n//------------------------------------------------------------------\nfunction startTagInRow(p, token) {\n  switch (token.tagID) {\n    case html_js_1.TAG_ID.TH:\n    case html_js_1.TAG_ID.TD:\n      {\n        p.openElements.clearBackToTableRowContext();\n        p._insertElement(token, html_js_1.NS.HTML);\n        p.insertionMode = InsertionMode.IN_CELL;\n        p.activeFormattingElements.insertMarker();\n        break;\n      }\n    case html_js_1.TAG_ID.CAPTION:\n    case html_js_1.TAG_ID.COL:\n    case html_js_1.TAG_ID.COLGROUP:\n    case html_js_1.TAG_ID.TBODY:\n    case html_js_1.TAG_ID.TFOOT:\n    case html_js_1.TAG_ID.THEAD:\n    case html_js_1.TAG_ID.TR:\n      {\n        if (p.openElements.hasInTableScope(html_js_1.TAG_ID.TR)) {\n          p.openElements.clearBackToTableRowContext();\n          p.openElements.pop();\n          p.insertionMode = InsertionMode.IN_TABLE_BODY;\n          startTagInTableBody(p, token);\n        }\n        break;\n      }\n    default:\n      {\n        startTagInTable(p, token);\n      }\n  }\n}\nfunction endTagInRow(p, token) {\n  switch (token.tagID) {\n    case html_js_1.TAG_ID.TR:\n      {\n        if (p.openElements.hasInTableScope(html_js_1.TAG_ID.TR)) {\n          p.openElements.clearBackToTableRowContext();\n          p.openElements.pop();\n          p.insertionMode = InsertionMode.IN_TABLE_BODY;\n        }\n        break;\n      }\n    case html_js_1.TAG_ID.TABLE:\n      {\n        if (p.openElements.hasInTableScope(html_js_1.TAG_ID.TR)) {\n          p.openElements.clearBackToTableRowContext();\n          p.openElements.pop();\n          p.insertionMode = InsertionMode.IN_TABLE_BODY;\n          endTagInTableBody(p, token);\n        }\n        break;\n      }\n    case html_js_1.TAG_ID.TBODY:\n    case html_js_1.TAG_ID.TFOOT:\n    case html_js_1.TAG_ID.THEAD:\n      {\n        if (p.openElements.hasInTableScope(token.tagID) || p.openElements.hasInTableScope(html_js_1.TAG_ID.TR)) {\n          p.openElements.clearBackToTableRowContext();\n          p.openElements.pop();\n          p.insertionMode = InsertionMode.IN_TABLE_BODY;\n          endTagInTableBody(p, token);\n        }\n        break;\n      }\n    case html_js_1.TAG_ID.BODY:\n    case html_js_1.TAG_ID.CAPTION:\n    case html_js_1.TAG_ID.COL:\n    case html_js_1.TAG_ID.COLGROUP:\n    case html_js_1.TAG_ID.HTML:\n    case html_js_1.TAG_ID.TD:\n    case html_js_1.TAG_ID.TH:\n      {\n        // Ignore end tag\n        break;\n      }\n    default:\n      endTagInTable(p, token);\n  }\n}\n// The \"in cell\" insertion mode\n//------------------------------------------------------------------\nfunction startTagInCell(p, token) {\n  const tn = token.tagID;\n  if (TABLE_VOID_ELEMENTS.has(tn)) {\n    if (p.openElements.hasInTableScope(html_js_1.TAG_ID.TD) || p.openElements.hasInTableScope(html_js_1.TAG_ID.TH)) {\n      p._closeTableCell();\n      startTagInRow(p, token);\n    }\n  } else {\n    startTagInBody(p, token);\n  }\n}\nfunction endTagInCell(p, token) {\n  const tn = token.tagID;\n  switch (tn) {\n    case html_js_1.TAG_ID.TD:\n    case html_js_1.TAG_ID.TH:\n      {\n        if (p.openElements.hasInTableScope(tn)) {\n          p.openElements.generateImpliedEndTags();\n          p.openElements.popUntilTagNamePopped(tn);\n          p.activeFormattingElements.clearToLastMarker();\n          p.insertionMode = InsertionMode.IN_ROW;\n        }\n        break;\n      }\n    case html_js_1.TAG_ID.TABLE:\n    case html_js_1.TAG_ID.TBODY:\n    case html_js_1.TAG_ID.TFOOT:\n    case html_js_1.TAG_ID.THEAD:\n    case html_js_1.TAG_ID.TR:\n      {\n        if (p.openElements.hasInTableScope(tn)) {\n          p._closeTableCell();\n          endTagInRow(p, token);\n        }\n        break;\n      }\n    case html_js_1.TAG_ID.BODY:\n    case html_js_1.TAG_ID.CAPTION:\n    case html_js_1.TAG_ID.COL:\n    case html_js_1.TAG_ID.COLGROUP:\n    case html_js_1.TAG_ID.HTML:\n      {\n        // Ignore token\n        break;\n      }\n    default:\n      {\n        endTagInBody(p, token);\n      }\n  }\n}\n// The \"in select\" insertion mode\n//------------------------------------------------------------------\nfunction startTagInSelect(p, token) {\n  switch (token.tagID) {\n    case html_js_1.TAG_ID.HTML:\n      {\n        startTagInBody(p, token);\n        break;\n      }\n    case html_js_1.TAG_ID.OPTION:\n      {\n        if (p.openElements.currentTagId === html_js_1.TAG_ID.OPTION) {\n          p.openElements.pop();\n        }\n        p._insertElement(token, html_js_1.NS.HTML);\n        break;\n      }\n    case html_js_1.TAG_ID.OPTGROUP:\n      {\n        if (p.openElements.currentTagId === html_js_1.TAG_ID.OPTION) {\n          p.openElements.pop();\n        }\n        if (p.openElements.currentTagId === html_js_1.TAG_ID.OPTGROUP) {\n          p.openElements.pop();\n        }\n        p._insertElement(token, html_js_1.NS.HTML);\n        break;\n      }\n    case html_js_1.TAG_ID.INPUT:\n    case html_js_1.TAG_ID.KEYGEN:\n    case html_js_1.TAG_ID.TEXTAREA:\n    case html_js_1.TAG_ID.SELECT:\n      {\n        if (p.openElements.hasInSelectScope(html_js_1.TAG_ID.SELECT)) {\n          p.openElements.popUntilTagNamePopped(html_js_1.TAG_ID.SELECT);\n          p._resetInsertionMode();\n          if (token.tagID !== html_js_1.TAG_ID.SELECT) {\n            p._processStartTag(token);\n          }\n        }\n        break;\n      }\n    case html_js_1.TAG_ID.SCRIPT:\n    case html_js_1.TAG_ID.TEMPLATE:\n      {\n        startTagInHead(p, token);\n        break;\n      }\n    default:\n    // Do nothing\n  }\n}\n\nfunction endTagInSelect(p, token) {\n  switch (token.tagID) {\n    case html_js_1.TAG_ID.OPTGROUP:\n      {\n        if (p.openElements.stackTop > 0 && p.openElements.currentTagId === html_js_1.TAG_ID.OPTION && p.openElements.tagIDs[p.openElements.stackTop - 1] === html_js_1.TAG_ID.OPTGROUP) {\n          p.openElements.pop();\n        }\n        if (p.openElements.currentTagId === html_js_1.TAG_ID.OPTGROUP) {\n          p.openElements.pop();\n        }\n        break;\n      }\n    case html_js_1.TAG_ID.OPTION:\n      {\n        if (p.openElements.currentTagId === html_js_1.TAG_ID.OPTION) {\n          p.openElements.pop();\n        }\n        break;\n      }\n    case html_js_1.TAG_ID.SELECT:\n      {\n        if (p.openElements.hasInSelectScope(html_js_1.TAG_ID.SELECT)) {\n          p.openElements.popUntilTagNamePopped(html_js_1.TAG_ID.SELECT);\n          p._resetInsertionMode();\n        }\n        break;\n      }\n    case html_js_1.TAG_ID.TEMPLATE:\n      {\n        templateEndTagInHead(p, token);\n        break;\n      }\n    default:\n    // Do nothing\n  }\n}\n// The \"in select in table\" insertion mode\n//------------------------------------------------------------------\nfunction startTagInSelectInTable(p, token) {\n  const tn = token.tagID;\n  if (tn === html_js_1.TAG_ID.CAPTION || tn === html_js_1.TAG_ID.TABLE || tn === html_js_1.TAG_ID.TBODY || tn === html_js_1.TAG_ID.TFOOT || tn === html_js_1.TAG_ID.THEAD || tn === html_js_1.TAG_ID.TR || tn === html_js_1.TAG_ID.TD || tn === html_js_1.TAG_ID.TH) {\n    p.openElements.popUntilTagNamePopped(html_js_1.TAG_ID.SELECT);\n    p._resetInsertionMode();\n    p._processStartTag(token);\n  } else {\n    startTagInSelect(p, token);\n  }\n}\nfunction endTagInSelectInTable(p, token) {\n  const tn = token.tagID;\n  if (tn === html_js_1.TAG_ID.CAPTION || tn === html_js_1.TAG_ID.TABLE || tn === html_js_1.TAG_ID.TBODY || tn === html_js_1.TAG_ID.TFOOT || tn === html_js_1.TAG_ID.THEAD || tn === html_js_1.TAG_ID.TR || tn === html_js_1.TAG_ID.TD || tn === html_js_1.TAG_ID.TH) {\n    if (p.openElements.hasInTableScope(tn)) {\n      p.openElements.popUntilTagNamePopped(html_js_1.TAG_ID.SELECT);\n      p._resetInsertionMode();\n      p.onEndTag(token);\n    }\n  } else {\n    endTagInSelect(p, token);\n  }\n}\n// The \"in template\" insertion mode\n//------------------------------------------------------------------\nfunction startTagInTemplate(p, token) {\n  switch (token.tagID) {\n    // First, handle tags that can start without a mode change\n    case html_js_1.TAG_ID.BASE:\n    case html_js_1.TAG_ID.BASEFONT:\n    case html_js_1.TAG_ID.BGSOUND:\n    case html_js_1.TAG_ID.LINK:\n    case html_js_1.TAG_ID.META:\n    case html_js_1.TAG_ID.NOFRAMES:\n    case html_js_1.TAG_ID.SCRIPT:\n    case html_js_1.TAG_ID.STYLE:\n    case html_js_1.TAG_ID.TEMPLATE:\n    case html_js_1.TAG_ID.TITLE:\n      startTagInHead(p, token);\n      break;\n    // Re-process the token in the appropriate mode\n    case html_js_1.TAG_ID.CAPTION:\n    case html_js_1.TAG_ID.COLGROUP:\n    case html_js_1.TAG_ID.TBODY:\n    case html_js_1.TAG_ID.TFOOT:\n    case html_js_1.TAG_ID.THEAD:\n      p.tmplInsertionModeStack[0] = InsertionMode.IN_TABLE;\n      p.insertionMode = InsertionMode.IN_TABLE;\n      startTagInTable(p, token);\n      break;\n    case html_js_1.TAG_ID.COL:\n      p.tmplInsertionModeStack[0] = InsertionMode.IN_COLUMN_GROUP;\n      p.insertionMode = InsertionMode.IN_COLUMN_GROUP;\n      startTagInColumnGroup(p, token);\n      break;\n    case html_js_1.TAG_ID.TR:\n      p.tmplInsertionModeStack[0] = InsertionMode.IN_TABLE_BODY;\n      p.insertionMode = InsertionMode.IN_TABLE_BODY;\n      startTagInTableBody(p, token);\n      break;\n    case html_js_1.TAG_ID.TD:\n    case html_js_1.TAG_ID.TH:\n      p.tmplInsertionModeStack[0] = InsertionMode.IN_ROW;\n      p.insertionMode = InsertionMode.IN_ROW;\n      startTagInRow(p, token);\n      break;\n    default:\n      p.tmplInsertionModeStack[0] = InsertionMode.IN_BODY;\n      p.insertionMode = InsertionMode.IN_BODY;\n      startTagInBody(p, token);\n  }\n}\nfunction endTagInTemplate(p, token) {\n  if (token.tagID === html_js_1.TAG_ID.TEMPLATE) {\n    templateEndTagInHead(p, token);\n  }\n}\nfunction eofInTemplate(p, token) {\n  if (p.openElements.tmplCount > 0) {\n    p.openElements.popUntilTagNamePopped(html_js_1.TAG_ID.TEMPLATE);\n    p.activeFormattingElements.clearToLastMarker();\n    p.tmplInsertionModeStack.shift();\n    p._resetInsertionMode();\n    p.onEof(token);\n  } else {\n    stopParsing(p, token);\n  }\n}\n// The \"after body\" insertion mode\n//------------------------------------------------------------------\nfunction startTagAfterBody(p, token) {\n  if (token.tagID === html_js_1.TAG_ID.HTML) {\n    startTagInBody(p, token);\n  } else {\n    tokenAfterBody(p, token);\n  }\n}\nfunction endTagAfterBody(p, token) {\n  var _a;\n  if (token.tagID === html_js_1.TAG_ID.HTML) {\n    if (!p.fragmentContext) {\n      p.insertionMode = InsertionMode.AFTER_AFTER_BODY;\n    }\n    //NOTE: <html> is never popped from the stack, so we need to updated\n    //the end location explicitly.\n    if (p.options.sourceCodeLocationInfo && p.openElements.tagIDs[0] === html_js_1.TAG_ID.HTML) {\n      p._setEndLocation(p.openElements.items[0], token);\n      // Update the body element, if it doesn't have an end tag\n      const bodyElement = p.openElements.items[1];\n      if (bodyElement && !((_a = p.treeAdapter.getNodeSourceCodeLocation(bodyElement)) === null || _a === void 0 ? void 0 : _a.endTag)) {\n        p._setEndLocation(bodyElement, token);\n      }\n    }\n  } else {\n    tokenAfterBody(p, token);\n  }\n}\nfunction tokenAfterBody(p, token) {\n  p.insertionMode = InsertionMode.IN_BODY;\n  modeInBody(p, token);\n}\n// The \"in frameset\" insertion mode\n//------------------------------------------------------------------\nfunction startTagInFrameset(p, token) {\n  switch (token.tagID) {\n    case html_js_1.TAG_ID.HTML:\n      {\n        startTagInBody(p, token);\n        break;\n      }\n    case html_js_1.TAG_ID.FRAMESET:\n      {\n        p._insertElement(token, html_js_1.NS.HTML);\n        break;\n      }\n    case html_js_1.TAG_ID.FRAME:\n      {\n        p._appendElement(token, html_js_1.NS.HTML);\n        token.ackSelfClosing = true;\n        break;\n      }\n    case html_js_1.TAG_ID.NOFRAMES:\n      {\n        startTagInHead(p, token);\n        break;\n      }\n    default:\n    // Do nothing\n  }\n}\n\nfunction endTagInFrameset(p, token) {\n  if (token.tagID === html_js_1.TAG_ID.FRAMESET && !p.openElements.isRootHtmlElementCurrent()) {\n    p.openElements.pop();\n    if (!p.fragmentContext && p.openElements.currentTagId !== html_js_1.TAG_ID.FRAMESET) {\n      p.insertionMode = InsertionMode.AFTER_FRAMESET;\n    }\n  }\n}\n// The \"after frameset\" insertion mode\n//------------------------------------------------------------------\nfunction startTagAfterFrameset(p, token) {\n  switch (token.tagID) {\n    case html_js_1.TAG_ID.HTML:\n      {\n        startTagInBody(p, token);\n        break;\n      }\n    case html_js_1.TAG_ID.NOFRAMES:\n      {\n        startTagInHead(p, token);\n        break;\n      }\n    default:\n    // Do nothing\n  }\n}\n\nfunction endTagAfterFrameset(p, token) {\n  if (token.tagID === html_js_1.TAG_ID.HTML) {\n    p.insertionMode = InsertionMode.AFTER_AFTER_FRAMESET;\n  }\n}\n// The \"after after body\" insertion mode\n//------------------------------------------------------------------\nfunction startTagAfterAfterBody(p, token) {\n  if (token.tagID === html_js_1.TAG_ID.HTML) {\n    startTagInBody(p, token);\n  } else {\n    tokenAfterAfterBody(p, token);\n  }\n}\nfunction tokenAfterAfterBody(p, token) {\n  p.insertionMode = InsertionMode.IN_BODY;\n  modeInBody(p, token);\n}\n// The \"after after frameset\" insertion mode\n//------------------------------------------------------------------\nfunction startTagAfterAfterFrameset(p, token) {\n  switch (token.tagID) {\n    case html_js_1.TAG_ID.HTML:\n      {\n        startTagInBody(p, token);\n        break;\n      }\n    case html_js_1.TAG_ID.NOFRAMES:\n      {\n        startTagInHead(p, token);\n        break;\n      }\n    default:\n    // Do nothing\n  }\n}\n// The rules for parsing tokens in foreign content\n//------------------------------------------------------------------\nfunction nullCharacterInForeignContent(p, token) {\n  token.chars = unicode.REPLACEMENT_CHARACTER;\n  p._insertCharacters(token);\n}\nfunction characterInForeignContent(p, token) {\n  p._insertCharacters(token);\n  p.framesetOk = false;\n}\nfunction popUntilHtmlOrIntegrationPoint(p) {\n  while (p.treeAdapter.getNamespaceURI(p.openElements.current) !== html_js_1.NS.HTML && !p._isIntegrationPoint(p.openElements.currentTagId, p.openElements.current)) {\n    p.openElements.pop();\n  }\n}\nfunction startTagInForeignContent(p, token) {\n  if (foreignContent.causesExit(token)) {\n    popUntilHtmlOrIntegrationPoint(p);\n    p._startTagOutsideForeignContent(token);\n  } else {\n    const current = p._getAdjustedCurrentElement();\n    const currentNs = p.treeAdapter.getNamespaceURI(current);\n    if (currentNs === html_js_1.NS.MATHML) {\n      foreignContent.adjustTokenMathMLAttrs(token);\n    } else if (currentNs === html_js_1.NS.SVG) {\n      foreignContent.adjustTokenSVGTagName(token);\n      foreignContent.adjustTokenSVGAttrs(token);\n    }\n    foreignContent.adjustTokenXMLAttrs(token);\n    if (token.selfClosing) {\n      p._appendElement(token, currentNs);\n    } else {\n      p._insertElement(token, currentNs);\n    }\n    token.ackSelfClosing = true;\n  }\n}\nfunction endTagInForeignContent(p, token) {\n  if (token.tagID === html_js_1.TAG_ID.P || token.tagID === html_js_1.TAG_ID.BR) {\n    popUntilHtmlOrIntegrationPoint(p);\n    p._endTagOutsideForeignContent(token);\n    return;\n  }\n  for (let i = p.openElements.stackTop; i > 0; i--) {\n    const element = p.openElements.items[i];\n    if (p.treeAdapter.getNamespaceURI(element) === html_js_1.NS.HTML) {\n      p._endTagOutsideForeignContent(token);\n      break;\n    }\n    const tagName = p.treeAdapter.getTagName(element);\n    if (tagName.toLowerCase() === token.tagName) {\n      //NOTE: update the token tag name for `_setEndLocation`.\n      token.tagName = tagName;\n      p.openElements.shortenToLength(i);\n      break;\n    }\n  }\n}","map":{"version":3,"names":["Object","defineProperty","exports","value","Parser","index_js_1","require","open_element_stack_js_1","formatting_element_list_js_1","default_js_1","doctype","foreignContent","error_codes_js_1","unicode","html_js_1","token_js_1","HIDDEN_INPUT_TYPE","AA_OUTER_LOOP_ITER","AA_INNER_LOOP_ITER","InsertionMode","BASE_LOC","startLine","startCol","startOffset","endLine","endCol","endOffset","TABLE_STRUCTURE_TAGS","Set","TAG_ID","TABLE","TBODY","TFOOT","THEAD","TR","defaultParserOptions","scriptingEnabled","sourceCodeLocationInfo","treeAdapter","defaultTreeAdapter","onParseError","constructor","options","document","fragmentContext","scriptHandler","currentToken","stopped","insertionMode","INITIAL","originalInsertionMode","headElement","formElement","currentNotInHTML","tmplInsertionModeStack","pendingCharacterTokens","hasNonWhitespacePendingCharacterToken","framesetOk","skipNextNewLine","fosterParentingEnabled","assign","createDocument","tokenizer","Tokenizer","activeFormattingElements","FormattingElementList","fragmentContextID","getTagID","getTagName","UNKNOWN","_setContextModes","openElements","OpenElementStack","parse","html","parser","write","getFragmentParser","opts","createElement","TAG_NAMES","TEMPLATE","NS","HTML","documentMock","unshift","IN_TEMPLATE","_initTokenizerForFragmentParsing","_insertFakeRootElement","_resetInsertionMode","_findFormInFragmentContext","getFragment","rootElement","getFirstChild","fragment","createDocumentFragment","_adoptNodes","_err","token","code","beforeToken","_a","loc","location","err","onItemPush","node","tid","isTop","_b","call","stackTop","onItemPop","_setEndLocation","current","currentTagId","isHTML","getNamespaceURI","inForeignNode","_isIntegrationPoint","_switchToTextParsing","nextTokenizerState","_insertElement","state","TEXT","switchToPlaintextParsing","IN_BODY","TokenizerMode","PLAINTEXT","_getAdjustedCurrentElement","FORM","getParentNode","TITLE","TEXTAREA","RCDATA","STYLE","XMP","IFRAME","NOEMBED","NOFRAMES","NOSCRIPT","RAWTEXT","SCRIPT","SCRIPT_DATA","_setDocumentType","name","publicId","systemId","setDocumentType","documentChildren","getChildNodes","docTypeNode","find","isDocumentTypeNode","setNodeSourceCodeLocation","_attachElementToTree","element","startTag","_shouldFosterParentOnInsertion","_fosterParentElement","parent","currentTmplContentOrNode","appendChild","_appendElement","namespaceURI","tagName","attrs","push","tagID","_insertFakeElement","_insertTemplate","tmpl","content","setTemplateContent","_appendCommentNode","commentNode","createCommentNode","data","_insertCharacters","beforeElement","_findFosterParentingLocation","insertTextBefore","chars","insertText","siblings","textNodeIdx","lastIndexOf","length","textNode","tnLoc","getNodeSourceCodeLocation","updateNodeSourceCodeLocation","donor","recipient","child","detachNode","closingToken","ctLoc","tn","endLoc","type","TokenType","END_TAG","endTag","shouldProcessStartTagTokenInForeignContent","SVG","ANNOTATION_XML","MATHML","MGLYPH","MALIGNMARK","_processToken","CHARACTER","onCharacter","NULL_CHARACTER","onNullCharacter","COMMENT","onComment","DOCTYPE","onDoctype","START_TAG","_processStartTag","onEndTag","EOF","onEof","WHITESPACE_CHARACTER","onWhitespaceCharacter","foreignNS","ns","getAttrList","isIntegrationPoint","_reconstructActiveFormattingElements","listLength","entries","endIndex","findIndex","entry","EntryType","Marker","contains","unopenIdx","i","_closeTableCell","generateImpliedEndTags","popUntilTableCellPopped","clearToLastMarker","IN_ROW","_closePElement","generateImpliedEndTagsWithExclusion","P","popUntilTagNamePopped","tagIDs","IN_TABLE_BODY","CAPTION","IN_CAPTION","COLGROUP","IN_COLUMN_GROUP","IN_TABLE","BODY","FRAMESET","IN_FRAMESET","SELECT","_resetInsertionModeForSelect","AFTER_HEAD","BEFORE_HEAD","TD","TH","IN_CELL","HEAD","IN_HEAD","selectIdx","IN_SELECT_IN_TABLE","IN_SELECT","_isElementCausesFosterParenting","has","openElement","items","getTemplateContent","insertBefore","_isSpecialElement","id","SPECIAL_ELEMENTS","characterInForeignContent","tokenInInitialMode","BEFORE_HTML","tokenBeforeHtml","tokenBeforeHead","tokenInHead","IN_HEAD_NO_SCRIPT","tokenInHeadNoScript","tokenAfterHead","characterInBody","characterInTable","IN_TABLE_TEXT","characterInTableText","tokenInColumnGroup","AFTER_BODY","tokenAfterBody","AFTER_AFTER_BODY","tokenAfterAfterBody","nullCharacterInForeignContent","appendComment","AFTER_FRAMESET","tokenInTableText","appendCommentToRootHtmlElement","AFTER_AFTER_FRAMESET","appendCommentToDocument","doctypeInInitialMode","ERR","misplacedDoctype","onStartTag","selfClosing","ackSelfClosing","nonVoidHtmlElementStartTagWithTrailingSolidus","startTagInForeignContent","_startTagOutsideForeignContent","startTagBeforeHtml","startTagBeforeHead","startTagInHead","startTagInHeadNoScript","startTagAfterHead","startTagInBody","startTagInTable","startTagInCaption","startTagInColumnGroup","startTagInTableBody","startTagInRow","startTagInCell","startTagInSelect","startTagInSelectInTable","startTagInTemplate","startTagAfterBody","startTagInFrameset","startTagAfterFrameset","startTagAfterAfterBody","startTagAfterAfterFrameset","endTagInForeignContent","_endTagOutsideForeignContent","endTagBeforeHtml","endTagBeforeHead","endTagInHead","endTagInHeadNoScript","endTagAfterHead","endTagInBody","endTagInText","endTagInTable","endTagInCaption","endTagInColumnGroup","endTagInTableBody","endTagInRow","endTagInCell","endTagInSelect","endTagInSelectInTable","endTagInTemplate","endTagAfterBody","endTagInFrameset","endTagAfterFrameset","eofInBody","eofInText","eofInTemplate","stopParsing","charCodeAt","CODE_POINTS","LINE_FEED","substr","whitespaceCharacterInBody","whitespaceCharacterInTableText","aaObtainFormattingElementEntry","p","formattingElementEntry","getElementEntryInScopeWithTagName","removeEntry","hasInScope","genericEndTagInBody","aaObtainFurthestBlock","furthestBlock","idx","shortenToLength","aaInnerLoop","formattingElement","lastElement","nextElement","getCommonAncestor","elementEntry","getElementEntry","counterOverflow","shouldRemoveFromOpenElements","remove","aaRecreateElementFromEntry","bookmark","newElement","replace","aaInsertLastNodeInCommonAncestor","commonAncestor","aaReplaceFormattingElement","insertElementAfterBookmark","insertAfter","callAdoptionAgency","target","htmlElement","htmlLocation","bodyElement","bodyLocation","mode","forceQuirks","DOCUMENT_MODE","QUIRKS","getDocumentMode","isConforming","nonConformingDoctype","setDocumentMode","missingDoctype","BR","endTagWithoutMatchingOpenElement","BASE","BASEFONT","BGSOUND","LINK","META","insertMarker","misplacedStartTagForHeadElement","pop","templateEndTagInHead","tmplCount","generateImpliedEndTagsThoroughly","closingOfElementWithOpenChildElements","shift","nestedNoscriptInHead","errCode","openElementsLeftAfterEof","disallowedContentInNoscriptInHead","abandonedHeadElementChild","modeInBody","htmlStartTagInBody","adoptAttributes","bodyStartTagInBody","tryPeekProperlyNestedBodyElement","framesetStartTagInBody","popAllUpToHtmlElement","addressStartTagInBody","hasInButtonScope","numberedHeaderStartTagInBody","isNumberedHeader","preStartTagInBody","formStartTagInBody","inTemplate","listItemStartTagInBody","elementId","LI","DD","DT","ADDRESS","DIV","plaintextStartTagInBody","buttonStartTagInBody","BUTTON","aStartTagInBody","activeElementEntry","A","pushElement","bStartTagInBody","nobrStartTagInBody","NOBR","appletStartTagInBody","tableStartTagInBody","areaStartTagInBody","isHiddenInput","inputType","getTokenAttr","ATTRS","TYPE","toLowerCase","inputStartTagInBody","paramStartTagInBody","hrStartTagInBody","imageStartTagInBody","IMG","textareaStartTagInBody","xmpStartTagInBody","iframeStartTagInBody","noembedStartTagInBody","selectStartTagInBody","optgroupStartTagInBody","OPTION","rbStartTagInBody","RUBY","rtStartTagInBody","RTC","mathStartTagInBody","adjustTokenMathMLAttrs","adjustTokenXMLAttrs","svgStartTagInBody","adjustTokenSVGAttrs","genericStartTagInBody","I","S","B","U","EM","TT","BIG","CODE","FONT","SMALL","STRIKE","STRONG","H1","H2","H3","H4","H5","H6","DL","OL","UL","DIR","NAV","MAIN","MENU","ASIDE","CENTER","FIGURE","FOOTER","HEADER","HGROUP","DIALOG","DETAILS","ARTICLE","SECTION","SUMMARY","FIELDSET","BLOCKQUOTE","FIGCAPTION","WBR","AREA","EMBED","KEYGEN","HR","RB","RT","RP","PRE","LISTING","MATH","INPUT","PARAM","TRACK","SOURCE","IMAGE","APPLET","OBJECT","MARQUEE","OPTGROUP","COL","FRAME","bodyEndTagInBody","htmlEndTagInBody","addressEndTagInBody","formEndTagInBody","pEndTagInBody","liEndTagInBody","hasInListItemScope","ddEndTagInBody","numberedHeaderEndTagInBody","hasNumberedHeaderInScope","popUntilNumberedHeaderPopped","appletEndTagInBody","brEndTagInBody","eofInElementThatCanContainOnlyText","tokenInTable","captionStartTagInTable","clearBackToTableContext","colgroupStartTagInTable","colStartTagInTable","tbodyStartTagInTable","tdStartTagInTable","tableStartTagInTable","hasInTableScope","inputStartTagInTable","formStartTagInTable","savedFosterParentingState","TABLE_VOID_ELEMENTS","clearBackToTableBodyContext","hasTableBodyContextInTableScope","clearBackToTableRowContext","hasInSelectScope","isRootHtmlElementCurrent","REPLACEMENT_CHARACTER","popUntilHtmlOrIntegrationPoint","causesExit","currentNs","adjustTokenSVGTagName"],"sources":["C:/programowanko/react/schedule-formatter/schedule-formatter/node_modules/parse5-htmlparser2-tree-adapter/node_modules/parse5/dist/cjs/parser/index.js"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Parser = void 0;\nconst index_js_1 = require(\"../tokenizer/index.js\");\nconst open_element_stack_js_1 = require(\"./open-element-stack.js\");\nconst formatting_element_list_js_1 = require(\"./formatting-element-list.js\");\nconst default_js_1 = require(\"../tree-adapters/default.js\");\nconst doctype = require(\"../common/doctype.js\");\nconst foreignContent = require(\"../common/foreign-content.js\");\nconst error_codes_js_1 = require(\"../common/error-codes.js\");\nconst unicode = require(\"../common/unicode.js\");\nconst html_js_1 = require(\"../common/html.js\");\nconst token_js_1 = require(\"../common/token.js\");\n//Misc constants\nconst HIDDEN_INPUT_TYPE = 'hidden';\n//Adoption agency loops iteration count\nconst AA_OUTER_LOOP_ITER = 8;\nconst AA_INNER_LOOP_ITER = 3;\n//Insertion modes\nvar InsertionMode;\n(function (InsertionMode) {\n    InsertionMode[InsertionMode[\"INITIAL\"] = 0] = \"INITIAL\";\n    InsertionMode[InsertionMode[\"BEFORE_HTML\"] = 1] = \"BEFORE_HTML\";\n    InsertionMode[InsertionMode[\"BEFORE_HEAD\"] = 2] = \"BEFORE_HEAD\";\n    InsertionMode[InsertionMode[\"IN_HEAD\"] = 3] = \"IN_HEAD\";\n    InsertionMode[InsertionMode[\"IN_HEAD_NO_SCRIPT\"] = 4] = \"IN_HEAD_NO_SCRIPT\";\n    InsertionMode[InsertionMode[\"AFTER_HEAD\"] = 5] = \"AFTER_HEAD\";\n    InsertionMode[InsertionMode[\"IN_BODY\"] = 6] = \"IN_BODY\";\n    InsertionMode[InsertionMode[\"TEXT\"] = 7] = \"TEXT\";\n    InsertionMode[InsertionMode[\"IN_TABLE\"] = 8] = \"IN_TABLE\";\n    InsertionMode[InsertionMode[\"IN_TABLE_TEXT\"] = 9] = \"IN_TABLE_TEXT\";\n    InsertionMode[InsertionMode[\"IN_CAPTION\"] = 10] = \"IN_CAPTION\";\n    InsertionMode[InsertionMode[\"IN_COLUMN_GROUP\"] = 11] = \"IN_COLUMN_GROUP\";\n    InsertionMode[InsertionMode[\"IN_TABLE_BODY\"] = 12] = \"IN_TABLE_BODY\";\n    InsertionMode[InsertionMode[\"IN_ROW\"] = 13] = \"IN_ROW\";\n    InsertionMode[InsertionMode[\"IN_CELL\"] = 14] = \"IN_CELL\";\n    InsertionMode[InsertionMode[\"IN_SELECT\"] = 15] = \"IN_SELECT\";\n    InsertionMode[InsertionMode[\"IN_SELECT_IN_TABLE\"] = 16] = \"IN_SELECT_IN_TABLE\";\n    InsertionMode[InsertionMode[\"IN_TEMPLATE\"] = 17] = \"IN_TEMPLATE\";\n    InsertionMode[InsertionMode[\"AFTER_BODY\"] = 18] = \"AFTER_BODY\";\n    InsertionMode[InsertionMode[\"IN_FRAMESET\"] = 19] = \"IN_FRAMESET\";\n    InsertionMode[InsertionMode[\"AFTER_FRAMESET\"] = 20] = \"AFTER_FRAMESET\";\n    InsertionMode[InsertionMode[\"AFTER_AFTER_BODY\"] = 21] = \"AFTER_AFTER_BODY\";\n    InsertionMode[InsertionMode[\"AFTER_AFTER_FRAMESET\"] = 22] = \"AFTER_AFTER_FRAMESET\";\n})(InsertionMode || (InsertionMode = {}));\nconst BASE_LOC = {\n    startLine: -1,\n    startCol: -1,\n    startOffset: -1,\n    endLine: -1,\n    endCol: -1,\n    endOffset: -1,\n};\nconst TABLE_STRUCTURE_TAGS = new Set([html_js_1.TAG_ID.TABLE, html_js_1.TAG_ID.TBODY, html_js_1.TAG_ID.TFOOT, html_js_1.TAG_ID.THEAD, html_js_1.TAG_ID.TR]);\nconst defaultParserOptions = {\n    scriptingEnabled: true,\n    sourceCodeLocationInfo: false,\n    treeAdapter: default_js_1.defaultTreeAdapter,\n    onParseError: null,\n};\n//Parser\nclass Parser {\n    constructor(options, document, fragmentContext = null, scriptHandler = null) {\n        this.fragmentContext = fragmentContext;\n        this.scriptHandler = scriptHandler;\n        this.currentToken = null;\n        this.stopped = false;\n        this.insertionMode = InsertionMode.INITIAL;\n        this.originalInsertionMode = InsertionMode.INITIAL;\n        this.headElement = null;\n        this.formElement = null;\n        /** Indicates that the current node is not an element in the HTML namespace */\n        this.currentNotInHTML = false;\n        /**\n         * The template insertion mode stack is maintained from the left.\n         * Ie. the topmost element will always have index 0.\n         */\n        this.tmplInsertionModeStack = [];\n        this.pendingCharacterTokens = [];\n        this.hasNonWhitespacePendingCharacterToken = false;\n        this.framesetOk = true;\n        this.skipNextNewLine = false;\n        this.fosterParentingEnabled = false;\n        this.options = Object.assign(Object.assign({}, defaultParserOptions), options);\n        this.treeAdapter = this.options.treeAdapter;\n        this.onParseError = this.options.onParseError;\n        // Always enable location info if we report parse errors.\n        if (this.onParseError) {\n            this.options.sourceCodeLocationInfo = true;\n        }\n        this.document = document !== null && document !== void 0 ? document : this.treeAdapter.createDocument();\n        this.tokenizer = new index_js_1.Tokenizer(this.options, this);\n        this.activeFormattingElements = new formatting_element_list_js_1.FormattingElementList(this.treeAdapter);\n        this.fragmentContextID = fragmentContext ? (0, html_js_1.getTagID)(this.treeAdapter.getTagName(fragmentContext)) : html_js_1.TAG_ID.UNKNOWN;\n        this._setContextModes(fragmentContext !== null && fragmentContext !== void 0 ? fragmentContext : this.document, this.fragmentContextID);\n        this.openElements = new open_element_stack_js_1.OpenElementStack(this.document, this.treeAdapter, this);\n    }\n    // API\n    static parse(html, options) {\n        const parser = new this(options);\n        parser.tokenizer.write(html, true);\n        return parser.document;\n    }\n    static getFragmentParser(fragmentContext, options) {\n        const opts = Object.assign(Object.assign({}, defaultParserOptions), options);\n        //NOTE: use a <template> element as the fragment context if no context element was provided,\n        //so we will parse in a \"forgiving\" manner\n        fragmentContext !== null && fragmentContext !== void 0 ? fragmentContext : (fragmentContext = opts.treeAdapter.createElement(html_js_1.TAG_NAMES.TEMPLATE, html_js_1.NS.HTML, []));\n        //NOTE: create a fake element which will be used as the `document` for fragment parsing.\n        //This is important for jsdom, where a new `document` cannot be created. This led to\n        //fragment parsing messing with the main `document`.\n        const documentMock = opts.treeAdapter.createElement('documentmock', html_js_1.NS.HTML, []);\n        const parser = new this(opts, documentMock, fragmentContext);\n        if (parser.fragmentContextID === html_js_1.TAG_ID.TEMPLATE) {\n            parser.tmplInsertionModeStack.unshift(InsertionMode.IN_TEMPLATE);\n        }\n        parser._initTokenizerForFragmentParsing();\n        parser._insertFakeRootElement();\n        parser._resetInsertionMode();\n        parser._findFormInFragmentContext();\n        return parser;\n    }\n    getFragment() {\n        const rootElement = this.treeAdapter.getFirstChild(this.document);\n        const fragment = this.treeAdapter.createDocumentFragment();\n        this._adoptNodes(rootElement, fragment);\n        return fragment;\n    }\n    //Errors\n    _err(token, code, beforeToken) {\n        var _a;\n        if (!this.onParseError)\n            return;\n        const loc = (_a = token.location) !== null && _a !== void 0 ? _a : BASE_LOC;\n        const err = {\n            code,\n            startLine: loc.startLine,\n            startCol: loc.startCol,\n            startOffset: loc.startOffset,\n            endLine: beforeToken ? loc.startLine : loc.endLine,\n            endCol: beforeToken ? loc.startCol : loc.endCol,\n            endOffset: beforeToken ? loc.startOffset : loc.endOffset,\n        };\n        this.onParseError(err);\n    }\n    //Stack events\n    onItemPush(node, tid, isTop) {\n        var _a, _b;\n        (_b = (_a = this.treeAdapter).onItemPush) === null || _b === void 0 ? void 0 : _b.call(_a, node);\n        if (isTop && this.openElements.stackTop > 0)\n            this._setContextModes(node, tid);\n    }\n    onItemPop(node, isTop) {\n        var _a, _b;\n        if (this.options.sourceCodeLocationInfo) {\n            this._setEndLocation(node, this.currentToken);\n        }\n        (_b = (_a = this.treeAdapter).onItemPop) === null || _b === void 0 ? void 0 : _b.call(_a, node, this.openElements.current);\n        if (isTop) {\n            let current;\n            let currentTagId;\n            if (this.openElements.stackTop === 0 && this.fragmentContext) {\n                current = this.fragmentContext;\n                currentTagId = this.fragmentContextID;\n            }\n            else {\n                ({ current, currentTagId } = this.openElements);\n            }\n            this._setContextModes(current, currentTagId);\n        }\n    }\n    _setContextModes(current, tid) {\n        const isHTML = current === this.document || this.treeAdapter.getNamespaceURI(current) === html_js_1.NS.HTML;\n        this.currentNotInHTML = !isHTML;\n        this.tokenizer.inForeignNode = !isHTML && !this._isIntegrationPoint(tid, current);\n    }\n    _switchToTextParsing(currentToken, nextTokenizerState) {\n        this._insertElement(currentToken, html_js_1.NS.HTML);\n        this.tokenizer.state = nextTokenizerState;\n        this.originalInsertionMode = this.insertionMode;\n        this.insertionMode = InsertionMode.TEXT;\n    }\n    switchToPlaintextParsing() {\n        this.insertionMode = InsertionMode.TEXT;\n        this.originalInsertionMode = InsertionMode.IN_BODY;\n        this.tokenizer.state = index_js_1.TokenizerMode.PLAINTEXT;\n    }\n    //Fragment parsing\n    _getAdjustedCurrentElement() {\n        return this.openElements.stackTop === 0 && this.fragmentContext\n            ? this.fragmentContext\n            : this.openElements.current;\n    }\n    _findFormInFragmentContext() {\n        let node = this.fragmentContext;\n        while (node) {\n            if (this.treeAdapter.getTagName(node) === html_js_1.TAG_NAMES.FORM) {\n                this.formElement = node;\n                break;\n            }\n            node = this.treeAdapter.getParentNode(node);\n        }\n    }\n    _initTokenizerForFragmentParsing() {\n        if (!this.fragmentContext || this.treeAdapter.getNamespaceURI(this.fragmentContext) !== html_js_1.NS.HTML) {\n            return;\n        }\n        switch (this.fragmentContextID) {\n            case html_js_1.TAG_ID.TITLE:\n            case html_js_1.TAG_ID.TEXTAREA: {\n                this.tokenizer.state = index_js_1.TokenizerMode.RCDATA;\n                break;\n            }\n            case html_js_1.TAG_ID.STYLE:\n            case html_js_1.TAG_ID.XMP:\n            case html_js_1.TAG_ID.IFRAME:\n            case html_js_1.TAG_ID.NOEMBED:\n            case html_js_1.TAG_ID.NOFRAMES:\n            case html_js_1.TAG_ID.NOSCRIPT: {\n                this.tokenizer.state = index_js_1.TokenizerMode.RAWTEXT;\n                break;\n            }\n            case html_js_1.TAG_ID.SCRIPT: {\n                this.tokenizer.state = index_js_1.TokenizerMode.SCRIPT_DATA;\n                break;\n            }\n            case html_js_1.TAG_ID.PLAINTEXT: {\n                this.tokenizer.state = index_js_1.TokenizerMode.PLAINTEXT;\n                break;\n            }\n            default:\n            // Do nothing\n        }\n    }\n    //Tree mutation\n    _setDocumentType(token) {\n        const name = token.name || '';\n        const publicId = token.publicId || '';\n        const systemId = token.systemId || '';\n        this.treeAdapter.setDocumentType(this.document, name, publicId, systemId);\n        if (token.location) {\n            const documentChildren = this.treeAdapter.getChildNodes(this.document);\n            const docTypeNode = documentChildren.find((node) => this.treeAdapter.isDocumentTypeNode(node));\n            if (docTypeNode) {\n                this.treeAdapter.setNodeSourceCodeLocation(docTypeNode, token.location);\n            }\n        }\n    }\n    _attachElementToTree(element, location) {\n        if (this.options.sourceCodeLocationInfo) {\n            const loc = location && Object.assign(Object.assign({}, location), { startTag: location });\n            this.treeAdapter.setNodeSourceCodeLocation(element, loc);\n        }\n        if (this._shouldFosterParentOnInsertion()) {\n            this._fosterParentElement(element);\n        }\n        else {\n            const parent = this.openElements.currentTmplContentOrNode;\n            this.treeAdapter.appendChild(parent, element);\n        }\n    }\n    _appendElement(token, namespaceURI) {\n        const element = this.treeAdapter.createElement(token.tagName, namespaceURI, token.attrs);\n        this._attachElementToTree(element, token.location);\n    }\n    _insertElement(token, namespaceURI) {\n        const element = this.treeAdapter.createElement(token.tagName, namespaceURI, token.attrs);\n        this._attachElementToTree(element, token.location);\n        this.openElements.push(element, token.tagID);\n    }\n    _insertFakeElement(tagName, tagID) {\n        const element = this.treeAdapter.createElement(tagName, html_js_1.NS.HTML, []);\n        this._attachElementToTree(element, null);\n        this.openElements.push(element, tagID);\n    }\n    _insertTemplate(token) {\n        const tmpl = this.treeAdapter.createElement(token.tagName, html_js_1.NS.HTML, token.attrs);\n        const content = this.treeAdapter.createDocumentFragment();\n        this.treeAdapter.setTemplateContent(tmpl, content);\n        this._attachElementToTree(tmpl, token.location);\n        this.openElements.push(tmpl, token.tagID);\n        if (this.options.sourceCodeLocationInfo)\n            this.treeAdapter.setNodeSourceCodeLocation(content, null);\n    }\n    _insertFakeRootElement() {\n        const element = this.treeAdapter.createElement(html_js_1.TAG_NAMES.HTML, html_js_1.NS.HTML, []);\n        if (this.options.sourceCodeLocationInfo)\n            this.treeAdapter.setNodeSourceCodeLocation(element, null);\n        this.treeAdapter.appendChild(this.openElements.current, element);\n        this.openElements.push(element, html_js_1.TAG_ID.HTML);\n    }\n    _appendCommentNode(token, parent) {\n        const commentNode = this.treeAdapter.createCommentNode(token.data);\n        this.treeAdapter.appendChild(parent, commentNode);\n        if (this.options.sourceCodeLocationInfo) {\n            this.treeAdapter.setNodeSourceCodeLocation(commentNode, token.location);\n        }\n    }\n    _insertCharacters(token) {\n        let parent;\n        let beforeElement;\n        if (this._shouldFosterParentOnInsertion()) {\n            ({ parent, beforeElement } = this._findFosterParentingLocation());\n            if (beforeElement) {\n                this.treeAdapter.insertTextBefore(parent, token.chars, beforeElement);\n            }\n            else {\n                this.treeAdapter.insertText(parent, token.chars);\n            }\n        }\n        else {\n            parent = this.openElements.currentTmplContentOrNode;\n            this.treeAdapter.insertText(parent, token.chars);\n        }\n        if (!token.location)\n            return;\n        const siblings = this.treeAdapter.getChildNodes(parent);\n        const textNodeIdx = beforeElement ? siblings.lastIndexOf(beforeElement) : siblings.length;\n        const textNode = siblings[textNodeIdx - 1];\n        //NOTE: if we have a location assigned by another token, then just update the end position\n        const tnLoc = this.treeAdapter.getNodeSourceCodeLocation(textNode);\n        if (tnLoc) {\n            const { endLine, endCol, endOffset } = token.location;\n            this.treeAdapter.updateNodeSourceCodeLocation(textNode, { endLine, endCol, endOffset });\n        }\n        else if (this.options.sourceCodeLocationInfo) {\n            this.treeAdapter.setNodeSourceCodeLocation(textNode, token.location);\n        }\n    }\n    _adoptNodes(donor, recipient) {\n        for (let child = this.treeAdapter.getFirstChild(donor); child; child = this.treeAdapter.getFirstChild(donor)) {\n            this.treeAdapter.detachNode(child);\n            this.treeAdapter.appendChild(recipient, child);\n        }\n    }\n    _setEndLocation(element, closingToken) {\n        if (this.treeAdapter.getNodeSourceCodeLocation(element) && closingToken.location) {\n            const ctLoc = closingToken.location;\n            const tn = this.treeAdapter.getTagName(element);\n            const endLoc = \n            // NOTE: For cases like <p> <p> </p> - First 'p' closes without a closing\n            // tag and for cases like <td> <p> </td> - 'p' closes without a closing tag.\n            closingToken.type === token_js_1.TokenType.END_TAG && tn === closingToken.tagName\n                ? {\n                    endTag: Object.assign({}, ctLoc),\n                    endLine: ctLoc.endLine,\n                    endCol: ctLoc.endCol,\n                    endOffset: ctLoc.endOffset,\n                }\n                : {\n                    endLine: ctLoc.startLine,\n                    endCol: ctLoc.startCol,\n                    endOffset: ctLoc.startOffset,\n                };\n            this.treeAdapter.updateNodeSourceCodeLocation(element, endLoc);\n        }\n    }\n    //Token processing\n    shouldProcessStartTagTokenInForeignContent(token) {\n        // Check that neither current === document, or ns === NS.HTML\n        if (!this.currentNotInHTML)\n            return false;\n        let current;\n        let currentTagId;\n        if (this.openElements.stackTop === 0 && this.fragmentContext) {\n            current = this.fragmentContext;\n            currentTagId = this.fragmentContextID;\n        }\n        else {\n            ({ current, currentTagId } = this.openElements);\n        }\n        if (token.tagID === html_js_1.TAG_ID.SVG &&\n            this.treeAdapter.getTagName(current) === html_js_1.TAG_NAMES.ANNOTATION_XML &&\n            this.treeAdapter.getNamespaceURI(current) === html_js_1.NS.MATHML) {\n            return false;\n        }\n        return (\n        // Check that `current` is not an integration point for HTML or MathML elements.\n        this.tokenizer.inForeignNode ||\n            // If it _is_ an integration point, then we might have to check that it is not an HTML\n            // integration point.\n            ((token.tagID === html_js_1.TAG_ID.MGLYPH || token.tagID === html_js_1.TAG_ID.MALIGNMARK) &&\n                !this._isIntegrationPoint(currentTagId, current, html_js_1.NS.HTML)));\n    }\n    _processToken(token) {\n        switch (token.type) {\n            case token_js_1.TokenType.CHARACTER: {\n                this.onCharacter(token);\n                break;\n            }\n            case token_js_1.TokenType.NULL_CHARACTER: {\n                this.onNullCharacter(token);\n                break;\n            }\n            case token_js_1.TokenType.COMMENT: {\n                this.onComment(token);\n                break;\n            }\n            case token_js_1.TokenType.DOCTYPE: {\n                this.onDoctype(token);\n                break;\n            }\n            case token_js_1.TokenType.START_TAG: {\n                this._processStartTag(token);\n                break;\n            }\n            case token_js_1.TokenType.END_TAG: {\n                this.onEndTag(token);\n                break;\n            }\n            case token_js_1.TokenType.EOF: {\n                this.onEof(token);\n                break;\n            }\n            case token_js_1.TokenType.WHITESPACE_CHARACTER: {\n                this.onWhitespaceCharacter(token);\n                break;\n            }\n        }\n    }\n    //Integration points\n    _isIntegrationPoint(tid, element, foreignNS) {\n        const ns = this.treeAdapter.getNamespaceURI(element);\n        const attrs = this.treeAdapter.getAttrList(element);\n        return foreignContent.isIntegrationPoint(tid, ns, attrs, foreignNS);\n    }\n    //Active formatting elements reconstruction\n    _reconstructActiveFormattingElements() {\n        const listLength = this.activeFormattingElements.entries.length;\n        if (listLength) {\n            const endIndex = this.activeFormattingElements.entries.findIndex((entry) => entry.type === formatting_element_list_js_1.EntryType.Marker || this.openElements.contains(entry.element));\n            const unopenIdx = endIndex < 0 ? listLength - 1 : endIndex - 1;\n            for (let i = unopenIdx; i >= 0; i--) {\n                const entry = this.activeFormattingElements.entries[i];\n                this._insertElement(entry.token, this.treeAdapter.getNamespaceURI(entry.element));\n                entry.element = this.openElements.current;\n            }\n        }\n    }\n    //Close elements\n    _closeTableCell() {\n        this.openElements.generateImpliedEndTags();\n        this.openElements.popUntilTableCellPopped();\n        this.activeFormattingElements.clearToLastMarker();\n        this.insertionMode = InsertionMode.IN_ROW;\n    }\n    _closePElement() {\n        this.openElements.generateImpliedEndTagsWithExclusion(html_js_1.TAG_ID.P);\n        this.openElements.popUntilTagNamePopped(html_js_1.TAG_ID.P);\n    }\n    //Insertion modes\n    _resetInsertionMode() {\n        for (let i = this.openElements.stackTop; i >= 0; i--) {\n            //Insertion mode reset map\n            switch (i === 0 && this.fragmentContext ? this.fragmentContextID : this.openElements.tagIDs[i]) {\n                case html_js_1.TAG_ID.TR:\n                    this.insertionMode = InsertionMode.IN_ROW;\n                    return;\n                case html_js_1.TAG_ID.TBODY:\n                case html_js_1.TAG_ID.THEAD:\n                case html_js_1.TAG_ID.TFOOT:\n                    this.insertionMode = InsertionMode.IN_TABLE_BODY;\n                    return;\n                case html_js_1.TAG_ID.CAPTION:\n                    this.insertionMode = InsertionMode.IN_CAPTION;\n                    return;\n                case html_js_1.TAG_ID.COLGROUP:\n                    this.insertionMode = InsertionMode.IN_COLUMN_GROUP;\n                    return;\n                case html_js_1.TAG_ID.TABLE:\n                    this.insertionMode = InsertionMode.IN_TABLE;\n                    return;\n                case html_js_1.TAG_ID.BODY:\n                    this.insertionMode = InsertionMode.IN_BODY;\n                    return;\n                case html_js_1.TAG_ID.FRAMESET:\n                    this.insertionMode = InsertionMode.IN_FRAMESET;\n                    return;\n                case html_js_1.TAG_ID.SELECT:\n                    this._resetInsertionModeForSelect(i);\n                    return;\n                case html_js_1.TAG_ID.TEMPLATE:\n                    this.insertionMode = this.tmplInsertionModeStack[0];\n                    return;\n                case html_js_1.TAG_ID.HTML:\n                    this.insertionMode = this.headElement ? InsertionMode.AFTER_HEAD : InsertionMode.BEFORE_HEAD;\n                    return;\n                case html_js_1.TAG_ID.TD:\n                case html_js_1.TAG_ID.TH:\n                    if (i > 0) {\n                        this.insertionMode = InsertionMode.IN_CELL;\n                        return;\n                    }\n                    break;\n                case html_js_1.TAG_ID.HEAD:\n                    if (i > 0) {\n                        this.insertionMode = InsertionMode.IN_HEAD;\n                        return;\n                    }\n                    break;\n            }\n        }\n        this.insertionMode = InsertionMode.IN_BODY;\n    }\n    _resetInsertionModeForSelect(selectIdx) {\n        if (selectIdx > 0) {\n            for (let i = selectIdx - 1; i > 0; i--) {\n                const tn = this.openElements.tagIDs[i];\n                if (tn === html_js_1.TAG_ID.TEMPLATE) {\n                    break;\n                }\n                else if (tn === html_js_1.TAG_ID.TABLE) {\n                    this.insertionMode = InsertionMode.IN_SELECT_IN_TABLE;\n                    return;\n                }\n            }\n        }\n        this.insertionMode = InsertionMode.IN_SELECT;\n    }\n    //Foster parenting\n    _isElementCausesFosterParenting(tn) {\n        return TABLE_STRUCTURE_TAGS.has(tn);\n    }\n    _shouldFosterParentOnInsertion() {\n        return this.fosterParentingEnabled && this._isElementCausesFosterParenting(this.openElements.currentTagId);\n    }\n    _findFosterParentingLocation() {\n        for (let i = this.openElements.stackTop; i >= 0; i--) {\n            const openElement = this.openElements.items[i];\n            switch (this.openElements.tagIDs[i]) {\n                case html_js_1.TAG_ID.TEMPLATE:\n                    if (this.treeAdapter.getNamespaceURI(openElement) === html_js_1.NS.HTML) {\n                        return { parent: this.treeAdapter.getTemplateContent(openElement), beforeElement: null };\n                    }\n                    break;\n                case html_js_1.TAG_ID.TABLE: {\n                    const parent = this.treeAdapter.getParentNode(openElement);\n                    if (parent) {\n                        return { parent, beforeElement: openElement };\n                    }\n                    return { parent: this.openElements.items[i - 1], beforeElement: null };\n                }\n                default:\n                // Do nothing\n            }\n        }\n        return { parent: this.openElements.items[0], beforeElement: null };\n    }\n    _fosterParentElement(element) {\n        const location = this._findFosterParentingLocation();\n        if (location.beforeElement) {\n            this.treeAdapter.insertBefore(location.parent, element, location.beforeElement);\n        }\n        else {\n            this.treeAdapter.appendChild(location.parent, element);\n        }\n    }\n    //Special elements\n    _isSpecialElement(element, id) {\n        const ns = this.treeAdapter.getNamespaceURI(element);\n        return html_js_1.SPECIAL_ELEMENTS[ns].has(id);\n    }\n    onCharacter(token) {\n        this.skipNextNewLine = false;\n        if (this.tokenizer.inForeignNode) {\n            characterInForeignContent(this, token);\n            return;\n        }\n        switch (this.insertionMode) {\n            case InsertionMode.INITIAL:\n                tokenInInitialMode(this, token);\n                break;\n            case InsertionMode.BEFORE_HTML:\n                tokenBeforeHtml(this, token);\n                break;\n            case InsertionMode.BEFORE_HEAD:\n                tokenBeforeHead(this, token);\n                break;\n            case InsertionMode.IN_HEAD:\n                tokenInHead(this, token);\n                break;\n            case InsertionMode.IN_HEAD_NO_SCRIPT:\n                tokenInHeadNoScript(this, token);\n                break;\n            case InsertionMode.AFTER_HEAD:\n                tokenAfterHead(this, token);\n                break;\n            case InsertionMode.IN_BODY:\n            case InsertionMode.IN_CAPTION:\n            case InsertionMode.IN_CELL:\n            case InsertionMode.IN_TEMPLATE:\n                characterInBody(this, token);\n                break;\n            case InsertionMode.TEXT:\n            case InsertionMode.IN_SELECT:\n            case InsertionMode.IN_SELECT_IN_TABLE:\n                this._insertCharacters(token);\n                break;\n            case InsertionMode.IN_TABLE:\n            case InsertionMode.IN_TABLE_BODY:\n            case InsertionMode.IN_ROW:\n                characterInTable(this, token);\n                break;\n            case InsertionMode.IN_TABLE_TEXT:\n                characterInTableText(this, token);\n                break;\n            case InsertionMode.IN_COLUMN_GROUP:\n                tokenInColumnGroup(this, token);\n                break;\n            case InsertionMode.AFTER_BODY:\n                tokenAfterBody(this, token);\n                break;\n            case InsertionMode.AFTER_AFTER_BODY:\n                tokenAfterAfterBody(this, token);\n                break;\n            default:\n            // Do nothing\n        }\n    }\n    onNullCharacter(token) {\n        this.skipNextNewLine = false;\n        if (this.tokenizer.inForeignNode) {\n            nullCharacterInForeignContent(this, token);\n            return;\n        }\n        switch (this.insertionMode) {\n            case InsertionMode.INITIAL:\n                tokenInInitialMode(this, token);\n                break;\n            case InsertionMode.BEFORE_HTML:\n                tokenBeforeHtml(this, token);\n                break;\n            case InsertionMode.BEFORE_HEAD:\n                tokenBeforeHead(this, token);\n                break;\n            case InsertionMode.IN_HEAD:\n                tokenInHead(this, token);\n                break;\n            case InsertionMode.IN_HEAD_NO_SCRIPT:\n                tokenInHeadNoScript(this, token);\n                break;\n            case InsertionMode.AFTER_HEAD:\n                tokenAfterHead(this, token);\n                break;\n            case InsertionMode.TEXT:\n                this._insertCharacters(token);\n                break;\n            case InsertionMode.IN_TABLE:\n            case InsertionMode.IN_TABLE_BODY:\n            case InsertionMode.IN_ROW:\n                characterInTable(this, token);\n                break;\n            case InsertionMode.IN_COLUMN_GROUP:\n                tokenInColumnGroup(this, token);\n                break;\n            case InsertionMode.AFTER_BODY:\n                tokenAfterBody(this, token);\n                break;\n            case InsertionMode.AFTER_AFTER_BODY:\n                tokenAfterAfterBody(this, token);\n                break;\n            default:\n            // Do nothing\n        }\n    }\n    onComment(token) {\n        this.skipNextNewLine = false;\n        if (this.currentNotInHTML) {\n            appendComment(this, token);\n            return;\n        }\n        switch (this.insertionMode) {\n            case InsertionMode.INITIAL:\n            case InsertionMode.BEFORE_HTML:\n            case InsertionMode.BEFORE_HEAD:\n            case InsertionMode.IN_HEAD:\n            case InsertionMode.IN_HEAD_NO_SCRIPT:\n            case InsertionMode.AFTER_HEAD:\n            case InsertionMode.IN_BODY:\n            case InsertionMode.IN_TABLE:\n            case InsertionMode.IN_CAPTION:\n            case InsertionMode.IN_COLUMN_GROUP:\n            case InsertionMode.IN_TABLE_BODY:\n            case InsertionMode.IN_ROW:\n            case InsertionMode.IN_CELL:\n            case InsertionMode.IN_SELECT:\n            case InsertionMode.IN_SELECT_IN_TABLE:\n            case InsertionMode.IN_TEMPLATE:\n            case InsertionMode.IN_FRAMESET:\n            case InsertionMode.AFTER_FRAMESET:\n                appendComment(this, token);\n                break;\n            case InsertionMode.IN_TABLE_TEXT:\n                tokenInTableText(this, token);\n                break;\n            case InsertionMode.AFTER_BODY:\n                appendCommentToRootHtmlElement(this, token);\n                break;\n            case InsertionMode.AFTER_AFTER_BODY:\n            case InsertionMode.AFTER_AFTER_FRAMESET:\n                appendCommentToDocument(this, token);\n                break;\n            default:\n            // Do nothing\n        }\n    }\n    onDoctype(token) {\n        this.skipNextNewLine = false;\n        switch (this.insertionMode) {\n            case InsertionMode.INITIAL:\n                doctypeInInitialMode(this, token);\n                break;\n            case InsertionMode.BEFORE_HEAD:\n            case InsertionMode.IN_HEAD:\n            case InsertionMode.IN_HEAD_NO_SCRIPT:\n            case InsertionMode.AFTER_HEAD:\n                this._err(token, error_codes_js_1.ERR.misplacedDoctype);\n                break;\n            case InsertionMode.IN_TABLE_TEXT:\n                tokenInTableText(this, token);\n                break;\n            default:\n            // Do nothing\n        }\n    }\n    onStartTag(token) {\n        this.skipNextNewLine = false;\n        this.currentToken = token;\n        this._processStartTag(token);\n        if (token.selfClosing && !token.ackSelfClosing) {\n            this._err(token, error_codes_js_1.ERR.nonVoidHtmlElementStartTagWithTrailingSolidus);\n        }\n    }\n    /**\n     * Processes a given start tag.\n     *\n     * `onStartTag` checks if a self-closing tag was recognized. When a token\n     * is moved inbetween multiple insertion modes, this check for self-closing\n     * could lead to false positives. To avoid this, `_processStartTag` is used\n     * for nested calls.\n     *\n     * @param token The token to process.\n     */\n    _processStartTag(token) {\n        if (this.shouldProcessStartTagTokenInForeignContent(token)) {\n            startTagInForeignContent(this, token);\n        }\n        else {\n            this._startTagOutsideForeignContent(token);\n        }\n    }\n    _startTagOutsideForeignContent(token) {\n        switch (this.insertionMode) {\n            case InsertionMode.INITIAL:\n                tokenInInitialMode(this, token);\n                break;\n            case InsertionMode.BEFORE_HTML:\n                startTagBeforeHtml(this, token);\n                break;\n            case InsertionMode.BEFORE_HEAD:\n                startTagBeforeHead(this, token);\n                break;\n            case InsertionMode.IN_HEAD:\n                startTagInHead(this, token);\n                break;\n            case InsertionMode.IN_HEAD_NO_SCRIPT:\n                startTagInHeadNoScript(this, token);\n                break;\n            case InsertionMode.AFTER_HEAD:\n                startTagAfterHead(this, token);\n                break;\n            case InsertionMode.IN_BODY:\n                startTagInBody(this, token);\n                break;\n            case InsertionMode.IN_TABLE:\n                startTagInTable(this, token);\n                break;\n            case InsertionMode.IN_TABLE_TEXT:\n                tokenInTableText(this, token);\n                break;\n            case InsertionMode.IN_CAPTION:\n                startTagInCaption(this, token);\n                break;\n            case InsertionMode.IN_COLUMN_GROUP:\n                startTagInColumnGroup(this, token);\n                break;\n            case InsertionMode.IN_TABLE_BODY:\n                startTagInTableBody(this, token);\n                break;\n            case InsertionMode.IN_ROW:\n                startTagInRow(this, token);\n                break;\n            case InsertionMode.IN_CELL:\n                startTagInCell(this, token);\n                break;\n            case InsertionMode.IN_SELECT:\n                startTagInSelect(this, token);\n                break;\n            case InsertionMode.IN_SELECT_IN_TABLE:\n                startTagInSelectInTable(this, token);\n                break;\n            case InsertionMode.IN_TEMPLATE:\n                startTagInTemplate(this, token);\n                break;\n            case InsertionMode.AFTER_BODY:\n                startTagAfterBody(this, token);\n                break;\n            case InsertionMode.IN_FRAMESET:\n                startTagInFrameset(this, token);\n                break;\n            case InsertionMode.AFTER_FRAMESET:\n                startTagAfterFrameset(this, token);\n                break;\n            case InsertionMode.AFTER_AFTER_BODY:\n                startTagAfterAfterBody(this, token);\n                break;\n            case InsertionMode.AFTER_AFTER_FRAMESET:\n                startTagAfterAfterFrameset(this, token);\n                break;\n            default:\n            // Do nothing\n        }\n    }\n    onEndTag(token) {\n        this.skipNextNewLine = false;\n        this.currentToken = token;\n        if (this.currentNotInHTML) {\n            endTagInForeignContent(this, token);\n        }\n        else {\n            this._endTagOutsideForeignContent(token);\n        }\n    }\n    _endTagOutsideForeignContent(token) {\n        switch (this.insertionMode) {\n            case InsertionMode.INITIAL:\n                tokenInInitialMode(this, token);\n                break;\n            case InsertionMode.BEFORE_HTML:\n                endTagBeforeHtml(this, token);\n                break;\n            case InsertionMode.BEFORE_HEAD:\n                endTagBeforeHead(this, token);\n                break;\n            case InsertionMode.IN_HEAD:\n                endTagInHead(this, token);\n                break;\n            case InsertionMode.IN_HEAD_NO_SCRIPT:\n                endTagInHeadNoScript(this, token);\n                break;\n            case InsertionMode.AFTER_HEAD:\n                endTagAfterHead(this, token);\n                break;\n            case InsertionMode.IN_BODY:\n                endTagInBody(this, token);\n                break;\n            case InsertionMode.TEXT:\n                endTagInText(this, token);\n                break;\n            case InsertionMode.IN_TABLE:\n                endTagInTable(this, token);\n                break;\n            case InsertionMode.IN_TABLE_TEXT:\n                tokenInTableText(this, token);\n                break;\n            case InsertionMode.IN_CAPTION:\n                endTagInCaption(this, token);\n                break;\n            case InsertionMode.IN_COLUMN_GROUP:\n                endTagInColumnGroup(this, token);\n                break;\n            case InsertionMode.IN_TABLE_BODY:\n                endTagInTableBody(this, token);\n                break;\n            case InsertionMode.IN_ROW:\n                endTagInRow(this, token);\n                break;\n            case InsertionMode.IN_CELL:\n                endTagInCell(this, token);\n                break;\n            case InsertionMode.IN_SELECT:\n                endTagInSelect(this, token);\n                break;\n            case InsertionMode.IN_SELECT_IN_TABLE:\n                endTagInSelectInTable(this, token);\n                break;\n            case InsertionMode.IN_TEMPLATE:\n                endTagInTemplate(this, token);\n                break;\n            case InsertionMode.AFTER_BODY:\n                endTagAfterBody(this, token);\n                break;\n            case InsertionMode.IN_FRAMESET:\n                endTagInFrameset(this, token);\n                break;\n            case InsertionMode.AFTER_FRAMESET:\n                endTagAfterFrameset(this, token);\n                break;\n            case InsertionMode.AFTER_AFTER_BODY:\n                tokenAfterAfterBody(this, token);\n                break;\n            default:\n            // Do nothing\n        }\n    }\n    onEof(token) {\n        switch (this.insertionMode) {\n            case InsertionMode.INITIAL:\n                tokenInInitialMode(this, token);\n                break;\n            case InsertionMode.BEFORE_HTML:\n                tokenBeforeHtml(this, token);\n                break;\n            case InsertionMode.BEFORE_HEAD:\n                tokenBeforeHead(this, token);\n                break;\n            case InsertionMode.IN_HEAD:\n                tokenInHead(this, token);\n                break;\n            case InsertionMode.IN_HEAD_NO_SCRIPT:\n                tokenInHeadNoScript(this, token);\n                break;\n            case InsertionMode.AFTER_HEAD:\n                tokenAfterHead(this, token);\n                break;\n            case InsertionMode.IN_BODY:\n            case InsertionMode.IN_TABLE:\n            case InsertionMode.IN_CAPTION:\n            case InsertionMode.IN_COLUMN_GROUP:\n            case InsertionMode.IN_TABLE_BODY:\n            case InsertionMode.IN_ROW:\n            case InsertionMode.IN_CELL:\n            case InsertionMode.IN_SELECT:\n            case InsertionMode.IN_SELECT_IN_TABLE:\n                eofInBody(this, token);\n                break;\n            case InsertionMode.TEXT:\n                eofInText(this, token);\n                break;\n            case InsertionMode.IN_TABLE_TEXT:\n                tokenInTableText(this, token);\n                break;\n            case InsertionMode.IN_TEMPLATE:\n                eofInTemplate(this, token);\n                break;\n            case InsertionMode.AFTER_BODY:\n            case InsertionMode.IN_FRAMESET:\n            case InsertionMode.AFTER_FRAMESET:\n            case InsertionMode.AFTER_AFTER_BODY:\n            case InsertionMode.AFTER_AFTER_FRAMESET:\n                stopParsing(this, token);\n                break;\n            default:\n            // Do nothing\n        }\n    }\n    onWhitespaceCharacter(token) {\n        if (this.skipNextNewLine) {\n            this.skipNextNewLine = false;\n            if (token.chars.charCodeAt(0) === unicode.CODE_POINTS.LINE_FEED) {\n                if (token.chars.length === 1) {\n                    return;\n                }\n                token.chars = token.chars.substr(1);\n            }\n        }\n        if (this.tokenizer.inForeignNode) {\n            this._insertCharacters(token);\n            return;\n        }\n        switch (this.insertionMode) {\n            case InsertionMode.IN_HEAD:\n            case InsertionMode.IN_HEAD_NO_SCRIPT:\n            case InsertionMode.AFTER_HEAD:\n            case InsertionMode.TEXT:\n            case InsertionMode.IN_COLUMN_GROUP:\n            case InsertionMode.IN_SELECT:\n            case InsertionMode.IN_SELECT_IN_TABLE:\n            case InsertionMode.IN_FRAMESET:\n            case InsertionMode.AFTER_FRAMESET:\n                this._insertCharacters(token);\n                break;\n            case InsertionMode.IN_BODY:\n            case InsertionMode.IN_CAPTION:\n            case InsertionMode.IN_CELL:\n            case InsertionMode.IN_TEMPLATE:\n            case InsertionMode.AFTER_BODY:\n            case InsertionMode.AFTER_AFTER_BODY:\n            case InsertionMode.AFTER_AFTER_FRAMESET:\n                whitespaceCharacterInBody(this, token);\n                break;\n            case InsertionMode.IN_TABLE:\n            case InsertionMode.IN_TABLE_BODY:\n            case InsertionMode.IN_ROW:\n                characterInTable(this, token);\n                break;\n            case InsertionMode.IN_TABLE_TEXT:\n                whitespaceCharacterInTableText(this, token);\n                break;\n            default:\n            // Do nothing\n        }\n    }\n}\nexports.Parser = Parser;\n//Adoption agency algorithm\n//(see: http://www.whatwg.org/specs/web-apps/current-work/multipage/tree-construction.html#adoptionAgency)\n//------------------------------------------------------------------\n//Steps 5-8 of the algorithm\nfunction aaObtainFormattingElementEntry(p, token) {\n    let formattingElementEntry = p.activeFormattingElements.getElementEntryInScopeWithTagName(token.tagName);\n    if (formattingElementEntry) {\n        if (!p.openElements.contains(formattingElementEntry.element)) {\n            p.activeFormattingElements.removeEntry(formattingElementEntry);\n            formattingElementEntry = null;\n        }\n        else if (!p.openElements.hasInScope(token.tagID)) {\n            formattingElementEntry = null;\n        }\n    }\n    else {\n        genericEndTagInBody(p, token);\n    }\n    return formattingElementEntry;\n}\n//Steps 9 and 10 of the algorithm\nfunction aaObtainFurthestBlock(p, formattingElementEntry) {\n    let furthestBlock = null;\n    let idx = p.openElements.stackTop;\n    for (; idx >= 0; idx--) {\n        const element = p.openElements.items[idx];\n        if (element === formattingElementEntry.element) {\n            break;\n        }\n        if (p._isSpecialElement(element, p.openElements.tagIDs[idx])) {\n            furthestBlock = element;\n        }\n    }\n    if (!furthestBlock) {\n        p.openElements.shortenToLength(idx < 0 ? 0 : idx);\n        p.activeFormattingElements.removeEntry(formattingElementEntry);\n    }\n    return furthestBlock;\n}\n//Step 13 of the algorithm\nfunction aaInnerLoop(p, furthestBlock, formattingElement) {\n    let lastElement = furthestBlock;\n    let nextElement = p.openElements.getCommonAncestor(furthestBlock);\n    for (let i = 0, element = nextElement; element !== formattingElement; i++, element = nextElement) {\n        //NOTE: store the next element for the next loop iteration (it may be deleted from the stack by step 9.5)\n        nextElement = p.openElements.getCommonAncestor(element);\n        const elementEntry = p.activeFormattingElements.getElementEntry(element);\n        const counterOverflow = elementEntry && i >= AA_INNER_LOOP_ITER;\n        const shouldRemoveFromOpenElements = !elementEntry || counterOverflow;\n        if (shouldRemoveFromOpenElements) {\n            if (counterOverflow) {\n                p.activeFormattingElements.removeEntry(elementEntry);\n            }\n            p.openElements.remove(element);\n        }\n        else {\n            element = aaRecreateElementFromEntry(p, elementEntry);\n            if (lastElement === furthestBlock) {\n                p.activeFormattingElements.bookmark = elementEntry;\n            }\n            p.treeAdapter.detachNode(lastElement);\n            p.treeAdapter.appendChild(element, lastElement);\n            lastElement = element;\n        }\n    }\n    return lastElement;\n}\n//Step 13.7 of the algorithm\nfunction aaRecreateElementFromEntry(p, elementEntry) {\n    const ns = p.treeAdapter.getNamespaceURI(elementEntry.element);\n    const newElement = p.treeAdapter.createElement(elementEntry.token.tagName, ns, elementEntry.token.attrs);\n    p.openElements.replace(elementEntry.element, newElement);\n    elementEntry.element = newElement;\n    return newElement;\n}\n//Step 14 of the algorithm\nfunction aaInsertLastNodeInCommonAncestor(p, commonAncestor, lastElement) {\n    const tn = p.treeAdapter.getTagName(commonAncestor);\n    const tid = (0, html_js_1.getTagID)(tn);\n    if (p._isElementCausesFosterParenting(tid)) {\n        p._fosterParentElement(lastElement);\n    }\n    else {\n        const ns = p.treeAdapter.getNamespaceURI(commonAncestor);\n        if (tid === html_js_1.TAG_ID.TEMPLATE && ns === html_js_1.NS.HTML) {\n            commonAncestor = p.treeAdapter.getTemplateContent(commonAncestor);\n        }\n        p.treeAdapter.appendChild(commonAncestor, lastElement);\n    }\n}\n//Steps 15-19 of the algorithm\nfunction aaReplaceFormattingElement(p, furthestBlock, formattingElementEntry) {\n    const ns = p.treeAdapter.getNamespaceURI(formattingElementEntry.element);\n    const { token } = formattingElementEntry;\n    const newElement = p.treeAdapter.createElement(token.tagName, ns, token.attrs);\n    p._adoptNodes(furthestBlock, newElement);\n    p.treeAdapter.appendChild(furthestBlock, newElement);\n    p.activeFormattingElements.insertElementAfterBookmark(newElement, token);\n    p.activeFormattingElements.removeEntry(formattingElementEntry);\n    p.openElements.remove(formattingElementEntry.element);\n    p.openElements.insertAfter(furthestBlock, newElement, token.tagID);\n}\n//Algorithm entry point\nfunction callAdoptionAgency(p, token) {\n    for (let i = 0; i < AA_OUTER_LOOP_ITER; i++) {\n        const formattingElementEntry = aaObtainFormattingElementEntry(p, token);\n        if (!formattingElementEntry) {\n            break;\n        }\n        const furthestBlock = aaObtainFurthestBlock(p, formattingElementEntry);\n        if (!furthestBlock) {\n            break;\n        }\n        p.activeFormattingElements.bookmark = formattingElementEntry;\n        const lastElement = aaInnerLoop(p, furthestBlock, formattingElementEntry.element);\n        const commonAncestor = p.openElements.getCommonAncestor(formattingElementEntry.element);\n        p.treeAdapter.detachNode(lastElement);\n        if (commonAncestor)\n            aaInsertLastNodeInCommonAncestor(p, commonAncestor, lastElement);\n        aaReplaceFormattingElement(p, furthestBlock, formattingElementEntry);\n    }\n}\n//Generic token handlers\n//------------------------------------------------------------------\nfunction appendComment(p, token) {\n    p._appendCommentNode(token, p.openElements.currentTmplContentOrNode);\n}\nfunction appendCommentToRootHtmlElement(p, token) {\n    p._appendCommentNode(token, p.openElements.items[0]);\n}\nfunction appendCommentToDocument(p, token) {\n    p._appendCommentNode(token, p.document);\n}\nfunction stopParsing(p, token) {\n    p.stopped = true;\n    // NOTE: Set end locations for elements that remain on the open element stack.\n    if (token.location) {\n        // NOTE: If we are not in a fragment, `html` and `body` will stay on the stack.\n        // This is a problem, as we might overwrite their end position here.\n        const target = p.fragmentContext ? 0 : 2;\n        for (let i = p.openElements.stackTop; i >= target; i--) {\n            p._setEndLocation(p.openElements.items[i], token);\n        }\n        // Handle `html` and `body`\n        if (!p.fragmentContext && p.openElements.stackTop >= 0) {\n            const htmlElement = p.openElements.items[0];\n            const htmlLocation = p.treeAdapter.getNodeSourceCodeLocation(htmlElement);\n            if (htmlLocation && !htmlLocation.endTag) {\n                p._setEndLocation(htmlElement, token);\n                if (p.openElements.stackTop >= 1) {\n                    const bodyElement = p.openElements.items[1];\n                    const bodyLocation = p.treeAdapter.getNodeSourceCodeLocation(bodyElement);\n                    if (bodyLocation && !bodyLocation.endTag) {\n                        p._setEndLocation(bodyElement, token);\n                    }\n                }\n            }\n        }\n    }\n}\n// The \"initial\" insertion mode\n//------------------------------------------------------------------\nfunction doctypeInInitialMode(p, token) {\n    p._setDocumentType(token);\n    const mode = token.forceQuirks ? html_js_1.DOCUMENT_MODE.QUIRKS : doctype.getDocumentMode(token);\n    if (!doctype.isConforming(token)) {\n        p._err(token, error_codes_js_1.ERR.nonConformingDoctype);\n    }\n    p.treeAdapter.setDocumentMode(p.document, mode);\n    p.insertionMode = InsertionMode.BEFORE_HTML;\n}\nfunction tokenInInitialMode(p, token) {\n    p._err(token, error_codes_js_1.ERR.missingDoctype, true);\n    p.treeAdapter.setDocumentMode(p.document, html_js_1.DOCUMENT_MODE.QUIRKS);\n    p.insertionMode = InsertionMode.BEFORE_HTML;\n    p._processToken(token);\n}\n// The \"before html\" insertion mode\n//------------------------------------------------------------------\nfunction startTagBeforeHtml(p, token) {\n    if (token.tagID === html_js_1.TAG_ID.HTML) {\n        p._insertElement(token, html_js_1.NS.HTML);\n        p.insertionMode = InsertionMode.BEFORE_HEAD;\n    }\n    else {\n        tokenBeforeHtml(p, token);\n    }\n}\nfunction endTagBeforeHtml(p, token) {\n    const tn = token.tagID;\n    if (tn === html_js_1.TAG_ID.HTML || tn === html_js_1.TAG_ID.HEAD || tn === html_js_1.TAG_ID.BODY || tn === html_js_1.TAG_ID.BR) {\n        tokenBeforeHtml(p, token);\n    }\n}\nfunction tokenBeforeHtml(p, token) {\n    p._insertFakeRootElement();\n    p.insertionMode = InsertionMode.BEFORE_HEAD;\n    p._processToken(token);\n}\n// The \"before head\" insertion mode\n//------------------------------------------------------------------\nfunction startTagBeforeHead(p, token) {\n    switch (token.tagID) {\n        case html_js_1.TAG_ID.HTML: {\n            startTagInBody(p, token);\n            break;\n        }\n        case html_js_1.TAG_ID.HEAD: {\n            p._insertElement(token, html_js_1.NS.HTML);\n            p.headElement = p.openElements.current;\n            p.insertionMode = InsertionMode.IN_HEAD;\n            break;\n        }\n        default: {\n            tokenBeforeHead(p, token);\n        }\n    }\n}\nfunction endTagBeforeHead(p, token) {\n    const tn = token.tagID;\n    if (tn === html_js_1.TAG_ID.HEAD || tn === html_js_1.TAG_ID.BODY || tn === html_js_1.TAG_ID.HTML || tn === html_js_1.TAG_ID.BR) {\n        tokenBeforeHead(p, token);\n    }\n    else {\n        p._err(token, error_codes_js_1.ERR.endTagWithoutMatchingOpenElement);\n    }\n}\nfunction tokenBeforeHead(p, token) {\n    p._insertFakeElement(html_js_1.TAG_NAMES.HEAD, html_js_1.TAG_ID.HEAD);\n    p.headElement = p.openElements.current;\n    p.insertionMode = InsertionMode.IN_HEAD;\n    p._processToken(token);\n}\n// The \"in head\" insertion mode\n//------------------------------------------------------------------\nfunction startTagInHead(p, token) {\n    switch (token.tagID) {\n        case html_js_1.TAG_ID.HTML: {\n            startTagInBody(p, token);\n            break;\n        }\n        case html_js_1.TAG_ID.BASE:\n        case html_js_1.TAG_ID.BASEFONT:\n        case html_js_1.TAG_ID.BGSOUND:\n        case html_js_1.TAG_ID.LINK:\n        case html_js_1.TAG_ID.META: {\n            p._appendElement(token, html_js_1.NS.HTML);\n            token.ackSelfClosing = true;\n            break;\n        }\n        case html_js_1.TAG_ID.TITLE: {\n            p._switchToTextParsing(token, index_js_1.TokenizerMode.RCDATA);\n            break;\n        }\n        case html_js_1.TAG_ID.NOSCRIPT: {\n            if (p.options.scriptingEnabled) {\n                p._switchToTextParsing(token, index_js_1.TokenizerMode.RAWTEXT);\n            }\n            else {\n                p._insertElement(token, html_js_1.NS.HTML);\n                p.insertionMode = InsertionMode.IN_HEAD_NO_SCRIPT;\n            }\n            break;\n        }\n        case html_js_1.TAG_ID.NOFRAMES:\n        case html_js_1.TAG_ID.STYLE: {\n            p._switchToTextParsing(token, index_js_1.TokenizerMode.RAWTEXT);\n            break;\n        }\n        case html_js_1.TAG_ID.SCRIPT: {\n            p._switchToTextParsing(token, index_js_1.TokenizerMode.SCRIPT_DATA);\n            break;\n        }\n        case html_js_1.TAG_ID.TEMPLATE: {\n            p._insertTemplate(token);\n            p.activeFormattingElements.insertMarker();\n            p.framesetOk = false;\n            p.insertionMode = InsertionMode.IN_TEMPLATE;\n            p.tmplInsertionModeStack.unshift(InsertionMode.IN_TEMPLATE);\n            break;\n        }\n        case html_js_1.TAG_ID.HEAD: {\n            p._err(token, error_codes_js_1.ERR.misplacedStartTagForHeadElement);\n            break;\n        }\n        default: {\n            tokenInHead(p, token);\n        }\n    }\n}\nfunction endTagInHead(p, token) {\n    switch (token.tagID) {\n        case html_js_1.TAG_ID.HEAD: {\n            p.openElements.pop();\n            p.insertionMode = InsertionMode.AFTER_HEAD;\n            break;\n        }\n        case html_js_1.TAG_ID.BODY:\n        case html_js_1.TAG_ID.BR:\n        case html_js_1.TAG_ID.HTML: {\n            tokenInHead(p, token);\n            break;\n        }\n        case html_js_1.TAG_ID.TEMPLATE: {\n            templateEndTagInHead(p, token);\n            break;\n        }\n        default: {\n            p._err(token, error_codes_js_1.ERR.endTagWithoutMatchingOpenElement);\n        }\n    }\n}\nfunction templateEndTagInHead(p, token) {\n    if (p.openElements.tmplCount > 0) {\n        p.openElements.generateImpliedEndTagsThoroughly();\n        if (p.openElements.currentTagId !== html_js_1.TAG_ID.TEMPLATE) {\n            p._err(token, error_codes_js_1.ERR.closingOfElementWithOpenChildElements);\n        }\n        p.openElements.popUntilTagNamePopped(html_js_1.TAG_ID.TEMPLATE);\n        p.activeFormattingElements.clearToLastMarker();\n        p.tmplInsertionModeStack.shift();\n        p._resetInsertionMode();\n    }\n    else {\n        p._err(token, error_codes_js_1.ERR.endTagWithoutMatchingOpenElement);\n    }\n}\nfunction tokenInHead(p, token) {\n    p.openElements.pop();\n    p.insertionMode = InsertionMode.AFTER_HEAD;\n    p._processToken(token);\n}\n// The \"in head no script\" insertion mode\n//------------------------------------------------------------------\nfunction startTagInHeadNoScript(p, token) {\n    switch (token.tagID) {\n        case html_js_1.TAG_ID.HTML: {\n            startTagInBody(p, token);\n            break;\n        }\n        case html_js_1.TAG_ID.BASEFONT:\n        case html_js_1.TAG_ID.BGSOUND:\n        case html_js_1.TAG_ID.HEAD:\n        case html_js_1.TAG_ID.LINK:\n        case html_js_1.TAG_ID.META:\n        case html_js_1.TAG_ID.NOFRAMES:\n        case html_js_1.TAG_ID.STYLE: {\n            startTagInHead(p, token);\n            break;\n        }\n        case html_js_1.TAG_ID.NOSCRIPT: {\n            p._err(token, error_codes_js_1.ERR.nestedNoscriptInHead);\n            break;\n        }\n        default: {\n            tokenInHeadNoScript(p, token);\n        }\n    }\n}\nfunction endTagInHeadNoScript(p, token) {\n    switch (token.tagID) {\n        case html_js_1.TAG_ID.NOSCRIPT: {\n            p.openElements.pop();\n            p.insertionMode = InsertionMode.IN_HEAD;\n            break;\n        }\n        case html_js_1.TAG_ID.BR: {\n            tokenInHeadNoScript(p, token);\n            break;\n        }\n        default: {\n            p._err(token, error_codes_js_1.ERR.endTagWithoutMatchingOpenElement);\n        }\n    }\n}\nfunction tokenInHeadNoScript(p, token) {\n    const errCode = token.type === token_js_1.TokenType.EOF ? error_codes_js_1.ERR.openElementsLeftAfterEof : error_codes_js_1.ERR.disallowedContentInNoscriptInHead;\n    p._err(token, errCode);\n    p.openElements.pop();\n    p.insertionMode = InsertionMode.IN_HEAD;\n    p._processToken(token);\n}\n// The \"after head\" insertion mode\n//------------------------------------------------------------------\nfunction startTagAfterHead(p, token) {\n    switch (token.tagID) {\n        case html_js_1.TAG_ID.HTML: {\n            startTagInBody(p, token);\n            break;\n        }\n        case html_js_1.TAG_ID.BODY: {\n            p._insertElement(token, html_js_1.NS.HTML);\n            p.framesetOk = false;\n            p.insertionMode = InsertionMode.IN_BODY;\n            break;\n        }\n        case html_js_1.TAG_ID.FRAMESET: {\n            p._insertElement(token, html_js_1.NS.HTML);\n            p.insertionMode = InsertionMode.IN_FRAMESET;\n            break;\n        }\n        case html_js_1.TAG_ID.BASE:\n        case html_js_1.TAG_ID.BASEFONT:\n        case html_js_1.TAG_ID.BGSOUND:\n        case html_js_1.TAG_ID.LINK:\n        case html_js_1.TAG_ID.META:\n        case html_js_1.TAG_ID.NOFRAMES:\n        case html_js_1.TAG_ID.SCRIPT:\n        case html_js_1.TAG_ID.STYLE:\n        case html_js_1.TAG_ID.TEMPLATE:\n        case html_js_1.TAG_ID.TITLE: {\n            p._err(token, error_codes_js_1.ERR.abandonedHeadElementChild);\n            p.openElements.push(p.headElement, html_js_1.TAG_ID.HEAD);\n            startTagInHead(p, token);\n            p.openElements.remove(p.headElement);\n            break;\n        }\n        case html_js_1.TAG_ID.HEAD: {\n            p._err(token, error_codes_js_1.ERR.misplacedStartTagForHeadElement);\n            break;\n        }\n        default: {\n            tokenAfterHead(p, token);\n        }\n    }\n}\nfunction endTagAfterHead(p, token) {\n    switch (token.tagID) {\n        case html_js_1.TAG_ID.BODY:\n        case html_js_1.TAG_ID.HTML:\n        case html_js_1.TAG_ID.BR: {\n            tokenAfterHead(p, token);\n            break;\n        }\n        case html_js_1.TAG_ID.TEMPLATE: {\n            templateEndTagInHead(p, token);\n            break;\n        }\n        default: {\n            p._err(token, error_codes_js_1.ERR.endTagWithoutMatchingOpenElement);\n        }\n    }\n}\nfunction tokenAfterHead(p, token) {\n    p._insertFakeElement(html_js_1.TAG_NAMES.BODY, html_js_1.TAG_ID.BODY);\n    p.insertionMode = InsertionMode.IN_BODY;\n    modeInBody(p, token);\n}\n// The \"in body\" insertion mode\n//------------------------------------------------------------------\nfunction modeInBody(p, token) {\n    switch (token.type) {\n        case token_js_1.TokenType.CHARACTER: {\n            characterInBody(p, token);\n            break;\n        }\n        case token_js_1.TokenType.WHITESPACE_CHARACTER: {\n            whitespaceCharacterInBody(p, token);\n            break;\n        }\n        case token_js_1.TokenType.COMMENT: {\n            appendComment(p, token);\n            break;\n        }\n        case token_js_1.TokenType.START_TAG: {\n            startTagInBody(p, token);\n            break;\n        }\n        case token_js_1.TokenType.END_TAG: {\n            endTagInBody(p, token);\n            break;\n        }\n        case token_js_1.TokenType.EOF: {\n            eofInBody(p, token);\n            break;\n        }\n        default:\n        // Do nothing\n    }\n}\nfunction whitespaceCharacterInBody(p, token) {\n    p._reconstructActiveFormattingElements();\n    p._insertCharacters(token);\n}\nfunction characterInBody(p, token) {\n    p._reconstructActiveFormattingElements();\n    p._insertCharacters(token);\n    p.framesetOk = false;\n}\nfunction htmlStartTagInBody(p, token) {\n    if (p.openElements.tmplCount === 0) {\n        p.treeAdapter.adoptAttributes(p.openElements.items[0], token.attrs);\n    }\n}\nfunction bodyStartTagInBody(p, token) {\n    const bodyElement = p.openElements.tryPeekProperlyNestedBodyElement();\n    if (bodyElement && p.openElements.tmplCount === 0) {\n        p.framesetOk = false;\n        p.treeAdapter.adoptAttributes(bodyElement, token.attrs);\n    }\n}\nfunction framesetStartTagInBody(p, token) {\n    const bodyElement = p.openElements.tryPeekProperlyNestedBodyElement();\n    if (p.framesetOk && bodyElement) {\n        p.treeAdapter.detachNode(bodyElement);\n        p.openElements.popAllUpToHtmlElement();\n        p._insertElement(token, html_js_1.NS.HTML);\n        p.insertionMode = InsertionMode.IN_FRAMESET;\n    }\n}\nfunction addressStartTagInBody(p, token) {\n    if (p.openElements.hasInButtonScope(html_js_1.TAG_ID.P)) {\n        p._closePElement();\n    }\n    p._insertElement(token, html_js_1.NS.HTML);\n}\nfunction numberedHeaderStartTagInBody(p, token) {\n    if (p.openElements.hasInButtonScope(html_js_1.TAG_ID.P)) {\n        p._closePElement();\n    }\n    if ((0, html_js_1.isNumberedHeader)(p.openElements.currentTagId)) {\n        p.openElements.pop();\n    }\n    p._insertElement(token, html_js_1.NS.HTML);\n}\nfunction preStartTagInBody(p, token) {\n    if (p.openElements.hasInButtonScope(html_js_1.TAG_ID.P)) {\n        p._closePElement();\n    }\n    p._insertElement(token, html_js_1.NS.HTML);\n    //NOTE: If the next token is a U+000A LINE FEED (LF) character token, then ignore that token and move\n    //on to the next one. (Newlines at the start of pre blocks are ignored as an authoring convenience.)\n    p.skipNextNewLine = true;\n    p.framesetOk = false;\n}\nfunction formStartTagInBody(p, token) {\n    const inTemplate = p.openElements.tmplCount > 0;\n    if (!p.formElement || inTemplate) {\n        if (p.openElements.hasInButtonScope(html_js_1.TAG_ID.P)) {\n            p._closePElement();\n        }\n        p._insertElement(token, html_js_1.NS.HTML);\n        if (!inTemplate) {\n            p.formElement = p.openElements.current;\n        }\n    }\n}\nfunction listItemStartTagInBody(p, token) {\n    p.framesetOk = false;\n    const tn = token.tagID;\n    for (let i = p.openElements.stackTop; i >= 0; i--) {\n        const elementId = p.openElements.tagIDs[i];\n        if ((tn === html_js_1.TAG_ID.LI && elementId === html_js_1.TAG_ID.LI) ||\n            ((tn === html_js_1.TAG_ID.DD || tn === html_js_1.TAG_ID.DT) && (elementId === html_js_1.TAG_ID.DD || elementId === html_js_1.TAG_ID.DT))) {\n            p.openElements.generateImpliedEndTagsWithExclusion(elementId);\n            p.openElements.popUntilTagNamePopped(elementId);\n            break;\n        }\n        if (elementId !== html_js_1.TAG_ID.ADDRESS &&\n            elementId !== html_js_1.TAG_ID.DIV &&\n            elementId !== html_js_1.TAG_ID.P &&\n            p._isSpecialElement(p.openElements.items[i], elementId)) {\n            break;\n        }\n    }\n    if (p.openElements.hasInButtonScope(html_js_1.TAG_ID.P)) {\n        p._closePElement();\n    }\n    p._insertElement(token, html_js_1.NS.HTML);\n}\nfunction plaintextStartTagInBody(p, token) {\n    if (p.openElements.hasInButtonScope(html_js_1.TAG_ID.P)) {\n        p._closePElement();\n    }\n    p._insertElement(token, html_js_1.NS.HTML);\n    p.tokenizer.state = index_js_1.TokenizerMode.PLAINTEXT;\n}\nfunction buttonStartTagInBody(p, token) {\n    if (p.openElements.hasInScope(html_js_1.TAG_ID.BUTTON)) {\n        p.openElements.generateImpliedEndTags();\n        p.openElements.popUntilTagNamePopped(html_js_1.TAG_ID.BUTTON);\n    }\n    p._reconstructActiveFormattingElements();\n    p._insertElement(token, html_js_1.NS.HTML);\n    p.framesetOk = false;\n}\nfunction aStartTagInBody(p, token) {\n    const activeElementEntry = p.activeFormattingElements.getElementEntryInScopeWithTagName(html_js_1.TAG_NAMES.A);\n    if (activeElementEntry) {\n        callAdoptionAgency(p, token);\n        p.openElements.remove(activeElementEntry.element);\n        p.activeFormattingElements.removeEntry(activeElementEntry);\n    }\n    p._reconstructActiveFormattingElements();\n    p._insertElement(token, html_js_1.NS.HTML);\n    p.activeFormattingElements.pushElement(p.openElements.current, token);\n}\nfunction bStartTagInBody(p, token) {\n    p._reconstructActiveFormattingElements();\n    p._insertElement(token, html_js_1.NS.HTML);\n    p.activeFormattingElements.pushElement(p.openElements.current, token);\n}\nfunction nobrStartTagInBody(p, token) {\n    p._reconstructActiveFormattingElements();\n    if (p.openElements.hasInScope(html_js_1.TAG_ID.NOBR)) {\n        callAdoptionAgency(p, token);\n        p._reconstructActiveFormattingElements();\n    }\n    p._insertElement(token, html_js_1.NS.HTML);\n    p.activeFormattingElements.pushElement(p.openElements.current, token);\n}\nfunction appletStartTagInBody(p, token) {\n    p._reconstructActiveFormattingElements();\n    p._insertElement(token, html_js_1.NS.HTML);\n    p.activeFormattingElements.insertMarker();\n    p.framesetOk = false;\n}\nfunction tableStartTagInBody(p, token) {\n    if (p.treeAdapter.getDocumentMode(p.document) !== html_js_1.DOCUMENT_MODE.QUIRKS && p.openElements.hasInButtonScope(html_js_1.TAG_ID.P)) {\n        p._closePElement();\n    }\n    p._insertElement(token, html_js_1.NS.HTML);\n    p.framesetOk = false;\n    p.insertionMode = InsertionMode.IN_TABLE;\n}\nfunction areaStartTagInBody(p, token) {\n    p._reconstructActiveFormattingElements();\n    p._appendElement(token, html_js_1.NS.HTML);\n    p.framesetOk = false;\n    token.ackSelfClosing = true;\n}\nfunction isHiddenInput(token) {\n    const inputType = (0, token_js_1.getTokenAttr)(token, html_js_1.ATTRS.TYPE);\n    return inputType != null && inputType.toLowerCase() === HIDDEN_INPUT_TYPE;\n}\nfunction inputStartTagInBody(p, token) {\n    p._reconstructActiveFormattingElements();\n    p._appendElement(token, html_js_1.NS.HTML);\n    if (!isHiddenInput(token)) {\n        p.framesetOk = false;\n    }\n    token.ackSelfClosing = true;\n}\nfunction paramStartTagInBody(p, token) {\n    p._appendElement(token, html_js_1.NS.HTML);\n    token.ackSelfClosing = true;\n}\nfunction hrStartTagInBody(p, token) {\n    if (p.openElements.hasInButtonScope(html_js_1.TAG_ID.P)) {\n        p._closePElement();\n    }\n    p._appendElement(token, html_js_1.NS.HTML);\n    p.framesetOk = false;\n    token.ackSelfClosing = true;\n}\nfunction imageStartTagInBody(p, token) {\n    token.tagName = html_js_1.TAG_NAMES.IMG;\n    token.tagID = html_js_1.TAG_ID.IMG;\n    areaStartTagInBody(p, token);\n}\nfunction textareaStartTagInBody(p, token) {\n    p._insertElement(token, html_js_1.NS.HTML);\n    //NOTE: If the next token is a U+000A LINE FEED (LF) character token, then ignore that token and move\n    //on to the next one. (Newlines at the start of textarea elements are ignored as an authoring convenience.)\n    p.skipNextNewLine = true;\n    p.tokenizer.state = index_js_1.TokenizerMode.RCDATA;\n    p.originalInsertionMode = p.insertionMode;\n    p.framesetOk = false;\n    p.insertionMode = InsertionMode.TEXT;\n}\nfunction xmpStartTagInBody(p, token) {\n    if (p.openElements.hasInButtonScope(html_js_1.TAG_ID.P)) {\n        p._closePElement();\n    }\n    p._reconstructActiveFormattingElements();\n    p.framesetOk = false;\n    p._switchToTextParsing(token, index_js_1.TokenizerMode.RAWTEXT);\n}\nfunction iframeStartTagInBody(p, token) {\n    p.framesetOk = false;\n    p._switchToTextParsing(token, index_js_1.TokenizerMode.RAWTEXT);\n}\n//NOTE: here we assume that we always act as an user agent with enabled plugins, so we parse\n//<noembed> as rawtext.\nfunction noembedStartTagInBody(p, token) {\n    p._switchToTextParsing(token, index_js_1.TokenizerMode.RAWTEXT);\n}\nfunction selectStartTagInBody(p, token) {\n    p._reconstructActiveFormattingElements();\n    p._insertElement(token, html_js_1.NS.HTML);\n    p.framesetOk = false;\n    p.insertionMode =\n        p.insertionMode === InsertionMode.IN_TABLE ||\n            p.insertionMode === InsertionMode.IN_CAPTION ||\n            p.insertionMode === InsertionMode.IN_TABLE_BODY ||\n            p.insertionMode === InsertionMode.IN_ROW ||\n            p.insertionMode === InsertionMode.IN_CELL\n            ? InsertionMode.IN_SELECT_IN_TABLE\n            : InsertionMode.IN_SELECT;\n}\nfunction optgroupStartTagInBody(p, token) {\n    if (p.openElements.currentTagId === html_js_1.TAG_ID.OPTION) {\n        p.openElements.pop();\n    }\n    p._reconstructActiveFormattingElements();\n    p._insertElement(token, html_js_1.NS.HTML);\n}\nfunction rbStartTagInBody(p, token) {\n    if (p.openElements.hasInScope(html_js_1.TAG_ID.RUBY)) {\n        p.openElements.generateImpliedEndTags();\n    }\n    p._insertElement(token, html_js_1.NS.HTML);\n}\nfunction rtStartTagInBody(p, token) {\n    if (p.openElements.hasInScope(html_js_1.TAG_ID.RUBY)) {\n        p.openElements.generateImpliedEndTagsWithExclusion(html_js_1.TAG_ID.RTC);\n    }\n    p._insertElement(token, html_js_1.NS.HTML);\n}\nfunction mathStartTagInBody(p, token) {\n    p._reconstructActiveFormattingElements();\n    foreignContent.adjustTokenMathMLAttrs(token);\n    foreignContent.adjustTokenXMLAttrs(token);\n    if (token.selfClosing) {\n        p._appendElement(token, html_js_1.NS.MATHML);\n    }\n    else {\n        p._insertElement(token, html_js_1.NS.MATHML);\n    }\n    token.ackSelfClosing = true;\n}\nfunction svgStartTagInBody(p, token) {\n    p._reconstructActiveFormattingElements();\n    foreignContent.adjustTokenSVGAttrs(token);\n    foreignContent.adjustTokenXMLAttrs(token);\n    if (token.selfClosing) {\n        p._appendElement(token, html_js_1.NS.SVG);\n    }\n    else {\n        p._insertElement(token, html_js_1.NS.SVG);\n    }\n    token.ackSelfClosing = true;\n}\nfunction genericStartTagInBody(p, token) {\n    p._reconstructActiveFormattingElements();\n    p._insertElement(token, html_js_1.NS.HTML);\n}\nfunction startTagInBody(p, token) {\n    switch (token.tagID) {\n        case html_js_1.TAG_ID.I:\n        case html_js_1.TAG_ID.S:\n        case html_js_1.TAG_ID.B:\n        case html_js_1.TAG_ID.U:\n        case html_js_1.TAG_ID.EM:\n        case html_js_1.TAG_ID.TT:\n        case html_js_1.TAG_ID.BIG:\n        case html_js_1.TAG_ID.CODE:\n        case html_js_1.TAG_ID.FONT:\n        case html_js_1.TAG_ID.SMALL:\n        case html_js_1.TAG_ID.STRIKE:\n        case html_js_1.TAG_ID.STRONG: {\n            bStartTagInBody(p, token);\n            break;\n        }\n        case html_js_1.TAG_ID.A: {\n            aStartTagInBody(p, token);\n            break;\n        }\n        case html_js_1.TAG_ID.H1:\n        case html_js_1.TAG_ID.H2:\n        case html_js_1.TAG_ID.H3:\n        case html_js_1.TAG_ID.H4:\n        case html_js_1.TAG_ID.H5:\n        case html_js_1.TAG_ID.H6: {\n            numberedHeaderStartTagInBody(p, token);\n            break;\n        }\n        case html_js_1.TAG_ID.P:\n        case html_js_1.TAG_ID.DL:\n        case html_js_1.TAG_ID.OL:\n        case html_js_1.TAG_ID.UL:\n        case html_js_1.TAG_ID.DIV:\n        case html_js_1.TAG_ID.DIR:\n        case html_js_1.TAG_ID.NAV:\n        case html_js_1.TAG_ID.MAIN:\n        case html_js_1.TAG_ID.MENU:\n        case html_js_1.TAG_ID.ASIDE:\n        case html_js_1.TAG_ID.CENTER:\n        case html_js_1.TAG_ID.FIGURE:\n        case html_js_1.TAG_ID.FOOTER:\n        case html_js_1.TAG_ID.HEADER:\n        case html_js_1.TAG_ID.HGROUP:\n        case html_js_1.TAG_ID.DIALOG:\n        case html_js_1.TAG_ID.DETAILS:\n        case html_js_1.TAG_ID.ADDRESS:\n        case html_js_1.TAG_ID.ARTICLE:\n        case html_js_1.TAG_ID.SECTION:\n        case html_js_1.TAG_ID.SUMMARY:\n        case html_js_1.TAG_ID.FIELDSET:\n        case html_js_1.TAG_ID.BLOCKQUOTE:\n        case html_js_1.TAG_ID.FIGCAPTION: {\n            addressStartTagInBody(p, token);\n            break;\n        }\n        case html_js_1.TAG_ID.LI:\n        case html_js_1.TAG_ID.DD:\n        case html_js_1.TAG_ID.DT: {\n            listItemStartTagInBody(p, token);\n            break;\n        }\n        case html_js_1.TAG_ID.BR:\n        case html_js_1.TAG_ID.IMG:\n        case html_js_1.TAG_ID.WBR:\n        case html_js_1.TAG_ID.AREA:\n        case html_js_1.TAG_ID.EMBED:\n        case html_js_1.TAG_ID.KEYGEN: {\n            areaStartTagInBody(p, token);\n            break;\n        }\n        case html_js_1.TAG_ID.HR: {\n            hrStartTagInBody(p, token);\n            break;\n        }\n        case html_js_1.TAG_ID.RB:\n        case html_js_1.TAG_ID.RTC: {\n            rbStartTagInBody(p, token);\n            break;\n        }\n        case html_js_1.TAG_ID.RT:\n        case html_js_1.TAG_ID.RP: {\n            rtStartTagInBody(p, token);\n            break;\n        }\n        case html_js_1.TAG_ID.PRE:\n        case html_js_1.TAG_ID.LISTING: {\n            preStartTagInBody(p, token);\n            break;\n        }\n        case html_js_1.TAG_ID.XMP: {\n            xmpStartTagInBody(p, token);\n            break;\n        }\n        case html_js_1.TAG_ID.SVG: {\n            svgStartTagInBody(p, token);\n            break;\n        }\n        case html_js_1.TAG_ID.HTML: {\n            htmlStartTagInBody(p, token);\n            break;\n        }\n        case html_js_1.TAG_ID.BASE:\n        case html_js_1.TAG_ID.LINK:\n        case html_js_1.TAG_ID.META:\n        case html_js_1.TAG_ID.STYLE:\n        case html_js_1.TAG_ID.TITLE:\n        case html_js_1.TAG_ID.SCRIPT:\n        case html_js_1.TAG_ID.BGSOUND:\n        case html_js_1.TAG_ID.BASEFONT:\n        case html_js_1.TAG_ID.TEMPLATE: {\n            startTagInHead(p, token);\n            break;\n        }\n        case html_js_1.TAG_ID.BODY: {\n            bodyStartTagInBody(p, token);\n            break;\n        }\n        case html_js_1.TAG_ID.FORM: {\n            formStartTagInBody(p, token);\n            break;\n        }\n        case html_js_1.TAG_ID.NOBR: {\n            nobrStartTagInBody(p, token);\n            break;\n        }\n        case html_js_1.TAG_ID.MATH: {\n            mathStartTagInBody(p, token);\n            break;\n        }\n        case html_js_1.TAG_ID.TABLE: {\n            tableStartTagInBody(p, token);\n            break;\n        }\n        case html_js_1.TAG_ID.INPUT: {\n            inputStartTagInBody(p, token);\n            break;\n        }\n        case html_js_1.TAG_ID.PARAM:\n        case html_js_1.TAG_ID.TRACK:\n        case html_js_1.TAG_ID.SOURCE: {\n            paramStartTagInBody(p, token);\n            break;\n        }\n        case html_js_1.TAG_ID.IMAGE: {\n            imageStartTagInBody(p, token);\n            break;\n        }\n        case html_js_1.TAG_ID.BUTTON: {\n            buttonStartTagInBody(p, token);\n            break;\n        }\n        case html_js_1.TAG_ID.APPLET:\n        case html_js_1.TAG_ID.OBJECT:\n        case html_js_1.TAG_ID.MARQUEE: {\n            appletStartTagInBody(p, token);\n            break;\n        }\n        case html_js_1.TAG_ID.IFRAME: {\n            iframeStartTagInBody(p, token);\n            break;\n        }\n        case html_js_1.TAG_ID.SELECT: {\n            selectStartTagInBody(p, token);\n            break;\n        }\n        case html_js_1.TAG_ID.OPTION:\n        case html_js_1.TAG_ID.OPTGROUP: {\n            optgroupStartTagInBody(p, token);\n            break;\n        }\n        case html_js_1.TAG_ID.NOEMBED: {\n            noembedStartTagInBody(p, token);\n            break;\n        }\n        case html_js_1.TAG_ID.FRAMESET: {\n            framesetStartTagInBody(p, token);\n            break;\n        }\n        case html_js_1.TAG_ID.TEXTAREA: {\n            textareaStartTagInBody(p, token);\n            break;\n        }\n        case html_js_1.TAG_ID.NOSCRIPT: {\n            if (p.options.scriptingEnabled) {\n                noembedStartTagInBody(p, token);\n            }\n            else {\n                genericStartTagInBody(p, token);\n            }\n            break;\n        }\n        case html_js_1.TAG_ID.PLAINTEXT: {\n            plaintextStartTagInBody(p, token);\n            break;\n        }\n        case html_js_1.TAG_ID.COL:\n        case html_js_1.TAG_ID.TH:\n        case html_js_1.TAG_ID.TD:\n        case html_js_1.TAG_ID.TR:\n        case html_js_1.TAG_ID.HEAD:\n        case html_js_1.TAG_ID.FRAME:\n        case html_js_1.TAG_ID.TBODY:\n        case html_js_1.TAG_ID.TFOOT:\n        case html_js_1.TAG_ID.THEAD:\n        case html_js_1.TAG_ID.CAPTION:\n        case html_js_1.TAG_ID.COLGROUP: {\n            // Ignore token\n            break;\n        }\n        default: {\n            genericStartTagInBody(p, token);\n        }\n    }\n}\nfunction bodyEndTagInBody(p, token) {\n    if (p.openElements.hasInScope(html_js_1.TAG_ID.BODY)) {\n        p.insertionMode = InsertionMode.AFTER_BODY;\n        //NOTE: <body> is never popped from the stack, so we need to updated\n        //the end location explicitly.\n        if (p.options.sourceCodeLocationInfo) {\n            const bodyElement = p.openElements.tryPeekProperlyNestedBodyElement();\n            if (bodyElement) {\n                p._setEndLocation(bodyElement, token);\n            }\n        }\n    }\n}\nfunction htmlEndTagInBody(p, token) {\n    if (p.openElements.hasInScope(html_js_1.TAG_ID.BODY)) {\n        p.insertionMode = InsertionMode.AFTER_BODY;\n        endTagAfterBody(p, token);\n    }\n}\nfunction addressEndTagInBody(p, token) {\n    const tn = token.tagID;\n    if (p.openElements.hasInScope(tn)) {\n        p.openElements.generateImpliedEndTags();\n        p.openElements.popUntilTagNamePopped(tn);\n    }\n}\nfunction formEndTagInBody(p) {\n    const inTemplate = p.openElements.tmplCount > 0;\n    const { formElement } = p;\n    if (!inTemplate) {\n        p.formElement = null;\n    }\n    if ((formElement || inTemplate) && p.openElements.hasInScope(html_js_1.TAG_ID.FORM)) {\n        p.openElements.generateImpliedEndTags();\n        if (inTemplate) {\n            p.openElements.popUntilTagNamePopped(html_js_1.TAG_ID.FORM);\n        }\n        else if (formElement) {\n            p.openElements.remove(formElement);\n        }\n    }\n}\nfunction pEndTagInBody(p) {\n    if (!p.openElements.hasInButtonScope(html_js_1.TAG_ID.P)) {\n        p._insertFakeElement(html_js_1.TAG_NAMES.P, html_js_1.TAG_ID.P);\n    }\n    p._closePElement();\n}\nfunction liEndTagInBody(p) {\n    if (p.openElements.hasInListItemScope(html_js_1.TAG_ID.LI)) {\n        p.openElements.generateImpliedEndTagsWithExclusion(html_js_1.TAG_ID.LI);\n        p.openElements.popUntilTagNamePopped(html_js_1.TAG_ID.LI);\n    }\n}\nfunction ddEndTagInBody(p, token) {\n    const tn = token.tagID;\n    if (p.openElements.hasInScope(tn)) {\n        p.openElements.generateImpliedEndTagsWithExclusion(tn);\n        p.openElements.popUntilTagNamePopped(tn);\n    }\n}\nfunction numberedHeaderEndTagInBody(p) {\n    if (p.openElements.hasNumberedHeaderInScope()) {\n        p.openElements.generateImpliedEndTags();\n        p.openElements.popUntilNumberedHeaderPopped();\n    }\n}\nfunction appletEndTagInBody(p, token) {\n    const tn = token.tagID;\n    if (p.openElements.hasInScope(tn)) {\n        p.openElements.generateImpliedEndTags();\n        p.openElements.popUntilTagNamePopped(tn);\n        p.activeFormattingElements.clearToLastMarker();\n    }\n}\nfunction brEndTagInBody(p) {\n    p._reconstructActiveFormattingElements();\n    p._insertFakeElement(html_js_1.TAG_NAMES.BR, html_js_1.TAG_ID.BR);\n    p.openElements.pop();\n    p.framesetOk = false;\n}\nfunction genericEndTagInBody(p, token) {\n    const tn = token.tagName;\n    const tid = token.tagID;\n    for (let i = p.openElements.stackTop; i > 0; i--) {\n        const element = p.openElements.items[i];\n        const elementId = p.openElements.tagIDs[i];\n        // Compare the tag name here, as the tag might not be a known tag with an ID.\n        if (tid === elementId && (tid !== html_js_1.TAG_ID.UNKNOWN || p.treeAdapter.getTagName(element) === tn)) {\n            p.openElements.generateImpliedEndTagsWithExclusion(tid);\n            if (p.openElements.stackTop >= i)\n                p.openElements.shortenToLength(i);\n            break;\n        }\n        if (p._isSpecialElement(element, elementId)) {\n            break;\n        }\n    }\n}\nfunction endTagInBody(p, token) {\n    switch (token.tagID) {\n        case html_js_1.TAG_ID.A:\n        case html_js_1.TAG_ID.B:\n        case html_js_1.TAG_ID.I:\n        case html_js_1.TAG_ID.S:\n        case html_js_1.TAG_ID.U:\n        case html_js_1.TAG_ID.EM:\n        case html_js_1.TAG_ID.TT:\n        case html_js_1.TAG_ID.BIG:\n        case html_js_1.TAG_ID.CODE:\n        case html_js_1.TAG_ID.FONT:\n        case html_js_1.TAG_ID.NOBR:\n        case html_js_1.TAG_ID.SMALL:\n        case html_js_1.TAG_ID.STRIKE:\n        case html_js_1.TAG_ID.STRONG: {\n            callAdoptionAgency(p, token);\n            break;\n        }\n        case html_js_1.TAG_ID.P: {\n            pEndTagInBody(p);\n            break;\n        }\n        case html_js_1.TAG_ID.DL:\n        case html_js_1.TAG_ID.UL:\n        case html_js_1.TAG_ID.OL:\n        case html_js_1.TAG_ID.DIR:\n        case html_js_1.TAG_ID.DIV:\n        case html_js_1.TAG_ID.NAV:\n        case html_js_1.TAG_ID.PRE:\n        case html_js_1.TAG_ID.MAIN:\n        case html_js_1.TAG_ID.MENU:\n        case html_js_1.TAG_ID.ASIDE:\n        case html_js_1.TAG_ID.BUTTON:\n        case html_js_1.TAG_ID.CENTER:\n        case html_js_1.TAG_ID.FIGURE:\n        case html_js_1.TAG_ID.FOOTER:\n        case html_js_1.TAG_ID.HEADER:\n        case html_js_1.TAG_ID.HGROUP:\n        case html_js_1.TAG_ID.DIALOG:\n        case html_js_1.TAG_ID.ADDRESS:\n        case html_js_1.TAG_ID.ARTICLE:\n        case html_js_1.TAG_ID.DETAILS:\n        case html_js_1.TAG_ID.SECTION:\n        case html_js_1.TAG_ID.SUMMARY:\n        case html_js_1.TAG_ID.LISTING:\n        case html_js_1.TAG_ID.FIELDSET:\n        case html_js_1.TAG_ID.BLOCKQUOTE:\n        case html_js_1.TAG_ID.FIGCAPTION: {\n            addressEndTagInBody(p, token);\n            break;\n        }\n        case html_js_1.TAG_ID.LI: {\n            liEndTagInBody(p);\n            break;\n        }\n        case html_js_1.TAG_ID.DD:\n        case html_js_1.TAG_ID.DT: {\n            ddEndTagInBody(p, token);\n            break;\n        }\n        case html_js_1.TAG_ID.H1:\n        case html_js_1.TAG_ID.H2:\n        case html_js_1.TAG_ID.H3:\n        case html_js_1.TAG_ID.H4:\n        case html_js_1.TAG_ID.H5:\n        case html_js_1.TAG_ID.H6: {\n            numberedHeaderEndTagInBody(p);\n            break;\n        }\n        case html_js_1.TAG_ID.BR: {\n            brEndTagInBody(p);\n            break;\n        }\n        case html_js_1.TAG_ID.BODY: {\n            bodyEndTagInBody(p, token);\n            break;\n        }\n        case html_js_1.TAG_ID.HTML: {\n            htmlEndTagInBody(p, token);\n            break;\n        }\n        case html_js_1.TAG_ID.FORM: {\n            formEndTagInBody(p);\n            break;\n        }\n        case html_js_1.TAG_ID.APPLET:\n        case html_js_1.TAG_ID.OBJECT:\n        case html_js_1.TAG_ID.MARQUEE: {\n            appletEndTagInBody(p, token);\n            break;\n        }\n        case html_js_1.TAG_ID.TEMPLATE: {\n            templateEndTagInHead(p, token);\n            break;\n        }\n        default: {\n            genericEndTagInBody(p, token);\n        }\n    }\n}\nfunction eofInBody(p, token) {\n    if (p.tmplInsertionModeStack.length > 0) {\n        eofInTemplate(p, token);\n    }\n    else {\n        stopParsing(p, token);\n    }\n}\n// The \"text\" insertion mode\n//------------------------------------------------------------------\nfunction endTagInText(p, token) {\n    var _a;\n    if (token.tagID === html_js_1.TAG_ID.SCRIPT) {\n        (_a = p.scriptHandler) === null || _a === void 0 ? void 0 : _a.call(p, p.openElements.current);\n    }\n    p.openElements.pop();\n    p.insertionMode = p.originalInsertionMode;\n}\nfunction eofInText(p, token) {\n    p._err(token, error_codes_js_1.ERR.eofInElementThatCanContainOnlyText);\n    p.openElements.pop();\n    p.insertionMode = p.originalInsertionMode;\n    p.onEof(token);\n}\n// The \"in table\" insertion mode\n//------------------------------------------------------------------\nfunction characterInTable(p, token) {\n    if (TABLE_STRUCTURE_TAGS.has(p.openElements.currentTagId)) {\n        p.pendingCharacterTokens.length = 0;\n        p.hasNonWhitespacePendingCharacterToken = false;\n        p.originalInsertionMode = p.insertionMode;\n        p.insertionMode = InsertionMode.IN_TABLE_TEXT;\n        switch (token.type) {\n            case token_js_1.TokenType.CHARACTER: {\n                characterInTableText(p, token);\n                break;\n            }\n            case token_js_1.TokenType.WHITESPACE_CHARACTER: {\n                whitespaceCharacterInTableText(p, token);\n                break;\n            }\n            // Ignore null\n        }\n    }\n    else {\n        tokenInTable(p, token);\n    }\n}\nfunction captionStartTagInTable(p, token) {\n    p.openElements.clearBackToTableContext();\n    p.activeFormattingElements.insertMarker();\n    p._insertElement(token, html_js_1.NS.HTML);\n    p.insertionMode = InsertionMode.IN_CAPTION;\n}\nfunction colgroupStartTagInTable(p, token) {\n    p.openElements.clearBackToTableContext();\n    p._insertElement(token, html_js_1.NS.HTML);\n    p.insertionMode = InsertionMode.IN_COLUMN_GROUP;\n}\nfunction colStartTagInTable(p, token) {\n    p.openElements.clearBackToTableContext();\n    p._insertFakeElement(html_js_1.TAG_NAMES.COLGROUP, html_js_1.TAG_ID.COLGROUP);\n    p.insertionMode = InsertionMode.IN_COLUMN_GROUP;\n    startTagInColumnGroup(p, token);\n}\nfunction tbodyStartTagInTable(p, token) {\n    p.openElements.clearBackToTableContext();\n    p._insertElement(token, html_js_1.NS.HTML);\n    p.insertionMode = InsertionMode.IN_TABLE_BODY;\n}\nfunction tdStartTagInTable(p, token) {\n    p.openElements.clearBackToTableContext();\n    p._insertFakeElement(html_js_1.TAG_NAMES.TBODY, html_js_1.TAG_ID.TBODY);\n    p.insertionMode = InsertionMode.IN_TABLE_BODY;\n    startTagInTableBody(p, token);\n}\nfunction tableStartTagInTable(p, token) {\n    if (p.openElements.hasInTableScope(html_js_1.TAG_ID.TABLE)) {\n        p.openElements.popUntilTagNamePopped(html_js_1.TAG_ID.TABLE);\n        p._resetInsertionMode();\n        p._processStartTag(token);\n    }\n}\nfunction inputStartTagInTable(p, token) {\n    if (isHiddenInput(token)) {\n        p._appendElement(token, html_js_1.NS.HTML);\n    }\n    else {\n        tokenInTable(p, token);\n    }\n    token.ackSelfClosing = true;\n}\nfunction formStartTagInTable(p, token) {\n    if (!p.formElement && p.openElements.tmplCount === 0) {\n        p._insertElement(token, html_js_1.NS.HTML);\n        p.formElement = p.openElements.current;\n        p.openElements.pop();\n    }\n}\nfunction startTagInTable(p, token) {\n    switch (token.tagID) {\n        case html_js_1.TAG_ID.TD:\n        case html_js_1.TAG_ID.TH:\n        case html_js_1.TAG_ID.TR: {\n            tdStartTagInTable(p, token);\n            break;\n        }\n        case html_js_1.TAG_ID.STYLE:\n        case html_js_1.TAG_ID.SCRIPT:\n        case html_js_1.TAG_ID.TEMPLATE: {\n            startTagInHead(p, token);\n            break;\n        }\n        case html_js_1.TAG_ID.COL: {\n            colStartTagInTable(p, token);\n            break;\n        }\n        case html_js_1.TAG_ID.FORM: {\n            formStartTagInTable(p, token);\n            break;\n        }\n        case html_js_1.TAG_ID.TABLE: {\n            tableStartTagInTable(p, token);\n            break;\n        }\n        case html_js_1.TAG_ID.TBODY:\n        case html_js_1.TAG_ID.TFOOT:\n        case html_js_1.TAG_ID.THEAD: {\n            tbodyStartTagInTable(p, token);\n            break;\n        }\n        case html_js_1.TAG_ID.INPUT: {\n            inputStartTagInTable(p, token);\n            break;\n        }\n        case html_js_1.TAG_ID.CAPTION: {\n            captionStartTagInTable(p, token);\n            break;\n        }\n        case html_js_1.TAG_ID.COLGROUP: {\n            colgroupStartTagInTable(p, token);\n            break;\n        }\n        default: {\n            tokenInTable(p, token);\n        }\n    }\n}\nfunction endTagInTable(p, token) {\n    switch (token.tagID) {\n        case html_js_1.TAG_ID.TABLE: {\n            if (p.openElements.hasInTableScope(html_js_1.TAG_ID.TABLE)) {\n                p.openElements.popUntilTagNamePopped(html_js_1.TAG_ID.TABLE);\n                p._resetInsertionMode();\n            }\n            break;\n        }\n        case html_js_1.TAG_ID.TEMPLATE: {\n            templateEndTagInHead(p, token);\n            break;\n        }\n        case html_js_1.TAG_ID.BODY:\n        case html_js_1.TAG_ID.CAPTION:\n        case html_js_1.TAG_ID.COL:\n        case html_js_1.TAG_ID.COLGROUP:\n        case html_js_1.TAG_ID.HTML:\n        case html_js_1.TAG_ID.TBODY:\n        case html_js_1.TAG_ID.TD:\n        case html_js_1.TAG_ID.TFOOT:\n        case html_js_1.TAG_ID.TH:\n        case html_js_1.TAG_ID.THEAD:\n        case html_js_1.TAG_ID.TR: {\n            // Ignore token\n            break;\n        }\n        default: {\n            tokenInTable(p, token);\n        }\n    }\n}\nfunction tokenInTable(p, token) {\n    const savedFosterParentingState = p.fosterParentingEnabled;\n    p.fosterParentingEnabled = true;\n    // Process token in `In Body` mode\n    modeInBody(p, token);\n    p.fosterParentingEnabled = savedFosterParentingState;\n}\n// The \"in table text\" insertion mode\n//------------------------------------------------------------------\nfunction whitespaceCharacterInTableText(p, token) {\n    p.pendingCharacterTokens.push(token);\n}\nfunction characterInTableText(p, token) {\n    p.pendingCharacterTokens.push(token);\n    p.hasNonWhitespacePendingCharacterToken = true;\n}\nfunction tokenInTableText(p, token) {\n    let i = 0;\n    if (p.hasNonWhitespacePendingCharacterToken) {\n        for (; i < p.pendingCharacterTokens.length; i++) {\n            tokenInTable(p, p.pendingCharacterTokens[i]);\n        }\n    }\n    else {\n        for (; i < p.pendingCharacterTokens.length; i++) {\n            p._insertCharacters(p.pendingCharacterTokens[i]);\n        }\n    }\n    p.insertionMode = p.originalInsertionMode;\n    p._processToken(token);\n}\n// The \"in caption\" insertion mode\n//------------------------------------------------------------------\nconst TABLE_VOID_ELEMENTS = new Set([html_js_1.TAG_ID.CAPTION, html_js_1.TAG_ID.COL, html_js_1.TAG_ID.COLGROUP, html_js_1.TAG_ID.TBODY, html_js_1.TAG_ID.TD, html_js_1.TAG_ID.TFOOT, html_js_1.TAG_ID.TH, html_js_1.TAG_ID.THEAD, html_js_1.TAG_ID.TR]);\nfunction startTagInCaption(p, token) {\n    const tn = token.tagID;\n    if (TABLE_VOID_ELEMENTS.has(tn)) {\n        if (p.openElements.hasInTableScope(html_js_1.TAG_ID.CAPTION)) {\n            p.openElements.generateImpliedEndTags();\n            p.openElements.popUntilTagNamePopped(html_js_1.TAG_ID.CAPTION);\n            p.activeFormattingElements.clearToLastMarker();\n            p.insertionMode = InsertionMode.IN_TABLE;\n            startTagInTable(p, token);\n        }\n    }\n    else {\n        startTagInBody(p, token);\n    }\n}\nfunction endTagInCaption(p, token) {\n    const tn = token.tagID;\n    switch (tn) {\n        case html_js_1.TAG_ID.CAPTION:\n        case html_js_1.TAG_ID.TABLE: {\n            if (p.openElements.hasInTableScope(html_js_1.TAG_ID.CAPTION)) {\n                p.openElements.generateImpliedEndTags();\n                p.openElements.popUntilTagNamePopped(html_js_1.TAG_ID.CAPTION);\n                p.activeFormattingElements.clearToLastMarker();\n                p.insertionMode = InsertionMode.IN_TABLE;\n                if (tn === html_js_1.TAG_ID.TABLE) {\n                    endTagInTable(p, token);\n                }\n            }\n            break;\n        }\n        case html_js_1.TAG_ID.BODY:\n        case html_js_1.TAG_ID.COL:\n        case html_js_1.TAG_ID.COLGROUP:\n        case html_js_1.TAG_ID.HTML:\n        case html_js_1.TAG_ID.TBODY:\n        case html_js_1.TAG_ID.TD:\n        case html_js_1.TAG_ID.TFOOT:\n        case html_js_1.TAG_ID.TH:\n        case html_js_1.TAG_ID.THEAD:\n        case html_js_1.TAG_ID.TR: {\n            // Ignore token\n            break;\n        }\n        default: {\n            endTagInBody(p, token);\n        }\n    }\n}\n// The \"in column group\" insertion mode\n//------------------------------------------------------------------\nfunction startTagInColumnGroup(p, token) {\n    switch (token.tagID) {\n        case html_js_1.TAG_ID.HTML: {\n            startTagInBody(p, token);\n            break;\n        }\n        case html_js_1.TAG_ID.COL: {\n            p._appendElement(token, html_js_1.NS.HTML);\n            token.ackSelfClosing = true;\n            break;\n        }\n        case html_js_1.TAG_ID.TEMPLATE: {\n            startTagInHead(p, token);\n            break;\n        }\n        default: {\n            tokenInColumnGroup(p, token);\n        }\n    }\n}\nfunction endTagInColumnGroup(p, token) {\n    switch (token.tagID) {\n        case html_js_1.TAG_ID.COLGROUP: {\n            if (p.openElements.currentTagId === html_js_1.TAG_ID.COLGROUP) {\n                p.openElements.pop();\n                p.insertionMode = InsertionMode.IN_TABLE;\n            }\n            break;\n        }\n        case html_js_1.TAG_ID.TEMPLATE: {\n            templateEndTagInHead(p, token);\n            break;\n        }\n        case html_js_1.TAG_ID.COL: {\n            // Ignore token\n            break;\n        }\n        default: {\n            tokenInColumnGroup(p, token);\n        }\n    }\n}\nfunction tokenInColumnGroup(p, token) {\n    if (p.openElements.currentTagId === html_js_1.TAG_ID.COLGROUP) {\n        p.openElements.pop();\n        p.insertionMode = InsertionMode.IN_TABLE;\n        p._processToken(token);\n    }\n}\n// The \"in table body\" insertion mode\n//------------------------------------------------------------------\nfunction startTagInTableBody(p, token) {\n    switch (token.tagID) {\n        case html_js_1.TAG_ID.TR: {\n            p.openElements.clearBackToTableBodyContext();\n            p._insertElement(token, html_js_1.NS.HTML);\n            p.insertionMode = InsertionMode.IN_ROW;\n            break;\n        }\n        case html_js_1.TAG_ID.TH:\n        case html_js_1.TAG_ID.TD: {\n            p.openElements.clearBackToTableBodyContext();\n            p._insertFakeElement(html_js_1.TAG_NAMES.TR, html_js_1.TAG_ID.TR);\n            p.insertionMode = InsertionMode.IN_ROW;\n            startTagInRow(p, token);\n            break;\n        }\n        case html_js_1.TAG_ID.CAPTION:\n        case html_js_1.TAG_ID.COL:\n        case html_js_1.TAG_ID.COLGROUP:\n        case html_js_1.TAG_ID.TBODY:\n        case html_js_1.TAG_ID.TFOOT:\n        case html_js_1.TAG_ID.THEAD: {\n            if (p.openElements.hasTableBodyContextInTableScope()) {\n                p.openElements.clearBackToTableBodyContext();\n                p.openElements.pop();\n                p.insertionMode = InsertionMode.IN_TABLE;\n                startTagInTable(p, token);\n            }\n            break;\n        }\n        default: {\n            startTagInTable(p, token);\n        }\n    }\n}\nfunction endTagInTableBody(p, token) {\n    const tn = token.tagID;\n    switch (token.tagID) {\n        case html_js_1.TAG_ID.TBODY:\n        case html_js_1.TAG_ID.TFOOT:\n        case html_js_1.TAG_ID.THEAD: {\n            if (p.openElements.hasInTableScope(tn)) {\n                p.openElements.clearBackToTableBodyContext();\n                p.openElements.pop();\n                p.insertionMode = InsertionMode.IN_TABLE;\n            }\n            break;\n        }\n        case html_js_1.TAG_ID.TABLE: {\n            if (p.openElements.hasTableBodyContextInTableScope()) {\n                p.openElements.clearBackToTableBodyContext();\n                p.openElements.pop();\n                p.insertionMode = InsertionMode.IN_TABLE;\n                endTagInTable(p, token);\n            }\n            break;\n        }\n        case html_js_1.TAG_ID.BODY:\n        case html_js_1.TAG_ID.CAPTION:\n        case html_js_1.TAG_ID.COL:\n        case html_js_1.TAG_ID.COLGROUP:\n        case html_js_1.TAG_ID.HTML:\n        case html_js_1.TAG_ID.TD:\n        case html_js_1.TAG_ID.TH:\n        case html_js_1.TAG_ID.TR: {\n            // Ignore token\n            break;\n        }\n        default: {\n            endTagInTable(p, token);\n        }\n    }\n}\n// The \"in row\" insertion mode\n//------------------------------------------------------------------\nfunction startTagInRow(p, token) {\n    switch (token.tagID) {\n        case html_js_1.TAG_ID.TH:\n        case html_js_1.TAG_ID.TD: {\n            p.openElements.clearBackToTableRowContext();\n            p._insertElement(token, html_js_1.NS.HTML);\n            p.insertionMode = InsertionMode.IN_CELL;\n            p.activeFormattingElements.insertMarker();\n            break;\n        }\n        case html_js_1.TAG_ID.CAPTION:\n        case html_js_1.TAG_ID.COL:\n        case html_js_1.TAG_ID.COLGROUP:\n        case html_js_1.TAG_ID.TBODY:\n        case html_js_1.TAG_ID.TFOOT:\n        case html_js_1.TAG_ID.THEAD:\n        case html_js_1.TAG_ID.TR: {\n            if (p.openElements.hasInTableScope(html_js_1.TAG_ID.TR)) {\n                p.openElements.clearBackToTableRowContext();\n                p.openElements.pop();\n                p.insertionMode = InsertionMode.IN_TABLE_BODY;\n                startTagInTableBody(p, token);\n            }\n            break;\n        }\n        default: {\n            startTagInTable(p, token);\n        }\n    }\n}\nfunction endTagInRow(p, token) {\n    switch (token.tagID) {\n        case html_js_1.TAG_ID.TR: {\n            if (p.openElements.hasInTableScope(html_js_1.TAG_ID.TR)) {\n                p.openElements.clearBackToTableRowContext();\n                p.openElements.pop();\n                p.insertionMode = InsertionMode.IN_TABLE_BODY;\n            }\n            break;\n        }\n        case html_js_1.TAG_ID.TABLE: {\n            if (p.openElements.hasInTableScope(html_js_1.TAG_ID.TR)) {\n                p.openElements.clearBackToTableRowContext();\n                p.openElements.pop();\n                p.insertionMode = InsertionMode.IN_TABLE_BODY;\n                endTagInTableBody(p, token);\n            }\n            break;\n        }\n        case html_js_1.TAG_ID.TBODY:\n        case html_js_1.TAG_ID.TFOOT:\n        case html_js_1.TAG_ID.THEAD: {\n            if (p.openElements.hasInTableScope(token.tagID) || p.openElements.hasInTableScope(html_js_1.TAG_ID.TR)) {\n                p.openElements.clearBackToTableRowContext();\n                p.openElements.pop();\n                p.insertionMode = InsertionMode.IN_TABLE_BODY;\n                endTagInTableBody(p, token);\n            }\n            break;\n        }\n        case html_js_1.TAG_ID.BODY:\n        case html_js_1.TAG_ID.CAPTION:\n        case html_js_1.TAG_ID.COL:\n        case html_js_1.TAG_ID.COLGROUP:\n        case html_js_1.TAG_ID.HTML:\n        case html_js_1.TAG_ID.TD:\n        case html_js_1.TAG_ID.TH: {\n            // Ignore end tag\n            break;\n        }\n        default:\n            endTagInTable(p, token);\n    }\n}\n// The \"in cell\" insertion mode\n//------------------------------------------------------------------\nfunction startTagInCell(p, token) {\n    const tn = token.tagID;\n    if (TABLE_VOID_ELEMENTS.has(tn)) {\n        if (p.openElements.hasInTableScope(html_js_1.TAG_ID.TD) || p.openElements.hasInTableScope(html_js_1.TAG_ID.TH)) {\n            p._closeTableCell();\n            startTagInRow(p, token);\n        }\n    }\n    else {\n        startTagInBody(p, token);\n    }\n}\nfunction endTagInCell(p, token) {\n    const tn = token.tagID;\n    switch (tn) {\n        case html_js_1.TAG_ID.TD:\n        case html_js_1.TAG_ID.TH: {\n            if (p.openElements.hasInTableScope(tn)) {\n                p.openElements.generateImpliedEndTags();\n                p.openElements.popUntilTagNamePopped(tn);\n                p.activeFormattingElements.clearToLastMarker();\n                p.insertionMode = InsertionMode.IN_ROW;\n            }\n            break;\n        }\n        case html_js_1.TAG_ID.TABLE:\n        case html_js_1.TAG_ID.TBODY:\n        case html_js_1.TAG_ID.TFOOT:\n        case html_js_1.TAG_ID.THEAD:\n        case html_js_1.TAG_ID.TR: {\n            if (p.openElements.hasInTableScope(tn)) {\n                p._closeTableCell();\n                endTagInRow(p, token);\n            }\n            break;\n        }\n        case html_js_1.TAG_ID.BODY:\n        case html_js_1.TAG_ID.CAPTION:\n        case html_js_1.TAG_ID.COL:\n        case html_js_1.TAG_ID.COLGROUP:\n        case html_js_1.TAG_ID.HTML: {\n            // Ignore token\n            break;\n        }\n        default: {\n            endTagInBody(p, token);\n        }\n    }\n}\n// The \"in select\" insertion mode\n//------------------------------------------------------------------\nfunction startTagInSelect(p, token) {\n    switch (token.tagID) {\n        case html_js_1.TAG_ID.HTML: {\n            startTagInBody(p, token);\n            break;\n        }\n        case html_js_1.TAG_ID.OPTION: {\n            if (p.openElements.currentTagId === html_js_1.TAG_ID.OPTION) {\n                p.openElements.pop();\n            }\n            p._insertElement(token, html_js_1.NS.HTML);\n            break;\n        }\n        case html_js_1.TAG_ID.OPTGROUP: {\n            if (p.openElements.currentTagId === html_js_1.TAG_ID.OPTION) {\n                p.openElements.pop();\n            }\n            if (p.openElements.currentTagId === html_js_1.TAG_ID.OPTGROUP) {\n                p.openElements.pop();\n            }\n            p._insertElement(token, html_js_1.NS.HTML);\n            break;\n        }\n        case html_js_1.TAG_ID.INPUT:\n        case html_js_1.TAG_ID.KEYGEN:\n        case html_js_1.TAG_ID.TEXTAREA:\n        case html_js_1.TAG_ID.SELECT: {\n            if (p.openElements.hasInSelectScope(html_js_1.TAG_ID.SELECT)) {\n                p.openElements.popUntilTagNamePopped(html_js_1.TAG_ID.SELECT);\n                p._resetInsertionMode();\n                if (token.tagID !== html_js_1.TAG_ID.SELECT) {\n                    p._processStartTag(token);\n                }\n            }\n            break;\n        }\n        case html_js_1.TAG_ID.SCRIPT:\n        case html_js_1.TAG_ID.TEMPLATE: {\n            startTagInHead(p, token);\n            break;\n        }\n        default:\n        // Do nothing\n    }\n}\nfunction endTagInSelect(p, token) {\n    switch (token.tagID) {\n        case html_js_1.TAG_ID.OPTGROUP: {\n            if (p.openElements.stackTop > 0 &&\n                p.openElements.currentTagId === html_js_1.TAG_ID.OPTION &&\n                p.openElements.tagIDs[p.openElements.stackTop - 1] === html_js_1.TAG_ID.OPTGROUP) {\n                p.openElements.pop();\n            }\n            if (p.openElements.currentTagId === html_js_1.TAG_ID.OPTGROUP) {\n                p.openElements.pop();\n            }\n            break;\n        }\n        case html_js_1.TAG_ID.OPTION: {\n            if (p.openElements.currentTagId === html_js_1.TAG_ID.OPTION) {\n                p.openElements.pop();\n            }\n            break;\n        }\n        case html_js_1.TAG_ID.SELECT: {\n            if (p.openElements.hasInSelectScope(html_js_1.TAG_ID.SELECT)) {\n                p.openElements.popUntilTagNamePopped(html_js_1.TAG_ID.SELECT);\n                p._resetInsertionMode();\n            }\n            break;\n        }\n        case html_js_1.TAG_ID.TEMPLATE: {\n            templateEndTagInHead(p, token);\n            break;\n        }\n        default:\n        // Do nothing\n    }\n}\n// The \"in select in table\" insertion mode\n//------------------------------------------------------------------\nfunction startTagInSelectInTable(p, token) {\n    const tn = token.tagID;\n    if (tn === html_js_1.TAG_ID.CAPTION ||\n        tn === html_js_1.TAG_ID.TABLE ||\n        tn === html_js_1.TAG_ID.TBODY ||\n        tn === html_js_1.TAG_ID.TFOOT ||\n        tn === html_js_1.TAG_ID.THEAD ||\n        tn === html_js_1.TAG_ID.TR ||\n        tn === html_js_1.TAG_ID.TD ||\n        tn === html_js_1.TAG_ID.TH) {\n        p.openElements.popUntilTagNamePopped(html_js_1.TAG_ID.SELECT);\n        p._resetInsertionMode();\n        p._processStartTag(token);\n    }\n    else {\n        startTagInSelect(p, token);\n    }\n}\nfunction endTagInSelectInTable(p, token) {\n    const tn = token.tagID;\n    if (tn === html_js_1.TAG_ID.CAPTION ||\n        tn === html_js_1.TAG_ID.TABLE ||\n        tn === html_js_1.TAG_ID.TBODY ||\n        tn === html_js_1.TAG_ID.TFOOT ||\n        tn === html_js_1.TAG_ID.THEAD ||\n        tn === html_js_1.TAG_ID.TR ||\n        tn === html_js_1.TAG_ID.TD ||\n        tn === html_js_1.TAG_ID.TH) {\n        if (p.openElements.hasInTableScope(tn)) {\n            p.openElements.popUntilTagNamePopped(html_js_1.TAG_ID.SELECT);\n            p._resetInsertionMode();\n            p.onEndTag(token);\n        }\n    }\n    else {\n        endTagInSelect(p, token);\n    }\n}\n// The \"in template\" insertion mode\n//------------------------------------------------------------------\nfunction startTagInTemplate(p, token) {\n    switch (token.tagID) {\n        // First, handle tags that can start without a mode change\n        case html_js_1.TAG_ID.BASE:\n        case html_js_1.TAG_ID.BASEFONT:\n        case html_js_1.TAG_ID.BGSOUND:\n        case html_js_1.TAG_ID.LINK:\n        case html_js_1.TAG_ID.META:\n        case html_js_1.TAG_ID.NOFRAMES:\n        case html_js_1.TAG_ID.SCRIPT:\n        case html_js_1.TAG_ID.STYLE:\n        case html_js_1.TAG_ID.TEMPLATE:\n        case html_js_1.TAG_ID.TITLE:\n            startTagInHead(p, token);\n            break;\n        // Re-process the token in the appropriate mode\n        case html_js_1.TAG_ID.CAPTION:\n        case html_js_1.TAG_ID.COLGROUP:\n        case html_js_1.TAG_ID.TBODY:\n        case html_js_1.TAG_ID.TFOOT:\n        case html_js_1.TAG_ID.THEAD:\n            p.tmplInsertionModeStack[0] = InsertionMode.IN_TABLE;\n            p.insertionMode = InsertionMode.IN_TABLE;\n            startTagInTable(p, token);\n            break;\n        case html_js_1.TAG_ID.COL:\n            p.tmplInsertionModeStack[0] = InsertionMode.IN_COLUMN_GROUP;\n            p.insertionMode = InsertionMode.IN_COLUMN_GROUP;\n            startTagInColumnGroup(p, token);\n            break;\n        case html_js_1.TAG_ID.TR:\n            p.tmplInsertionModeStack[0] = InsertionMode.IN_TABLE_BODY;\n            p.insertionMode = InsertionMode.IN_TABLE_BODY;\n            startTagInTableBody(p, token);\n            break;\n        case html_js_1.TAG_ID.TD:\n        case html_js_1.TAG_ID.TH:\n            p.tmplInsertionModeStack[0] = InsertionMode.IN_ROW;\n            p.insertionMode = InsertionMode.IN_ROW;\n            startTagInRow(p, token);\n            break;\n        default:\n            p.tmplInsertionModeStack[0] = InsertionMode.IN_BODY;\n            p.insertionMode = InsertionMode.IN_BODY;\n            startTagInBody(p, token);\n    }\n}\nfunction endTagInTemplate(p, token) {\n    if (token.tagID === html_js_1.TAG_ID.TEMPLATE) {\n        templateEndTagInHead(p, token);\n    }\n}\nfunction eofInTemplate(p, token) {\n    if (p.openElements.tmplCount > 0) {\n        p.openElements.popUntilTagNamePopped(html_js_1.TAG_ID.TEMPLATE);\n        p.activeFormattingElements.clearToLastMarker();\n        p.tmplInsertionModeStack.shift();\n        p._resetInsertionMode();\n        p.onEof(token);\n    }\n    else {\n        stopParsing(p, token);\n    }\n}\n// The \"after body\" insertion mode\n//------------------------------------------------------------------\nfunction startTagAfterBody(p, token) {\n    if (token.tagID === html_js_1.TAG_ID.HTML) {\n        startTagInBody(p, token);\n    }\n    else {\n        tokenAfterBody(p, token);\n    }\n}\nfunction endTagAfterBody(p, token) {\n    var _a;\n    if (token.tagID === html_js_1.TAG_ID.HTML) {\n        if (!p.fragmentContext) {\n            p.insertionMode = InsertionMode.AFTER_AFTER_BODY;\n        }\n        //NOTE: <html> is never popped from the stack, so we need to updated\n        //the end location explicitly.\n        if (p.options.sourceCodeLocationInfo && p.openElements.tagIDs[0] === html_js_1.TAG_ID.HTML) {\n            p._setEndLocation(p.openElements.items[0], token);\n            // Update the body element, if it doesn't have an end tag\n            const bodyElement = p.openElements.items[1];\n            if (bodyElement && !((_a = p.treeAdapter.getNodeSourceCodeLocation(bodyElement)) === null || _a === void 0 ? void 0 : _a.endTag)) {\n                p._setEndLocation(bodyElement, token);\n            }\n        }\n    }\n    else {\n        tokenAfterBody(p, token);\n    }\n}\nfunction tokenAfterBody(p, token) {\n    p.insertionMode = InsertionMode.IN_BODY;\n    modeInBody(p, token);\n}\n// The \"in frameset\" insertion mode\n//------------------------------------------------------------------\nfunction startTagInFrameset(p, token) {\n    switch (token.tagID) {\n        case html_js_1.TAG_ID.HTML: {\n            startTagInBody(p, token);\n            break;\n        }\n        case html_js_1.TAG_ID.FRAMESET: {\n            p._insertElement(token, html_js_1.NS.HTML);\n            break;\n        }\n        case html_js_1.TAG_ID.FRAME: {\n            p._appendElement(token, html_js_1.NS.HTML);\n            token.ackSelfClosing = true;\n            break;\n        }\n        case html_js_1.TAG_ID.NOFRAMES: {\n            startTagInHead(p, token);\n            break;\n        }\n        default:\n        // Do nothing\n    }\n}\nfunction endTagInFrameset(p, token) {\n    if (token.tagID === html_js_1.TAG_ID.FRAMESET && !p.openElements.isRootHtmlElementCurrent()) {\n        p.openElements.pop();\n        if (!p.fragmentContext && p.openElements.currentTagId !== html_js_1.TAG_ID.FRAMESET) {\n            p.insertionMode = InsertionMode.AFTER_FRAMESET;\n        }\n    }\n}\n// The \"after frameset\" insertion mode\n//------------------------------------------------------------------\nfunction startTagAfterFrameset(p, token) {\n    switch (token.tagID) {\n        case html_js_1.TAG_ID.HTML: {\n            startTagInBody(p, token);\n            break;\n        }\n        case html_js_1.TAG_ID.NOFRAMES: {\n            startTagInHead(p, token);\n            break;\n        }\n        default:\n        // Do nothing\n    }\n}\nfunction endTagAfterFrameset(p, token) {\n    if (token.tagID === html_js_1.TAG_ID.HTML) {\n        p.insertionMode = InsertionMode.AFTER_AFTER_FRAMESET;\n    }\n}\n// The \"after after body\" insertion mode\n//------------------------------------------------------------------\nfunction startTagAfterAfterBody(p, token) {\n    if (token.tagID === html_js_1.TAG_ID.HTML) {\n        startTagInBody(p, token);\n    }\n    else {\n        tokenAfterAfterBody(p, token);\n    }\n}\nfunction tokenAfterAfterBody(p, token) {\n    p.insertionMode = InsertionMode.IN_BODY;\n    modeInBody(p, token);\n}\n// The \"after after frameset\" insertion mode\n//------------------------------------------------------------------\nfunction startTagAfterAfterFrameset(p, token) {\n    switch (token.tagID) {\n        case html_js_1.TAG_ID.HTML: {\n            startTagInBody(p, token);\n            break;\n        }\n        case html_js_1.TAG_ID.NOFRAMES: {\n            startTagInHead(p, token);\n            break;\n        }\n        default:\n        // Do nothing\n    }\n}\n// The rules for parsing tokens in foreign content\n//------------------------------------------------------------------\nfunction nullCharacterInForeignContent(p, token) {\n    token.chars = unicode.REPLACEMENT_CHARACTER;\n    p._insertCharacters(token);\n}\nfunction characterInForeignContent(p, token) {\n    p._insertCharacters(token);\n    p.framesetOk = false;\n}\nfunction popUntilHtmlOrIntegrationPoint(p) {\n    while (p.treeAdapter.getNamespaceURI(p.openElements.current) !== html_js_1.NS.HTML &&\n        !p._isIntegrationPoint(p.openElements.currentTagId, p.openElements.current)) {\n        p.openElements.pop();\n    }\n}\nfunction startTagInForeignContent(p, token) {\n    if (foreignContent.causesExit(token)) {\n        popUntilHtmlOrIntegrationPoint(p);\n        p._startTagOutsideForeignContent(token);\n    }\n    else {\n        const current = p._getAdjustedCurrentElement();\n        const currentNs = p.treeAdapter.getNamespaceURI(current);\n        if (currentNs === html_js_1.NS.MATHML) {\n            foreignContent.adjustTokenMathMLAttrs(token);\n        }\n        else if (currentNs === html_js_1.NS.SVG) {\n            foreignContent.adjustTokenSVGTagName(token);\n            foreignContent.adjustTokenSVGAttrs(token);\n        }\n        foreignContent.adjustTokenXMLAttrs(token);\n        if (token.selfClosing) {\n            p._appendElement(token, currentNs);\n        }\n        else {\n            p._insertElement(token, currentNs);\n        }\n        token.ackSelfClosing = true;\n    }\n}\nfunction endTagInForeignContent(p, token) {\n    if (token.tagID === html_js_1.TAG_ID.P || token.tagID === html_js_1.TAG_ID.BR) {\n        popUntilHtmlOrIntegrationPoint(p);\n        p._endTagOutsideForeignContent(token);\n        return;\n    }\n    for (let i = p.openElements.stackTop; i > 0; i--) {\n        const element = p.openElements.items[i];\n        if (p.treeAdapter.getNamespaceURI(element) === html_js_1.NS.HTML) {\n            p._endTagOutsideForeignContent(token);\n            break;\n        }\n        const tagName = p.treeAdapter.getTagName(element);\n        if (tagName.toLowerCase() === token.tagName) {\n            //NOTE: update the token tag name for `_setEndLocation`.\n            token.tagName = tagName;\n            p.openElements.shortenToLength(i);\n            break;\n        }\n    }\n}\n//# sourceMappingURL=index.js.map"],"mappings":"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"},"metadata":{},"sourceType":"script"}